
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../tables_ref/">
      
      
        <link rel="next" href="../nice_sql_examples/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.2.0-b3">
    
    
      
        <title>Specific Grants/Populations - nice_sql</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.83068744.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#grantgroup-specific-queries" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="nice_sql" class="md-header__button md-logo" aria-label="nice_sql" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            nice_sql
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Specific Grants/Populations
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="nice_sql" class="md-nav__button md-logo" aria-label="nice_sql" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    nice_sql
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Query Guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Query Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
    <li class="md-nav__item">
      <a href="../tables_ref/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    General Queries
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Specific Grants/Populations
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Specific Grants/Populations
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#a2j" class="md-nav__link">
    A2J
  </a>
  
    <nav class="md-nav" aria-label="A2J">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#script.nice_sql.A2J.cases" class="md-nav__link">
    cases()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#script.nice_sql.A2J.linkages" class="md-nav__link">
    linkages()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-reports" class="md-nav__link">
    Running Reports
  </a>
  
    <nav class="md-nav" aria-label="Running Reports">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#report_funcs" class="md-nav__link">
    report_funcs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jac-and-idhs" class="md-nav__link">
    JAC and IDHS
  </a>
  
    <nav class="md-nav" aria-label="JAC and IDHS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#script.nice_sql.JAC_IDHS.idhs_ages" class="md-nav__link">
    idhs_ages()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#script.nice_sql.JAC_IDHS.idhs_class_notes" class="md-nav__link">
    idhs_class_notes()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#script.nice_sql.JAC_IDHS.idhs_incidents_detailed" class="md-nav__link">
    idhs_incidents_detailed()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#script.nice_sql.JAC_IDHS.idhs_language" class="md-nav__link">
    idhs_language()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#script.nice_sql.JAC_IDHS.idhs_linkages" class="md-nav__link">
    idhs_linkages()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#script.nice_sql.JAC_IDHS.idhs_race_gender" class="md-nav__link">
    idhs_race_gender()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#script.nice_sql.JAC_IDHS.idhs_service_tally" class="md-nav__link">
    idhs_service_tally()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#script.nice_sql.JAC_IDHS.idhs_tally" class="md-nav__link">
    idhs_tally()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#script.nice_sql.JAC_IDHS.jac_cm_hours" class="md-nav__link">
    jac_cm_hours()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#script.nice_sql.JAC_IDHS.jac_cm_sessions" class="md-nav__link">
    jac_cm_sessions()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#script.nice_sql.JAC_IDHS.jac_linked_participant_tally" class="md-nav__link">
    jac_linked_participant_tally()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#script.nice_sql.JAC_IDHS.jac_transpo_assist" class="md-nav__link">
    jac_transpo_assist()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-reports_1" class="md-nav__link">
    Running Reports
  </a>
  
    <nav class="md-nav" aria-label="Running Reports">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#jac_smartsheet" class="md-nav__link">
    JAC_Smartsheet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cvi" class="md-nav__link">
    CVI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ppr" class="md-nav__link">
    PPR
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#monthly-reports" class="md-nav__link">
    Monthly Reports
  </a>
  
    <nav class="md-nav" aria-label="Monthly Reports">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#script.nice_sql.Monthly_Report.grouped_by_status" class="md-nav__link">
    grouped_by_status()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#script.nice_sql.Monthly_Report.grouped_by_time" class="md-nav__link">
    grouped_by_time()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-reports_2" class="md-nav__link">
    Running Reports
  </a>
  
    <nav class="md-nav" aria-label="Running Reports">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#program_grant_funcs" class="md-nav__link">
    program_grant_funcs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#legal_funcs" class="md-nav__link">
    legal_funcs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cm_outreach_funcs" class="md-nav__link">
    cm_outreach_funcs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
    <li class="md-nav__item">
      <a href="../nice_sql_examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Examples
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#a2j" class="md-nav__link">
    A2J
  </a>
  
    <nav class="md-nav" aria-label="A2J">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#script.nice_sql.A2J.cases" class="md-nav__link">
    cases()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#script.nice_sql.A2J.linkages" class="md-nav__link">
    linkages()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-reports" class="md-nav__link">
    Running Reports
  </a>
  
    <nav class="md-nav" aria-label="Running Reports">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#report_funcs" class="md-nav__link">
    report_funcs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jac-and-idhs" class="md-nav__link">
    JAC and IDHS
  </a>
  
    <nav class="md-nav" aria-label="JAC and IDHS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#script.nice_sql.JAC_IDHS.idhs_ages" class="md-nav__link">
    idhs_ages()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#script.nice_sql.JAC_IDHS.idhs_class_notes" class="md-nav__link">
    idhs_class_notes()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#script.nice_sql.JAC_IDHS.idhs_incidents_detailed" class="md-nav__link">
    idhs_incidents_detailed()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#script.nice_sql.JAC_IDHS.idhs_language" class="md-nav__link">
    idhs_language()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#script.nice_sql.JAC_IDHS.idhs_linkages" class="md-nav__link">
    idhs_linkages()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#script.nice_sql.JAC_IDHS.idhs_race_gender" class="md-nav__link">
    idhs_race_gender()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#script.nice_sql.JAC_IDHS.idhs_service_tally" class="md-nav__link">
    idhs_service_tally()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#script.nice_sql.JAC_IDHS.idhs_tally" class="md-nav__link">
    idhs_tally()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#script.nice_sql.JAC_IDHS.jac_cm_hours" class="md-nav__link">
    jac_cm_hours()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#script.nice_sql.JAC_IDHS.jac_cm_sessions" class="md-nav__link">
    jac_cm_sessions()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#script.nice_sql.JAC_IDHS.jac_linked_participant_tally" class="md-nav__link">
    jac_linked_participant_tally()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#script.nice_sql.JAC_IDHS.jac_transpo_assist" class="md-nav__link">
    jac_transpo_assist()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-reports_1" class="md-nav__link">
    Running Reports
  </a>
  
    <nav class="md-nav" aria-label="Running Reports">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#jac_smartsheet" class="md-nav__link">
    JAC_Smartsheet
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cvi" class="md-nav__link">
    CVI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ppr" class="md-nav__link">
    PPR
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#monthly-reports" class="md-nav__link">
    Monthly Reports
  </a>
  
    <nav class="md-nav" aria-label="Monthly Reports">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#script.nice_sql.Monthly_Report.grouped_by_status" class="md-nav__link">
    grouped_by_status()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#script.nice_sql.Monthly_Report.grouped_by_time" class="md-nav__link">
    grouped_by_time()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-reports_2" class="md-nav__link">
    Running Reports
  </a>
  
    <nav class="md-nav" aria-label="Running Reports">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#program_grant_funcs" class="md-nav__link">
    program_grant_funcs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#legal_funcs" class="md-nav__link">
    legal_funcs
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cm_outreach_funcs" class="md-nav__link">
    cm_outreach_funcs
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="grantgroup-specific-queries">Grant/Group Specific Queries</h1>
<h2 id="a2j">A2J</h2>
<div class="language-py highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="n">a</span> <span class="o">=</span> <span class="n">A2J</span><span class="p">(</span><span class="n">t1</span> <span class="o">=</span> <span class="s1">&#39;2023-12-01&#39;</span><span class="p">,</span> <span class="n">t2</span> <span class="o">=</span> <span class="s1">&#39;2023-12-31&#39;</span><span class="p">,</span> <span class="n">print_SQL</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> 
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="n">clipboard</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</span></code></pre></div>


<div class="doc doc-object doc-class">




  <div class="doc doc-contents first">
          <p class="doc doc-class-bases">
            Bases: <code><span title="script.nice_sql.Queries">Queries</span></code></p>

  
      <p>Sets up a table for running A2J reports</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>t1</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>start of the stint (formatted: "YYYY-MM-DD")</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>t2</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>end of the stint (formatted: "YYYY-MM-DD")</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>script\nice_sql.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2200">2200</a></span>
<span class="normal"><a href="#__codelineno-0-2201">2201</a></span>
<span class="normal"><a href="#__codelineno-0-2202">2202</a></span>
<span class="normal"><a href="#__codelineno-0-2203">2203</a></span>
<span class="normal"><a href="#__codelineno-0-2204">2204</a></span>
<span class="normal"><a href="#__codelineno-0-2205">2205</a></span>
<span class="normal"><a href="#__codelineno-0-2206">2206</a></span>
<span class="normal"><a href="#__codelineno-0-2207">2207</a></span>
<span class="normal"><a href="#__codelineno-0-2208">2208</a></span>
<span class="normal"><a href="#__codelineno-0-2209">2209</a></span>
<span class="normal"><a href="#__codelineno-0-2210">2210</a></span>
<span class="normal"><a href="#__codelineno-0-2211">2211</a></span>
<span class="normal"><a href="#__codelineno-0-2212">2212</a></span>
<span class="normal"><a href="#__codelineno-0-2213">2213</a></span>
<span class="normal"><a href="#__codelineno-0-2214">2214</a></span>
<span class="normal"><a href="#__codelineno-0-2215">2215</a></span>
<span class="normal"><a href="#__codelineno-0-2216">2216</a></span>
<span class="normal"><a href="#__codelineno-0-2217">2217</a></span>
<span class="normal"><a href="#__codelineno-0-2218">2218</a></span>
<span class="normal"><a href="#__codelineno-0-2219">2219</a></span>
<span class="normal"><a href="#__codelineno-0-2220">2220</a></span>
<span class="normal"><a href="#__codelineno-0-2221">2221</a></span>
<span class="normal"><a href="#__codelineno-0-2222">2222</a></span>
<span class="normal"><a href="#__codelineno-0-2223">2223</a></span>
<span class="normal"><a href="#__codelineno-0-2224">2224</a></span>
<span class="normal"><a href="#__codelineno-0-2225">2225</a></span>
<span class="normal"><a href="#__codelineno-0-2226">2226</a></span>
<span class="normal"><a href="#__codelineno-0-2227">2227</a></span>
<span class="normal"><a href="#__codelineno-0-2228">2228</a></span>
<span class="normal"><a href="#__codelineno-0-2229">2229</a></span>
<span class="normal"><a href="#__codelineno-0-2230">2230</a></span>
<span class="normal"><a href="#__codelineno-0-2231">2231</a></span>
<span class="normal"><a href="#__codelineno-0-2232">2232</a></span>
<span class="normal"><a href="#__codelineno-0-2233">2233</a></span>
<span class="normal"><a href="#__codelineno-0-2234">2234</a></span>
<span class="normal"><a href="#__codelineno-0-2235">2235</a></span>
<span class="normal"><a href="#__codelineno-0-2236">2236</a></span>
<span class="normal"><a href="#__codelineno-0-2237">2237</a></span>
<span class="normal"><a href="#__codelineno-0-2238">2238</a></span>
<span class="normal"><a href="#__codelineno-0-2239">2239</a></span>
<span class="normal"><a href="#__codelineno-0-2240">2240</a></span>
<span class="normal"><a href="#__codelineno-0-2241">2241</a></span>
<span class="normal"><a href="#__codelineno-0-2242">2242</a></span>
<span class="normal"><a href="#__codelineno-0-2243">2243</a></span>
<span class="normal"><a href="#__codelineno-0-2244">2244</a></span>
<span class="normal"><a href="#__codelineno-0-2245">2245</a></span>
<span class="normal"><a href="#__codelineno-0-2246">2246</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2200"><a id="__codelineno-0-2200" name="__codelineno-0-2200"></a><span class="k">class</span> <span class="nc">A2J</span><span class="p">(</span><span class="n">Queries</span><span class="p">):</span>
</span><span id="__span-0-2201"><a id="__codelineno-0-2201" name="__codelineno-0-2201"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-0-2202"><a id="__codelineno-0-2202" name="__codelineno-0-2202"></a><span class="sd">    Sets up a table for running A2J reports</span>
</span><span id="__span-0-2203"><a id="__codelineno-0-2203" name="__codelineno-0-2203"></a>
</span><span id="__span-0-2204"><a id="__codelineno-0-2204" name="__codelineno-0-2204"></a><span class="sd">    Parameters:</span>
</span><span id="__span-0-2205"><a id="__codelineno-0-2205" name="__codelineno-0-2205"></a><span class="sd">        t1: start of the stint (formatted: &quot;YYYY-MM-DD&quot;)</span>
</span><span id="__span-0-2206"><a id="__codelineno-0-2206" name="__codelineno-0-2206"></a><span class="sd">        t2: end of the stint (formatted: &quot;YYYY-MM-DD&quot;)</span>
</span><span id="__span-0-2207"><a id="__codelineno-0-2207" name="__codelineno-0-2207"></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="__span-0-2208"><a id="__codelineno-0-2208" name="__codelineno-0-2208"></a>    <span class="n">report_funcs</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-2209"><a id="__codelineno-0-2209" name="__codelineno-0-2209"></a>        <span class="s2">&quot;CASES_STARTED&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;cases&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;ended&quot;</span><span class="p">,)),</span>
</span><span id="__span-0-2210"><a id="__codelineno-0-2210" name="__codelineno-0-2210"></a>        <span class="s2">&quot;CASES_ENDED&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;cases&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;started&quot;</span><span class="p">,)),</span>
</span><span id="__span-0-2211"><a id="__codelineno-0-2211" name="__codelineno-0-2211"></a>        <span class="s2">&quot;LINKAGES&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;linkages&quot;</span><span class="p">,</span> <span class="p">())</span>
</span><span id="__span-0-2212"><a id="__codelineno-0-2212" name="__codelineno-0-2212"></a>    <span class="p">}</span>
</span><span id="__span-0-2213"><a id="__codelineno-0-2213" name="__codelineno-0-2213"></a>
</span><span id="__span-0-2214"><a id="__codelineno-0-2214" name="__codelineno-0-2214"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">default_table</span><span class="o">=</span><span class="s2">&quot;stints.classify_by_program&quot;</span><span class="p">):</span>
</span><span id="__span-0-2215"><a id="__codelineno-0-2215" name="__codelineno-0-2215"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">default_table</span><span class="p">)</span>
</span><span id="__span-0-2216"><a id="__codelineno-0-2216" name="__codelineno-0-2216"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">table_update</span><span class="p">(</span><span class="s2">&quot;a2j&quot;</span><span class="p">,</span> <span class="n">update_default_table</span><span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-2217"><a id="__codelineno-0-2217" name="__codelineno-0-2217"></a>
</span><span id="__span-0-2218"><a id="__codelineno-0-2218" name="__codelineno-0-2218"></a>    <span class="k">def</span> <span class="nf">cases</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">started_ended</span> <span class="o">=</span> <span class="s2">&quot;started&quot;</span><span class="p">):</span>
</span><span id="__span-0-2219"><a id="__codelineno-0-2219" name="__codelineno-0-2219"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-0-2220"><a id="__codelineno-0-2220" name="__codelineno-0-2220"></a><span class="sd">        counts legal cases for A2J that either started or ended</span>
</span><span id="__span-0-2221"><a id="__codelineno-0-2221" name="__codelineno-0-2221"></a>
</span><span id="__span-0-2222"><a id="__codelineno-0-2222" name="__codelineno-0-2222"></a><span class="sd">        Parameters:</span>
</span><span id="__span-0-2223"><a id="__codelineno-0-2223" name="__codelineno-0-2223"></a><span class="sd">            started_ended: &quot;started&quot; counts cases started, &quot;ended&quot; is cases ended. Defaults to &quot;started&quot; </span>
</span><span id="__span-0-2224"><a id="__codelineno-0-2224" name="__codelineno-0-2224"></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="__span-0-2225"><a id="__codelineno-0-2225" name="__codelineno-0-2225"></a>        <span class="k">if</span> <span class="n">started_ended</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span> <span class="s2">&quot;started&quot;</span><span class="p">:</span>
</span><span id="__span-0-2226"><a id="__codelineno-0-2226" name="__codelineno-0-2226"></a>            <span class="n">started_ended</span> <span class="o">=</span> <span class="s2">&quot;arrest_date&quot;</span>
</span><span id="__span-0-2227"><a id="__codelineno-0-2227" name="__codelineno-0-2227"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-2228"><a id="__codelineno-0-2228" name="__codelineno-0-2228"></a>            <span class="n">started_ended</span> <span class="o">=</span> <span class="s2">&quot;case_outcome_date&quot;</span>
</span><span id="__span-0-2229"><a id="__codelineno-0-2229" name="__codelineno-0-2229"></a>        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;select </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span><span class="s1">.*, o.offense_date, o.case_outcome_date, o.case_outcome, o.sentence</span>
</span><span id="__span-0-2230"><a id="__codelineno-0-2230" name="__codelineno-0-2230"></a><span class="s1">from participants.a2j</span>
</span><span id="__span-0-2231"><a id="__codelineno-0-2231" name="__codelineno-0-2231"></a><span class="s1">join civicore.legal o using(participant_id)</span>
</span><span id="__span-0-2232"><a id="__codelineno-0-2232" name="__codelineno-0-2232"></a><span class="s1">where </span><span class="si">{</span><span class="n">started_ended</span><span class="si">}</span><span class="s1"> between </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t1</span><span class="si">}</span><span class="s1"> and </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t2</span><span class="si">}</span><span class="s1">&#39;&#39;&#39;</span>
</span><span id="__span-0-2233"><a id="__codelineno-0-2233" name="__codelineno-0-2233"></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_run</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="__span-0-2234"><a id="__codelineno-0-2234" name="__codelineno-0-2234"></a>
</span><span id="__span-0-2235"><a id="__codelineno-0-2235" name="__codelineno-0-2235"></a>        <span class="k">return</span> <span class="n">df</span>
</span><span id="__span-0-2236"><a id="__codelineno-0-2236" name="__codelineno-0-2236"></a>
</span><span id="__span-0-2237"><a id="__codelineno-0-2237" name="__codelineno-0-2237"></a>    <span class="k">def</span> <span class="nf">linkages</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-2238"><a id="__codelineno-0-2238" name="__codelineno-0-2238"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-0-2239"><a id="__codelineno-0-2239" name="__codelineno-0-2239"></a><span class="sd">        Counts linkages for A2J</span>
</span><span id="__span-0-2240"><a id="__codelineno-0-2240" name="__codelineno-0-2240"></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="__span-0-2241"><a id="__codelineno-0-2241" name="__codelineno-0-2241"></a>        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;select a.*, linkage_type, linkage_org, goal_area</span>
</span><span id="__span-0-2242"><a id="__codelineno-0-2242" name="__codelineno-0-2242"></a><span class="s1">from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span><span class="s1"> a</span>
</span><span id="__span-0-2243"><a id="__codelineno-0-2243" name="__codelineno-0-2243"></a><span class="s1">join civicore.linkages l using(participant_id)</span>
</span><span id="__span-0-2244"><a id="__codelineno-0-2244" name="__codelineno-0-2244"></a><span class="s1">where linked_date between </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t1</span><span class="si">}</span><span class="s1"> and </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t2</span><span class="si">}</span><span class="s1">&#39;&#39;&#39;</span>
</span><span id="__span-0-2245"><a id="__codelineno-0-2245" name="__codelineno-0-2245"></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_run</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="__span-0-2246"><a id="__codelineno-0-2246" name="__codelineno-0-2246"></a>        <span class="k">return</span> <span class="n">df</span>
</span></code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="script.nice_sql.A2J.cases" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">cases</span><span class="p">(</span><span class="n">started_ended</span><span class="o">=</span><span class="s1">&#39;started&#39;</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>counts legal cases for A2J that either started or ended</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>started_ended</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>"started" counts cases started, "ended" is cases ended. Defaults to "started"</p>
            </div>
          </td>
          <td>
                <code>&#39;started&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>script\nice_sql.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2218">2218</a></span>
<span class="normal"><a href="#__codelineno-0-2219">2219</a></span>
<span class="normal"><a href="#__codelineno-0-2220">2220</a></span>
<span class="normal"><a href="#__codelineno-0-2221">2221</a></span>
<span class="normal"><a href="#__codelineno-0-2222">2222</a></span>
<span class="normal"><a href="#__codelineno-0-2223">2223</a></span>
<span class="normal"><a href="#__codelineno-0-2224">2224</a></span>
<span class="normal"><a href="#__codelineno-0-2225">2225</a></span>
<span class="normal"><a href="#__codelineno-0-2226">2226</a></span>
<span class="normal"><a href="#__codelineno-0-2227">2227</a></span>
<span class="normal"><a href="#__codelineno-0-2228">2228</a></span>
<span class="normal"><a href="#__codelineno-0-2229">2229</a></span>
<span class="normal"><a href="#__codelineno-0-2230">2230</a></span>
<span class="normal"><a href="#__codelineno-0-2231">2231</a></span>
<span class="normal"><a href="#__codelineno-0-2232">2232</a></span>
<span class="normal"><a href="#__codelineno-0-2233">2233</a></span>
<span class="normal"><a href="#__codelineno-0-2234">2234</a></span>
<span class="normal"><a href="#__codelineno-0-2235">2235</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2218"><a id="__codelineno-0-2218" name="__codelineno-0-2218"></a>    <span class="k">def</span> <span class="nf">cases</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">started_ended</span> <span class="o">=</span> <span class="s2">&quot;started&quot;</span><span class="p">):</span>
</span><span id="__span-0-2219"><a id="__codelineno-0-2219" name="__codelineno-0-2219"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-0-2220"><a id="__codelineno-0-2220" name="__codelineno-0-2220"></a><span class="sd">        counts legal cases for A2J that either started or ended</span>
</span><span id="__span-0-2221"><a id="__codelineno-0-2221" name="__codelineno-0-2221"></a>
</span><span id="__span-0-2222"><a id="__codelineno-0-2222" name="__codelineno-0-2222"></a><span class="sd">        Parameters:</span>
</span><span id="__span-0-2223"><a id="__codelineno-0-2223" name="__codelineno-0-2223"></a><span class="sd">            started_ended: &quot;started&quot; counts cases started, &quot;ended&quot; is cases ended. Defaults to &quot;started&quot; </span>
</span><span id="__span-0-2224"><a id="__codelineno-0-2224" name="__codelineno-0-2224"></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="__span-0-2225"><a id="__codelineno-0-2225" name="__codelineno-0-2225"></a>        <span class="k">if</span> <span class="n">started_ended</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">==</span> <span class="s2">&quot;started&quot;</span><span class="p">:</span>
</span><span id="__span-0-2226"><a id="__codelineno-0-2226" name="__codelineno-0-2226"></a>            <span class="n">started_ended</span> <span class="o">=</span> <span class="s2">&quot;arrest_date&quot;</span>
</span><span id="__span-0-2227"><a id="__codelineno-0-2227" name="__codelineno-0-2227"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-2228"><a id="__codelineno-0-2228" name="__codelineno-0-2228"></a>            <span class="n">started_ended</span> <span class="o">=</span> <span class="s2">&quot;case_outcome_date&quot;</span>
</span><span id="__span-0-2229"><a id="__codelineno-0-2229" name="__codelineno-0-2229"></a>        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;select </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span><span class="s1">.*, o.offense_date, o.case_outcome_date, o.case_outcome, o.sentence</span>
</span><span id="__span-0-2230"><a id="__codelineno-0-2230" name="__codelineno-0-2230"></a><span class="s1">from participants.a2j</span>
</span><span id="__span-0-2231"><a id="__codelineno-0-2231" name="__codelineno-0-2231"></a><span class="s1">join civicore.legal o using(participant_id)</span>
</span><span id="__span-0-2232"><a id="__codelineno-0-2232" name="__codelineno-0-2232"></a><span class="s1">where </span><span class="si">{</span><span class="n">started_ended</span><span class="si">}</span><span class="s1"> between </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t1</span><span class="si">}</span><span class="s1"> and </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t2</span><span class="si">}</span><span class="s1">&#39;&#39;&#39;</span>
</span><span id="__span-0-2233"><a id="__codelineno-0-2233" name="__codelineno-0-2233"></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_run</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="__span-0-2234"><a id="__codelineno-0-2234" name="__codelineno-0-2234"></a>
</span><span id="__span-0-2235"><a id="__codelineno-0-2235" name="__codelineno-0-2235"></a>        <span class="k">return</span> <span class="n">df</span>
</span></code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="script.nice_sql.A2J.linkages" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">linkages</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Counts linkages for A2J</p>

          <details class="quote">
            <summary>Source code in <code>script\nice_sql.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2237">2237</a></span>
<span class="normal"><a href="#__codelineno-0-2238">2238</a></span>
<span class="normal"><a href="#__codelineno-0-2239">2239</a></span>
<span class="normal"><a href="#__codelineno-0-2240">2240</a></span>
<span class="normal"><a href="#__codelineno-0-2241">2241</a></span>
<span class="normal"><a href="#__codelineno-0-2242">2242</a></span>
<span class="normal"><a href="#__codelineno-0-2243">2243</a></span>
<span class="normal"><a href="#__codelineno-0-2244">2244</a></span>
<span class="normal"><a href="#__codelineno-0-2245">2245</a></span>
<span class="normal"><a href="#__codelineno-0-2246">2246</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2237"><a id="__codelineno-0-2237" name="__codelineno-0-2237"></a>    <span class="k">def</span> <span class="nf">linkages</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-2238"><a id="__codelineno-0-2238" name="__codelineno-0-2238"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-0-2239"><a id="__codelineno-0-2239" name="__codelineno-0-2239"></a><span class="sd">        Counts linkages for A2J</span>
</span><span id="__span-0-2240"><a id="__codelineno-0-2240" name="__codelineno-0-2240"></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="__span-0-2241"><a id="__codelineno-0-2241" name="__codelineno-0-2241"></a>        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;select a.*, linkage_type, linkage_org, goal_area</span>
</span><span id="__span-0-2242"><a id="__codelineno-0-2242" name="__codelineno-0-2242"></a><span class="s1">from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span><span class="s1"> a</span>
</span><span id="__span-0-2243"><a id="__codelineno-0-2243" name="__codelineno-0-2243"></a><span class="s1">join civicore.linkages l using(participant_id)</span>
</span><span id="__span-0-2244"><a id="__codelineno-0-2244" name="__codelineno-0-2244"></a><span class="s1">where linked_date between </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t1</span><span class="si">}</span><span class="s1"> and </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t2</span><span class="si">}</span><span class="s1">&#39;&#39;&#39;</span>
</span><span id="__span-0-2245"><a id="__codelineno-0-2245" name="__codelineno-0-2245"></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_run</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="__span-0-2246"><a id="__codelineno-0-2246" name="__codelineno-0-2246"></a>        <span class="k">return</span> <span class="n">df</span>
</span></code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div><h3 id="running-reports">Running Reports</h3>
<div class="language-py highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">a</span> <span class="o">=</span> <span class="n">A2J</span><span class="p">(</span><span class="n">t1</span> <span class="o">=</span> <span class="s1">&#39;2023-12-01&#39;</span><span class="p">,</span> <span class="n">t2</span> <span class="o">=</span> <span class="s1">&#39;2023-12-31&#39;</span><span class="p">,</span> <span class="n">print_SQL</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> 
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="n">clipboard</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="n">a</span><span class="o">.</span><span class="n">run_report</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">report_funcs</span><span class="p">)</span>
</span></code></pre></div>
<h4 id="report_funcs">report_funcs</h4>
<ul>
<li><strong>CASES_STARTED:</strong> <code>("cases", ("ended",))</code></li>
<li><strong>CASES_ENDED:</strong> <code>("cases", ("started",))</code></li>
<li><strong>LINKAGES:</strong> <code>("linkages", ())</code></li>
</ul>
<h2 id="jac-and-idhs">JAC and IDHS</h2>
<div class="language-py highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="n">j</span> <span class="o">=</span> <span class="n">JAC_IDHS</span><span class="p">(</span><span class="n">t1</span> <span class="o">=</span> <span class="s1">&#39;2023-10-01&#39;</span><span class="p">,</span> <span class="n">t2</span> <span class="o">=</span> <span class="s1">&#39;2023-12-31&#39;</span><span class="p">,</span> <span class="n">print_SQL</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> 
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="n">clipboard</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">grant</span> <span class="o">=</span> <span class="s2">&quot;jac&quot;</span><span class="p">)</span>
</span></code></pre></div>


<div class="doc doc-object doc-class">




  <div class="doc doc-contents first">
          <p class="doc doc-class-bases">
            Bases: <code><span title="script.nice_sql.Queries">Queries</span></code></p>

  
      <p>Sets up a table for running JAC/IDHS reports</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>t1</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>start of the stint (formatted: "YYYY-MM-DD")</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>t2</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>end of the stint (formatted: "YYYY-MM-DD")</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>print_sql</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>whether to print the SQL statements when run, defaults to True</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>clipboard</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>whether to copy the output table to your clipboard, defaults to False</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
        <tr>
          <td><code>grant</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>which grant to include, either "jac" or "idhs"</p>
            </div>
          </td>
          <td>
                <code>&#39;idhs&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

            <details class="quote">
              <summary>Source code in <code>script\nice_sql.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2409">2409</a></span>
<span class="normal"><a href="#__codelineno-0-2410">2410</a></span>
<span class="normal"><a href="#__codelineno-0-2411">2411</a></span>
<span class="normal"><a href="#__codelineno-0-2412">2412</a></span>
<span class="normal"><a href="#__codelineno-0-2413">2413</a></span>
<span class="normal"><a href="#__codelineno-0-2414">2414</a></span>
<span class="normal"><a href="#__codelineno-0-2415">2415</a></span>
<span class="normal"><a href="#__codelineno-0-2416">2416</a></span>
<span class="normal"><a href="#__codelineno-0-2417">2417</a></span>
<span class="normal"><a href="#__codelineno-0-2418">2418</a></span>
<span class="normal"><a href="#__codelineno-0-2419">2419</a></span>
<span class="normal"><a href="#__codelineno-0-2420">2420</a></span>
<span class="normal"><a href="#__codelineno-0-2421">2421</a></span>
<span class="normal"><a href="#__codelineno-0-2422">2422</a></span>
<span class="normal"><a href="#__codelineno-0-2423">2423</a></span>
<span class="normal"><a href="#__codelineno-0-2424">2424</a></span>
<span class="normal"><a href="#__codelineno-0-2425">2425</a></span>
<span class="normal"><a href="#__codelineno-0-2426">2426</a></span>
<span class="normal"><a href="#__codelineno-0-2427">2427</a></span>
<span class="normal"><a href="#__codelineno-0-2428">2428</a></span>
<span class="normal"><a href="#__codelineno-0-2429">2429</a></span>
<span class="normal"><a href="#__codelineno-0-2430">2430</a></span>
<span class="normal"><a href="#__codelineno-0-2431">2431</a></span>
<span class="normal"><a href="#__codelineno-0-2432">2432</a></span>
<span class="normal"><a href="#__codelineno-0-2433">2433</a></span>
<span class="normal"><a href="#__codelineno-0-2434">2434</a></span>
<span class="normal"><a href="#__codelineno-0-2435">2435</a></span>
<span class="normal"><a href="#__codelineno-0-2436">2436</a></span>
<span class="normal"><a href="#__codelineno-0-2437">2437</a></span>
<span class="normal"><a href="#__codelineno-0-2438">2438</a></span>
<span class="normal"><a href="#__codelineno-0-2439">2439</a></span>
<span class="normal"><a href="#__codelineno-0-2440">2440</a></span>
<span class="normal"><a href="#__codelineno-0-2441">2441</a></span>
<span class="normal"><a href="#__codelineno-0-2442">2442</a></span>
<span class="normal"><a href="#__codelineno-0-2443">2443</a></span>
<span class="normal"><a href="#__codelineno-0-2444">2444</a></span>
<span class="normal"><a href="#__codelineno-0-2445">2445</a></span>
<span class="normal"><a href="#__codelineno-0-2446">2446</a></span>
<span class="normal"><a href="#__codelineno-0-2447">2447</a></span>
<span class="normal"><a href="#__codelineno-0-2448">2448</a></span>
<span class="normal"><a href="#__codelineno-0-2449">2449</a></span>
<span class="normal"><a href="#__codelineno-0-2450">2450</a></span>
<span class="normal"><a href="#__codelineno-0-2451">2451</a></span>
<span class="normal"><a href="#__codelineno-0-2452">2452</a></span>
<span class="normal"><a href="#__codelineno-0-2453">2453</a></span>
<span class="normal"><a href="#__codelineno-0-2454">2454</a></span>
<span class="normal"><a href="#__codelineno-0-2455">2455</a></span>
<span class="normal"><a href="#__codelineno-0-2456">2456</a></span>
<span class="normal"><a href="#__codelineno-0-2457">2457</a></span>
<span class="normal"><a href="#__codelineno-0-2458">2458</a></span>
<span class="normal"><a href="#__codelineno-0-2459">2459</a></span>
<span class="normal"><a href="#__codelineno-0-2460">2460</a></span>
<span class="normal"><a href="#__codelineno-0-2461">2461</a></span>
<span class="normal"><a href="#__codelineno-0-2462">2462</a></span>
<span class="normal"><a href="#__codelineno-0-2463">2463</a></span>
<span class="normal"><a href="#__codelineno-0-2464">2464</a></span>
<span class="normal"><a href="#__codelineno-0-2465">2465</a></span>
<span class="normal"><a href="#__codelineno-0-2466">2466</a></span>
<span class="normal"><a href="#__codelineno-0-2467">2467</a></span>
<span class="normal"><a href="#__codelineno-0-2468">2468</a></span>
<span class="normal"><a href="#__codelineno-0-2469">2469</a></span>
<span class="normal"><a href="#__codelineno-0-2470">2470</a></span>
<span class="normal"><a href="#__codelineno-0-2471">2471</a></span>
<span class="normal"><a href="#__codelineno-0-2472">2472</a></span>
<span class="normal"><a href="#__codelineno-0-2473">2473</a></span>
<span class="normal"><a href="#__codelineno-0-2474">2474</a></span>
<span class="normal"><a href="#__codelineno-0-2475">2475</a></span>
<span class="normal"><a href="#__codelineno-0-2476">2476</a></span>
<span class="normal"><a href="#__codelineno-0-2477">2477</a></span>
<span class="normal"><a href="#__codelineno-0-2478">2478</a></span>
<span class="normal"><a href="#__codelineno-0-2479">2479</a></span>
<span class="normal"><a href="#__codelineno-0-2480">2480</a></span>
<span class="normal"><a href="#__codelineno-0-2481">2481</a></span>
<span class="normal"><a href="#__codelineno-0-2482">2482</a></span>
<span class="normal"><a href="#__codelineno-0-2483">2483</a></span>
<span class="normal"><a href="#__codelineno-0-2484">2484</a></span>
<span class="normal"><a href="#__codelineno-0-2485">2485</a></span>
<span class="normal"><a href="#__codelineno-0-2486">2486</a></span>
<span class="normal"><a href="#__codelineno-0-2487">2487</a></span>
<span class="normal"><a href="#__codelineno-0-2488">2488</a></span>
<span class="normal"><a href="#__codelineno-0-2489">2489</a></span>
<span class="normal"><a href="#__codelineno-0-2490">2490</a></span>
<span class="normal"><a href="#__codelineno-0-2491">2491</a></span>
<span class="normal"><a href="#__codelineno-0-2492">2492</a></span>
<span class="normal"><a href="#__codelineno-0-2493">2493</a></span>
<span class="normal"><a href="#__codelineno-0-2494">2494</a></span>
<span class="normal"><a href="#__codelineno-0-2495">2495</a></span>
<span class="normal"><a href="#__codelineno-0-2496">2496</a></span>
<span class="normal"><a href="#__codelineno-0-2497">2497</a></span>
<span class="normal"><a href="#__codelineno-0-2498">2498</a></span>
<span class="normal"><a href="#__codelineno-0-2499">2499</a></span>
<span class="normal"><a href="#__codelineno-0-2500">2500</a></span>
<span class="normal"><a href="#__codelineno-0-2501">2501</a></span>
<span class="normal"><a href="#__codelineno-0-2502">2502</a></span>
<span class="normal"><a href="#__codelineno-0-2503">2503</a></span>
<span class="normal"><a href="#__codelineno-0-2504">2504</a></span>
<span class="normal"><a href="#__codelineno-0-2505">2505</a></span>
<span class="normal"><a href="#__codelineno-0-2506">2506</a></span>
<span class="normal"><a href="#__codelineno-0-2507">2507</a></span>
<span class="normal"><a href="#__codelineno-0-2508">2508</a></span>
<span class="normal"><a href="#__codelineno-0-2509">2509</a></span>
<span class="normal"><a href="#__codelineno-0-2510">2510</a></span>
<span class="normal"><a href="#__codelineno-0-2511">2511</a></span>
<span class="normal"><a href="#__codelineno-0-2512">2512</a></span>
<span class="normal"><a href="#__codelineno-0-2513">2513</a></span>
<span class="normal"><a href="#__codelineno-0-2514">2514</a></span>
<span class="normal"><a href="#__codelineno-0-2515">2515</a></span>
<span class="normal"><a href="#__codelineno-0-2516">2516</a></span>
<span class="normal"><a href="#__codelineno-0-2517">2517</a></span>
<span class="normal"><a href="#__codelineno-0-2518">2518</a></span>
<span class="normal"><a href="#__codelineno-0-2519">2519</a></span>
<span class="normal"><a href="#__codelineno-0-2520">2520</a></span>
<span class="normal"><a href="#__codelineno-0-2521">2521</a></span>
<span class="normal"><a href="#__codelineno-0-2522">2522</a></span>
<span class="normal"><a href="#__codelineno-0-2523">2523</a></span>
<span class="normal"><a href="#__codelineno-0-2524">2524</a></span>
<span class="normal"><a href="#__codelineno-0-2525">2525</a></span>
<span class="normal"><a href="#__codelineno-0-2526">2526</a></span>
<span class="normal"><a href="#__codelineno-0-2527">2527</a></span>
<span class="normal"><a href="#__codelineno-0-2528">2528</a></span>
<span class="normal"><a href="#__codelineno-0-2529">2529</a></span>
<span class="normal"><a href="#__codelineno-0-2530">2530</a></span>
<span class="normal"><a href="#__codelineno-0-2531">2531</a></span>
<span class="normal"><a href="#__codelineno-0-2532">2532</a></span>
<span class="normal"><a href="#__codelineno-0-2533">2533</a></span>
<span class="normal"><a href="#__codelineno-0-2534">2534</a></span>
<span class="normal"><a href="#__codelineno-0-2535">2535</a></span>
<span class="normal"><a href="#__codelineno-0-2536">2536</a></span>
<span class="normal"><a href="#__codelineno-0-2537">2537</a></span>
<span class="normal"><a href="#__codelineno-0-2538">2538</a></span>
<span class="normal"><a href="#__codelineno-0-2539">2539</a></span>
<span class="normal"><a href="#__codelineno-0-2540">2540</a></span>
<span class="normal"><a href="#__codelineno-0-2541">2541</a></span>
<span class="normal"><a href="#__codelineno-0-2542">2542</a></span>
<span class="normal"><a href="#__codelineno-0-2543">2543</a></span>
<span class="normal"><a href="#__codelineno-0-2544">2544</a></span>
<span class="normal"><a href="#__codelineno-0-2545">2545</a></span>
<span class="normal"><a href="#__codelineno-0-2546">2546</a></span>
<span class="normal"><a href="#__codelineno-0-2547">2547</a></span>
<span class="normal"><a href="#__codelineno-0-2548">2548</a></span>
<span class="normal"><a href="#__codelineno-0-2549">2549</a></span>
<span class="normal"><a href="#__codelineno-0-2550">2550</a></span>
<span class="normal"><a href="#__codelineno-0-2551">2551</a></span>
<span class="normal"><a href="#__codelineno-0-2552">2552</a></span>
<span class="normal"><a href="#__codelineno-0-2553">2553</a></span>
<span class="normal"><a href="#__codelineno-0-2554">2554</a></span>
<span class="normal"><a href="#__codelineno-0-2555">2555</a></span>
<span class="normal"><a href="#__codelineno-0-2556">2556</a></span>
<span class="normal"><a href="#__codelineno-0-2557">2557</a></span>
<span class="normal"><a href="#__codelineno-0-2558">2558</a></span>
<span class="normal"><a href="#__codelineno-0-2559">2559</a></span>
<span class="normal"><a href="#__codelineno-0-2560">2560</a></span>
<span class="normal"><a href="#__codelineno-0-2561">2561</a></span>
<span class="normal"><a href="#__codelineno-0-2562">2562</a></span>
<span class="normal"><a href="#__codelineno-0-2563">2563</a></span>
<span class="normal"><a href="#__codelineno-0-2564">2564</a></span>
<span class="normal"><a href="#__codelineno-0-2565">2565</a></span>
<span class="normal"><a href="#__codelineno-0-2566">2566</a></span>
<span class="normal"><a href="#__codelineno-0-2567">2567</a></span>
<span class="normal"><a href="#__codelineno-0-2568">2568</a></span>
<span class="normal"><a href="#__codelineno-0-2569">2569</a></span>
<span class="normal"><a href="#__codelineno-0-2570">2570</a></span>
<span class="normal"><a href="#__codelineno-0-2571">2571</a></span>
<span class="normal"><a href="#__codelineno-0-2572">2572</a></span>
<span class="normal"><a href="#__codelineno-0-2573">2573</a></span>
<span class="normal"><a href="#__codelineno-0-2574">2574</a></span>
<span class="normal"><a href="#__codelineno-0-2575">2575</a></span>
<span class="normal"><a href="#__codelineno-0-2576">2576</a></span>
<span class="normal"><a href="#__codelineno-0-2577">2577</a></span>
<span class="normal"><a href="#__codelineno-0-2578">2578</a></span>
<span class="normal"><a href="#__codelineno-0-2579">2579</a></span>
<span class="normal"><a href="#__codelineno-0-2580">2580</a></span>
<span class="normal"><a href="#__codelineno-0-2581">2581</a></span>
<span class="normal"><a href="#__codelineno-0-2582">2582</a></span>
<span class="normal"><a href="#__codelineno-0-2583">2583</a></span>
<span class="normal"><a href="#__codelineno-0-2584">2584</a></span>
<span class="normal"><a href="#__codelineno-0-2585">2585</a></span>
<span class="normal"><a href="#__codelineno-0-2586">2586</a></span>
<span class="normal"><a href="#__codelineno-0-2587">2587</a></span>
<span class="normal"><a href="#__codelineno-0-2588">2588</a></span>
<span class="normal"><a href="#__codelineno-0-2589">2589</a></span>
<span class="normal"><a href="#__codelineno-0-2590">2590</a></span>
<span class="normal"><a href="#__codelineno-0-2591">2591</a></span>
<span class="normal"><a href="#__codelineno-0-2592">2592</a></span>
<span class="normal"><a href="#__codelineno-0-2593">2593</a></span>
<span class="normal"><a href="#__codelineno-0-2594">2594</a></span>
<span class="normal"><a href="#__codelineno-0-2595">2595</a></span>
<span class="normal"><a href="#__codelineno-0-2596">2596</a></span>
<span class="normal"><a href="#__codelineno-0-2597">2597</a></span>
<span class="normal"><a href="#__codelineno-0-2598">2598</a></span>
<span class="normal"><a href="#__codelineno-0-2599">2599</a></span>
<span class="normal"><a href="#__codelineno-0-2600">2600</a></span>
<span class="normal"><a href="#__codelineno-0-2601">2601</a></span>
<span class="normal"><a href="#__codelineno-0-2602">2602</a></span>
<span class="normal"><a href="#__codelineno-0-2603">2603</a></span>
<span class="normal"><a href="#__codelineno-0-2604">2604</a></span>
<span class="normal"><a href="#__codelineno-0-2605">2605</a></span>
<span class="normal"><a href="#__codelineno-0-2606">2606</a></span>
<span class="normal"><a href="#__codelineno-0-2607">2607</a></span>
<span class="normal"><a href="#__codelineno-0-2608">2608</a></span>
<span class="normal"><a href="#__codelineno-0-2609">2609</a></span>
<span class="normal"><a href="#__codelineno-0-2610">2610</a></span>
<span class="normal"><a href="#__codelineno-0-2611">2611</a></span>
<span class="normal"><a href="#__codelineno-0-2612">2612</a></span>
<span class="normal"><a href="#__codelineno-0-2613">2613</a></span>
<span class="normal"><a href="#__codelineno-0-2614">2614</a></span>
<span class="normal"><a href="#__codelineno-0-2615">2615</a></span>
<span class="normal"><a href="#__codelineno-0-2616">2616</a></span>
<span class="normal"><a href="#__codelineno-0-2617">2617</a></span>
<span class="normal"><a href="#__codelineno-0-2618">2618</a></span>
<span class="normal"><a href="#__codelineno-0-2619">2619</a></span>
<span class="normal"><a href="#__codelineno-0-2620">2620</a></span>
<span class="normal"><a href="#__codelineno-0-2621">2621</a></span>
<span class="normal"><a href="#__codelineno-0-2622">2622</a></span>
<span class="normal"><a href="#__codelineno-0-2623">2623</a></span>
<span class="normal"><a href="#__codelineno-0-2624">2624</a></span>
<span class="normal"><a href="#__codelineno-0-2625">2625</a></span>
<span class="normal"><a href="#__codelineno-0-2626">2626</a></span>
<span class="normal"><a href="#__codelineno-0-2627">2627</a></span>
<span class="normal"><a href="#__codelineno-0-2628">2628</a></span>
<span class="normal"><a href="#__codelineno-0-2629">2629</a></span>
<span class="normal"><a href="#__codelineno-0-2630">2630</a></span>
<span class="normal"><a href="#__codelineno-0-2631">2631</a></span>
<span class="normal"><a href="#__codelineno-0-2632">2632</a></span>
<span class="normal"><a href="#__codelineno-0-2633">2633</a></span>
<span class="normal"><a href="#__codelineno-0-2634">2634</a></span>
<span class="normal"><a href="#__codelineno-0-2635">2635</a></span>
<span class="normal"><a href="#__codelineno-0-2636">2636</a></span>
<span class="normal"><a href="#__codelineno-0-2637">2637</a></span>
<span class="normal"><a href="#__codelineno-0-2638">2638</a></span>
<span class="normal"><a href="#__codelineno-0-2639">2639</a></span>
<span class="normal"><a href="#__codelineno-0-2640">2640</a></span>
<span class="normal"><a href="#__codelineno-0-2641">2641</a></span>
<span class="normal"><a href="#__codelineno-0-2642">2642</a></span>
<span class="normal"><a href="#__codelineno-0-2643">2643</a></span>
<span class="normal"><a href="#__codelineno-0-2644">2644</a></span>
<span class="normal"><a href="#__codelineno-0-2645">2645</a></span>
<span class="normal"><a href="#__codelineno-0-2646">2646</a></span>
<span class="normal"><a href="#__codelineno-0-2647">2647</a></span>
<span class="normal"><a href="#__codelineno-0-2648">2648</a></span>
<span class="normal"><a href="#__codelineno-0-2649">2649</a></span>
<span class="normal"><a href="#__codelineno-0-2650">2650</a></span>
<span class="normal"><a href="#__codelineno-0-2651">2651</a></span>
<span class="normal"><a href="#__codelineno-0-2652">2652</a></span>
<span class="normal"><a href="#__codelineno-0-2653">2653</a></span>
<span class="normal"><a href="#__codelineno-0-2654">2654</a></span>
<span class="normal"><a href="#__codelineno-0-2655">2655</a></span>
<span class="normal"><a href="#__codelineno-0-2656">2656</a></span>
<span class="normal"><a href="#__codelineno-0-2657">2657</a></span>
<span class="normal"><a href="#__codelineno-0-2658">2658</a></span>
<span class="normal"><a href="#__codelineno-0-2659">2659</a></span>
<span class="normal"><a href="#__codelineno-0-2660">2660</a></span>
<span class="normal"><a href="#__codelineno-0-2661">2661</a></span>
<span class="normal"><a href="#__codelineno-0-2662">2662</a></span>
<span class="normal"><a href="#__codelineno-0-2663">2663</a></span>
<span class="normal"><a href="#__codelineno-0-2664">2664</a></span>
<span class="normal"><a href="#__codelineno-0-2665">2665</a></span>
<span class="normal"><a href="#__codelineno-0-2666">2666</a></span>
<span class="normal"><a href="#__codelineno-0-2667">2667</a></span>
<span class="normal"><a href="#__codelineno-0-2668">2668</a></span>
<span class="normal"><a href="#__codelineno-0-2669">2669</a></span>
<span class="normal"><a href="#__codelineno-0-2670">2670</a></span>
<span class="normal"><a href="#__codelineno-0-2671">2671</a></span>
<span class="normal"><a href="#__codelineno-0-2672">2672</a></span>
<span class="normal"><a href="#__codelineno-0-2673">2673</a></span>
<span class="normal"><a href="#__codelineno-0-2674">2674</a></span>
<span class="normal"><a href="#__codelineno-0-2675">2675</a></span>
<span class="normal"><a href="#__codelineno-0-2676">2676</a></span>
<span class="normal"><a href="#__codelineno-0-2677">2677</a></span>
<span class="normal"><a href="#__codelineno-0-2678">2678</a></span>
<span class="normal"><a href="#__codelineno-0-2679">2679</a></span>
<span class="normal"><a href="#__codelineno-0-2680">2680</a></span>
<span class="normal"><a href="#__codelineno-0-2681">2681</a></span>
<span class="normal"><a href="#__codelineno-0-2682">2682</a></span>
<span class="normal"><a href="#__codelineno-0-2683">2683</a></span>
<span class="normal"><a href="#__codelineno-0-2684">2684</a></span>
<span class="normal"><a href="#__codelineno-0-2685">2685</a></span>
<span class="normal"><a href="#__codelineno-0-2686">2686</a></span>
<span class="normal"><a href="#__codelineno-0-2687">2687</a></span>
<span class="normal"><a href="#__codelineno-0-2688">2688</a></span>
<span class="normal"><a href="#__codelineno-0-2689">2689</a></span>
<span class="normal"><a href="#__codelineno-0-2690">2690</a></span>
<span class="normal"><a href="#__codelineno-0-2691">2691</a></span>
<span class="normal"><a href="#__codelineno-0-2692">2692</a></span>
<span class="normal"><a href="#__codelineno-0-2693">2693</a></span>
<span class="normal"><a href="#__codelineno-0-2694">2694</a></span>
<span class="normal"><a href="#__codelineno-0-2695">2695</a></span>
<span class="normal"><a href="#__codelineno-0-2696">2696</a></span>
<span class="normal"><a href="#__codelineno-0-2697">2697</a></span>
<span class="normal"><a href="#__codelineno-0-2698">2698</a></span>
<span class="normal"><a href="#__codelineno-0-2699">2699</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2409"><a id="__codelineno-0-2409" name="__codelineno-0-2409"></a><span class="k">class</span> <span class="nc">JAC_IDHS</span><span class="p">(</span><span class="n">Queries</span><span class="p">):</span>
</span><span id="__span-0-2410"><a id="__codelineno-0-2410" name="__codelineno-0-2410"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;   </span>
</span><span id="__span-0-2411"><a id="__codelineno-0-2411" name="__codelineno-0-2411"></a><span class="sd">    Sets up a table for running JAC/IDHS reports</span>
</span><span id="__span-0-2412"><a id="__codelineno-0-2412" name="__codelineno-0-2412"></a>
</span><span id="__span-0-2413"><a id="__codelineno-0-2413" name="__codelineno-0-2413"></a>
</span><span id="__span-0-2414"><a id="__codelineno-0-2414" name="__codelineno-0-2414"></a><span class="sd">    Parameters:</span>
</span><span id="__span-0-2415"><a id="__codelineno-0-2415" name="__codelineno-0-2415"></a><span class="sd">        t1: start of the stint (formatted: &quot;YYYY-MM-DD&quot;)</span>
</span><span id="__span-0-2416"><a id="__codelineno-0-2416" name="__codelineno-0-2416"></a><span class="sd">        t2: end of the stint (formatted: &quot;YYYY-MM-DD&quot;)</span>
</span><span id="__span-0-2417"><a id="__codelineno-0-2417" name="__codelineno-0-2417"></a><span class="sd">        print_sql: whether to print the SQL statements when run, defaults to True</span>
</span><span id="__span-0-2418"><a id="__codelineno-0-2418" name="__codelineno-0-2418"></a><span class="sd">        clipboard: whether to copy the output table to your clipboard, defaults to False</span>
</span><span id="__span-0-2419"><a id="__codelineno-0-2419" name="__codelineno-0-2419"></a><span class="sd">        grant: which grant to include, either &quot;jac&quot; or &quot;idhs&quot;</span>
</span><span id="__span-0-2420"><a id="__codelineno-0-2420" name="__codelineno-0-2420"></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="__span-0-2421"><a id="__codelineno-0-2421" name="__codelineno-0-2421"></a>    <span class="n">JAC_Smartsheet</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-2422"><a id="__codelineno-0-2422" name="__codelineno-0-2422"></a>    <span class="s1">&#39;participant count&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;idhs_tally&quot;</span><span class="p">,()),</span>
</span><span id="__span-0-2423"><a id="__codelineno-0-2423" name="__codelineno-0-2423"></a>    <span class="s1">&#39;genders&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;dem_race_gender&#39;</span><span class="p">,(</span><span class="kc">False</span><span class="p">,</span><span class="s1">&#39;gender&#39;</span><span class="p">,)),</span>
</span><span id="__span-0-2424"><a id="__codelineno-0-2424" name="__codelineno-0-2424"></a>    <span class="s1">&#39;races&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;dem_race_gender&#39;</span><span class="p">,(</span><span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;race&#39;</span><span class="p">,)),</span>
</span><span id="__span-0-2425"><a id="__codelineno-0-2425" name="__codelineno-0-2425"></a>    <span class="s1">&#39;ages&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;dem_age&#39;</span><span class="p">,()),</span>
</span><span id="__span-0-2426"><a id="__codelineno-0-2426" name="__codelineno-0-2426"></a>    <span class="s1">&#39;services&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;idhs_service_tally&#39;</span><span class="p">,()),</span>
</span><span id="__span-0-2427"><a id="__codelineno-0-2427" name="__codelineno-0-2427"></a>    <span class="s1">&#39;avg hours spent on CM&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;jac_cm_hours&#39;</span><span class="p">,()),</span>
</span><span id="__span-0-2428"><a id="__codelineno-0-2428" name="__codelineno-0-2428"></a>    <span class="s1">&#39;avg number of CM sessions&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;jac_cm_sessions&#39;</span><span class="p">,()),</span>
</span><span id="__span-0-2429"><a id="__codelineno-0-2429" name="__codelineno-0-2429"></a>    <span class="s1">&#39;transportation assistance&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;jac_transpo_assist&#39;</span><span class="p">,()),</span>
</span><span id="__span-0-2430"><a id="__codelineno-0-2430" name="__codelineno-0-2430"></a>    <span class="s1">&#39;connected to other providers&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;jac_linked_participant_tally&#39;</span><span class="p">,</span> <span class="p">()),</span>
</span><span id="__span-0-2431"><a id="__codelineno-0-2431" name="__codelineno-0-2431"></a>    <span class="s1">&#39;referrals&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;idhs_linkages&#39;</span><span class="p">,())</span>
</span><span id="__span-0-2432"><a id="__codelineno-0-2432" name="__codelineno-0-2432"></a><span class="p">}</span>
</span><span id="__span-0-2433"><a id="__codelineno-0-2433" name="__codelineno-0-2433"></a>    <span class="n">CVI</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-2434"><a id="__codelineno-0-2434" name="__codelineno-0-2434"></a>        <span class="s1">&#39;total participants&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;idhs_tally&#39;</span><span class="p">,()),</span>
</span><span id="__span-0-2435"><a id="__codelineno-0-2435" name="__codelineno-0-2435"></a>        <span class="s1">&#39;ages&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;idhs_ages&#39;</span><span class="p">,()),</span>
</span><span id="__span-0-2436"><a id="__codelineno-0-2436" name="__codelineno-0-2436"></a>        <span class="s1">&#39;races&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;idhs_race_gender&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;race&#39;</span><span class="p">,)),</span>
</span><span id="__span-0-2437"><a id="__codelineno-0-2437" name="__codelineno-0-2437"></a>        <span class="s1">&#39;genders&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;idhs_race_gender&#39;</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;gender&#39;</span><span class="p">,)),</span>
</span><span id="__span-0-2438"><a id="__codelineno-0-2438" name="__codelineno-0-2438"></a>        <span class="s1">&#39;languages&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;idhs_language&#39;</span><span class="p">,()),</span>
</span><span id="__span-0-2439"><a id="__codelineno-0-2439" name="__codelineno-0-2439"></a>        <span class="s1">&#39;services&#39;</span><span class="p">:(</span><span class="s1">&#39;idhs_service_tally&#39;</span><span class="p">,()),</span>
</span><span id="__span-0-2440"><a id="__codelineno-0-2440" name="__codelineno-0-2440"></a>        <span class="s1">&#39;referrals&#39;</span><span class="p">:(</span><span class="s1">&#39;idhs_linkages&#39;</span><span class="p">,()),</span>
</span><span id="__span-0-2441"><a id="__codelineno-0-2441" name="__codelineno-0-2441"></a>        <span class="s1">&#39;number of mediations&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;mediation_tally&#39;</span><span class="p">,()),</span>
</span><span id="__span-0-2442"><a id="__codelineno-0-2442" name="__codelineno-0-2442"></a>        <span class="s1">&#39;CPIC notifications&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;idhs_incidents_detailed&#39;</span><span class="p">,</span> <span class="p">(</span><span class="kc">True</span><span class="p">,)),</span>
</span><span id="__span-0-2443"><a id="__codelineno-0-2443" name="__codelineno-0-2443"></a>        <span class="s1">&#39;non-CPIC notifications&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;idhs_incidents_detailed&#39;</span><span class="p">,</span> <span class="p">(</span><span class="kc">False</span><span class="p">,)),</span>
</span><span id="__span-0-2444"><a id="__codelineno-0-2444" name="__codelineno-0-2444"></a>        <span class="s1">&#39;time spent on mediations&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;mediation_time_spent&#39;</span><span class="p">,())</span>
</span><span id="__span-0-2445"><a id="__codelineno-0-2445" name="__codelineno-0-2445"></a>    <span class="p">}</span>
</span><span id="__span-0-2446"><a id="__codelineno-0-2446" name="__codelineno-0-2446"></a>
</span><span id="__span-0-2447"><a id="__codelineno-0-2447" name="__codelineno-0-2447"></a>    <span class="n">PPR</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;new and continuing clients&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;idhs_tally&#39;</span><span class="p">,</span> <span class="p">(</span><span class="kc">False</span><span class="p">,)),</span>
</span><span id="__span-0-2448"><a id="__codelineno-0-2448" name="__codelineno-0-2448"></a>        <span class="s1">&#39;closed clients&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;idhs_tally&#39;</span><span class="p">,</span> <span class="p">(</span><span class="kc">True</span><span class="p">,)),</span>
</span><span id="__span-0-2449"><a id="__codelineno-0-2449" name="__codelineno-0-2449"></a>        <span class="s1">&#39;outreach and legal&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;idhs_service_tally&#39;</span><span class="p">,()),</span>
</span><span id="__span-0-2450"><a id="__codelineno-0-2450" name="__codelineno-0-2450"></a>        <span class="s1">&#39;race&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;dem_race_gender&#39;</span><span class="p">,</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;race&#39;</span><span class="p">,)),</span>
</span><span id="__span-0-2451"><a id="__codelineno-0-2451" name="__codelineno-0-2451"></a>        <span class="s1">&#39;gender&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;dem_race_gender&#39;</span><span class="p">,</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;gender&#39;</span><span class="p">,)),</span>
</span><span id="__span-0-2452"><a id="__codelineno-0-2452" name="__codelineno-0-2452"></a>        <span class="s1">&#39;ages&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;idhs_ages&#39;</span><span class="p">,</span> <span class="p">(</span><span class="kc">True</span><span class="p">,)),</span>
</span><span id="__span-0-2453"><a id="__codelineno-0-2453" name="__codelineno-0-2453"></a>        <span class="s1">&#39;eligibility&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;idhs_class_notes&#39;</span><span class="p">,(</span><span class="kc">True</span><span class="p">,)),</span>
</span><span id="__span-0-2454"><a id="__codelineno-0-2454" name="__codelineno-0-2454"></a>        <span class="s1">&#39;cm linkages&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;idhs_linkages&#39;</span><span class="p">,()),</span>
</span><span id="__span-0-2455"><a id="__codelineno-0-2455" name="__codelineno-0-2455"></a>        <span class="s1">&#39;initial mediations&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;mediation_tally&#39;</span><span class="p">,</span> <span class="p">(</span><span class="kc">False</span><span class="p">,)),</span>
</span><span id="__span-0-2456"><a id="__codelineno-0-2456" name="__codelineno-0-2456"></a>        <span class="s1">&#39;followup mediations&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;mediation_tally&#39;</span><span class="p">,</span> <span class="p">(</span><span class="kc">True</span><span class="p">,)),</span>
</span><span id="__span-0-2457"><a id="__codelineno-0-2457" name="__codelineno-0-2457"></a>        <span class="s1">&#39;incidents&#39;</span><span class="p">:</span> <span class="p">(</span><span class="s1">&#39;incident_tally&#39;</span><span class="p">,())</span>
</span><span id="__span-0-2458"><a id="__codelineno-0-2458" name="__codelineno-0-2458"></a>        <span class="p">}</span>
</span><span id="__span-0-2459"><a id="__codelineno-0-2459" name="__codelineno-0-2459"></a>
</span><span id="__span-0-2460"><a id="__codelineno-0-2460" name="__codelineno-0-2460"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">print_SQL</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">clipboard</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">default_table</span><span class="o">=</span><span class="s2">&quot;stints.classify_by_program&quot;</span><span class="p">,</span> <span class="n">grant</span> <span class="o">=</span> <span class="s1">&#39;idhs&#39;</span><span class="p">):</span>
</span><span id="__span-0-2461"><a id="__codelineno-0-2461" name="__codelineno-0-2461"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">print_SQL</span><span class="p">,</span> <span class="n">clipboard</span><span class="p">,</span> <span class="n">default_table</span><span class="p">)</span>
</span><span id="__span-0-2462"><a id="__codelineno-0-2462" name="__codelineno-0-2462"></a>        <span class="k">if</span> <span class="n">grant</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;idhs&quot;</span><span class="p">:</span>
</span><span id="__span-0-2463"><a id="__codelineno-0-2463" name="__codelineno-0-2463"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">program</span> <span class="o">=</span> <span class="s1">&#39;idhs&#39;</span>
</span><span id="__span-0-2464"><a id="__codelineno-0-2464" name="__codelineno-0-2464"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_update</span><span class="p">(</span><span class="s2">&quot;idhs&quot;</span><span class="p">,</span> <span class="n">update_default_table</span><span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-2465"><a id="__codelineno-0-2465" name="__codelineno-0-2465"></a>        <span class="k">if</span> <span class="n">grant</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;jac&quot;</span><span class="p">:</span>
</span><span id="__span-0-2466"><a id="__codelineno-0-2466" name="__codelineno-0-2466"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">program</span> <span class="o">=</span> <span class="s1">&#39;jac&#39;</span>
</span><span id="__span-0-2467"><a id="__codelineno-0-2467" name="__codelineno-0-2467"></a>            <span class="bp">self</span><span class="o">.</span><span class="n">table_update</span><span class="p">(</span><span class="s2">&quot;jac&quot;</span><span class="p">,</span> <span class="n">update_default_table</span><span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-2468"><a id="__codelineno-0-2468" name="__codelineno-0-2468"></a>
</span><span id="__span-0-2469"><a id="__codelineno-0-2469" name="__codelineno-0-2469"></a>    <span class="k">def</span> <span class="nf">idhs_ages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">PPR</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="__span-0-2470"><a id="__codelineno-0-2470" name="__codelineno-0-2470"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-0-2471"><a id="__codelineno-0-2471" name="__codelineno-0-2471"></a><span class="sd">        Returns ages of IDHS clients in the desired grouping</span>
</span><span id="__span-0-2472"><a id="__codelineno-0-2472" name="__codelineno-0-2472"></a>
</span><span id="__span-0-2473"><a id="__codelineno-0-2473" name="__codelineno-0-2473"></a><span class="sd">        Parameters:</span>
</span><span id="__span-0-2474"><a id="__codelineno-0-2474" name="__codelineno-0-2474"></a><span class="sd">            PPR: if True, groups according to PPR age breakdown. Defaults to False</span>
</span><span id="__span-0-2475"><a id="__codelineno-0-2475" name="__codelineno-0-2475"></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="__span-0-2476"><a id="__codelineno-0-2476" name="__codelineno-0-2476"></a>        <span class="k">if</span> <span class="n">PPR</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="__span-0-2477"><a id="__codelineno-0-2477" name="__codelineno-0-2477"></a>            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;select </span>
</span><span id="__span-0-2478"><a id="__codelineno-0-2478" name="__codelineno-0-2478"></a><span class="s1">        new_client,</span>
</span><span id="__span-0-2479"><a id="__codelineno-0-2479" name="__codelineno-0-2479"></a><span class="s1">        count(distinct case when TIMESTAMPDIFF(YEAR, birth_date, active_date) BETWEEN 0 AND 17 then participant_id else null end) as &quot;Under 18&quot;,</span>
</span><span id="__span-0-2480"><a id="__codelineno-0-2480" name="__codelineno-0-2480"></a><span class="s1">        count(distinct case when TIMESTAMPDIFF(YEAR, birth_date, active_date) BETWEEN 18 AND 25 then participant_id else null end) as &quot;18 to 24&quot;</span>
</span><span id="__span-0-2481"><a id="__codelineno-0-2481" name="__codelineno-0-2481"></a><span class="s1">    from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span>
</span><span id="__span-0-2482"><a id="__codelineno-0-2482" name="__codelineno-0-2482"></a><span class="s1">    join civicore.participants using(participant_id)</span>
</span><span id="__span-0-2483"><a id="__codelineno-0-2483" name="__codelineno-0-2483"></a><span class="s1">    group by new_client&#39;&#39;&#39;</span>
</span><span id="__span-0-2484"><a id="__codelineno-0-2484" name="__codelineno-0-2484"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-2485"><a id="__codelineno-0-2485" name="__codelineno-0-2485"></a>            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;select </span>
</span><span id="__span-0-2486"><a id="__codelineno-0-2486" name="__codelineno-0-2486"></a><span class="s1">        new_client,</span>
</span><span id="__span-0-2487"><a id="__codelineno-0-2487" name="__codelineno-0-2487"></a><span class="s1">        count(distinct case when TIMESTAMPDIFF(YEAR, birth_date, active_date) BETWEEN 0 AND 5 then participant_id else null end) as &quot;0 to 5&quot;,</span>
</span><span id="__span-0-2488"><a id="__codelineno-0-2488" name="__codelineno-0-2488"></a><span class="s1">        count(distinct case when TIMESTAMPDIFF(YEAR, birth_date, active_date) BETWEEN 6 AND 10 then participant_id else null end) as &quot;6 to 10&quot;,</span>
</span><span id="__span-0-2489"><a id="__codelineno-0-2489" name="__codelineno-0-2489"></a><span class="s1">        count(distinct case when TIMESTAMPDIFF(YEAR, birth_date, active_date) BETWEEN 11 AND 13 then participant_id else null end) as &quot;11 to 13&quot;,</span>
</span><span id="__span-0-2490"><a id="__codelineno-0-2490" name="__codelineno-0-2490"></a><span class="s1">        count(distinct case when TIMESTAMPDIFF(YEAR, birth_date, active_date) BETWEEN 14 AND 17 then participant_id else null end) as &quot;14 to 17&quot;,</span>
</span><span id="__span-0-2491"><a id="__codelineno-0-2491" name="__codelineno-0-2491"></a><span class="s1">        count(distinct case when TIMESTAMPDIFF(YEAR, birth_date, active_date) BETWEEN 18 AND 25 then participant_id else null end) as &quot;18 to 24&quot;</span>
</span><span id="__span-0-2492"><a id="__codelineno-0-2492" name="__codelineno-0-2492"></a><span class="s1">    from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span>
</span><span id="__span-0-2493"><a id="__codelineno-0-2493" name="__codelineno-0-2493"></a><span class="s1">    join civicore.participants using(participant_id)</span>
</span><span id="__span-0-2494"><a id="__codelineno-0-2494" name="__codelineno-0-2494"></a><span class="s1">    group by new_client</span>
</span><span id="__span-0-2495"><a id="__codelineno-0-2495" name="__codelineno-0-2495"></a><span class="s1">&#39;&#39;&#39;</span>
</span><span id="__span-0-2496"><a id="__codelineno-0-2496" name="__codelineno-0-2496"></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_run</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="__span-0-2497"><a id="__codelineno-0-2497" name="__codelineno-0-2497"></a>        <span class="k">return</span> <span class="n">df</span>
</span><span id="__span-0-2498"><a id="__codelineno-0-2498" name="__codelineno-0-2498"></a>
</span><span id="__span-0-2499"><a id="__codelineno-0-2499" name="__codelineno-0-2499"></a>    <span class="k">def</span> <span class="nf">idhs_tally</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="__span-0-2500"><a id="__codelineno-0-2500" name="__codelineno-0-2500"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-0-2501"><a id="__codelineno-0-2501" name="__codelineno-0-2501"></a><span class="sd">        counts number of people on grant</span>
</span><span id="__span-0-2502"><a id="__codelineno-0-2502" name="__codelineno-0-2502"></a>
</span><span id="__span-0-2503"><a id="__codelineno-0-2503" name="__codelineno-0-2503"></a><span class="sd">        Parameters:</span>
</span><span id="__span-0-2504"><a id="__codelineno-0-2504" name="__codelineno-0-2504"></a><span class="sd">            closed(Bool): if True, only returns closed clients. Defaults to False</span>
</span><span id="__span-0-2505"><a id="__codelineno-0-2505" name="__codelineno-0-2505"></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="__span-0-2506"><a id="__codelineno-0-2506" name="__codelineno-0-2506"></a>        <span class="k">if</span> <span class="n">closed</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span> 
</span><span id="__span-0-2507"><a id="__codelineno-0-2507" name="__codelineno-0-2507"></a>            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;select new_client, count(distinct participant_id)</span>
</span><span id="__span-0-2508"><a id="__codelineno-0-2508" name="__codelineno-0-2508"></a><span class="s1">    from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span>
</span><span id="__span-0-2509"><a id="__codelineno-0-2509" name="__codelineno-0-2509"></a><span class="s1">    group by new_client&#39;&#39;&#39;</span>
</span><span id="__span-0-2510"><a id="__codelineno-0-2510" name="__codelineno-0-2510"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-2511"><a id="__codelineno-0-2511" name="__codelineno-0-2511"></a>            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;select count(distinct participant_id) from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span>
</span><span id="__span-0-2512"><a id="__codelineno-0-2512" name="__codelineno-0-2512"></a><span class="s1">where end_date between </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t1</span><span class="si">}</span><span class="s1"> and </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t2</span><span class="si">}</span><span class="s1"> or (closed_date between </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t1</span><span class="si">}</span><span class="s1"> and </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t2</span><span class="si">}</span><span class="s1">)&#39;&#39;&#39;</span>
</span><span id="__span-0-2513"><a id="__codelineno-0-2513" name="__codelineno-0-2513"></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_run</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="__span-0-2514"><a id="__codelineno-0-2514" name="__codelineno-0-2514"></a>        <span class="k">return</span> <span class="n">df</span>
</span><span id="__span-0-2515"><a id="__codelineno-0-2515" name="__codelineno-0-2515"></a>
</span><span id="__span-0-2516"><a id="__codelineno-0-2516" name="__codelineno-0-2516"></a>    <span class="k">def</span> <span class="nf">idhs_class_notes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="__span-0-2517"><a id="__codelineno-0-2517" name="__codelineno-0-2517"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-0-2518"><a id="__codelineno-0-2518" name="__codelineno-0-2518"></a><span class="sd">        returns those eligibility acronyms</span>
</span><span id="__span-0-2519"><a id="__codelineno-0-2519" name="__codelineno-0-2519"></a>
</span><span id="__span-0-2520"><a id="__codelineno-0-2520" name="__codelineno-0-2520"></a><span class="sd">        Parameters:</span>
</span><span id="__span-0-2521"><a id="__codelineno-0-2521" name="__codelineno-0-2521"></a><span class="sd">            new(Bool): if True, only returns new clients. Defaults to False</span>
</span><span id="__span-0-2522"><a id="__codelineno-0-2522" name="__codelineno-0-2522"></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="__span-0-2523"><a id="__codelineno-0-2523" name="__codelineno-0-2523"></a>        <span class="k">if</span> <span class="n">new</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="__span-0-2524"><a id="__codelineno-0-2524" name="__codelineno-0-2524"></a>            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;with class as (select * from (select distinct participant_id</span>
</span><span id="__span-0-2525"><a id="__codelineno-0-2525" name="__codelineno-0-2525"></a><span class="s1">    from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span><span class="s1">) j</span>
</span><span id="__span-0-2526"><a id="__codelineno-0-2526" name="__codelineno-0-2526"></a><span class="s1">    join civicore.classes using(participant_id)</span>
</span><span id="__span-0-2527"><a id="__codelineno-0-2527" name="__codelineno-0-2527"></a><span class="s1">    where class regexp &#39;2023 IDHS VP.*&#39; and (unenroll_date is null or unenroll_date between </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t1</span><span class="si">}</span><span class="s1"> and </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t2</span><span class="si">}</span><span class="s1">))</span>
</span><span id="__span-0-2528"><a id="__codelineno-0-2528" name="__codelineno-0-2528"></a>
</span><span id="__span-0-2529"><a id="__codelineno-0-2529" name="__codelineno-0-2529"></a><span class="s1">    SELECT acronym, COUNT(*) AS count</span>
</span><span id="__span-0-2530"><a id="__codelineno-0-2530" name="__codelineno-0-2530"></a><span class="s1">    FROM (</span>
</span><span id="__span-0-2531"><a id="__codelineno-0-2531" name="__codelineno-0-2531"></a><span class="s1">        SELECT TRIM(REPLACE(REGEXP_SUBSTR(CAST(summary_note AS CHAR), &#39;[[:alnum:]]+&#39;, 1, n.n), &#39; &#39;, &#39;&#39;)) AS acronym</span>
</span><span id="__span-0-2532"><a id="__codelineno-0-2532" name="__codelineno-0-2532"></a><span class="s1">        FROM class</span>
</span><span id="__span-0-2533"><a id="__codelineno-0-2533" name="__codelineno-0-2533"></a><span class="s1">        JOIN (</span>
</span><span id="__span-0-2534"><a id="__codelineno-0-2534" name="__codelineno-0-2534"></a><span class="s1">            SELECT a.N + b.N * 10 + 1 AS n</span>
</span><span id="__span-0-2535"><a id="__codelineno-0-2535" name="__codelineno-0-2535"></a><span class="s1">            FROM</span>
</span><span id="__span-0-2536"><a id="__codelineno-0-2536" name="__codelineno-0-2536"></a><span class="s1">                (SELECT 0 AS N UNION ALL SELECT 1 UNION ALL SELECT 2 UNION ALL SELECT 3) a,</span>
</span><span id="__span-0-2537"><a id="__codelineno-0-2537" name="__codelineno-0-2537"></a><span class="s1">                (SELECT 0 AS N UNION ALL SELECT 1 UNION ALL SELECT 2 UNION ALL SELECT 3) b</span>
</span><span id="__span-0-2538"><a id="__codelineno-0-2538" name="__codelineno-0-2538"></a><span class="s1">            ORDER BY n</span>
</span><span id="__span-0-2539"><a id="__codelineno-0-2539" name="__codelineno-0-2539"></a><span class="s1">        ) n ON CHAR_LENGTH(CAST(summary_note AS CHAR)) - CHAR_LENGTH(REGEXP_REPLACE(CAST(summary_note AS CHAR), &#39;[[:alnum:]]+&#39;, &#39;&#39;)) &gt;= n.n</span>
</span><span id="__span-0-2540"><a id="__codelineno-0-2540" name="__codelineno-0-2540"></a><span class="s1">    ) AS Acronyms</span>
</span><span id="__span-0-2541"><a id="__codelineno-0-2541" name="__codelineno-0-2541"></a><span class="s1">    WHERE acronym != &#39;&#39;</span>
</span><span id="__span-0-2542"><a id="__codelineno-0-2542" name="__codelineno-0-2542"></a><span class="s1">    GROUP BY acronym&#39;&#39;&#39;</span>
</span><span id="__span-0-2543"><a id="__codelineno-0-2543" name="__codelineno-0-2543"></a>        <span class="k">if</span> <span class="n">new</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__span-0-2544"><a id="__codelineno-0-2544" name="__codelineno-0-2544"></a>            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;with class as (select * from (select distinct participant_id</span>
</span><span id="__span-0-2545"><a id="__codelineno-0-2545" name="__codelineno-0-2545"></a><span class="s1">    from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span><span class="s1"> where start_date &gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t1</span><span class="si">}</span><span class="s1">) j</span>
</span><span id="__span-0-2546"><a id="__codelineno-0-2546" name="__codelineno-0-2546"></a><span class="s1">    join civicore.classes using(participant_id)</span>
</span><span id="__span-0-2547"><a id="__codelineno-0-2547" name="__codelineno-0-2547"></a><span class="s1">    where class regexp &#39;2023 IDHS VP.*&#39; and (unenroll_date is null or unenroll_date between </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t1</span><span class="si">}</span><span class="s1"> and </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t2</span><span class="si">}</span><span class="s1">))</span>
</span><span id="__span-0-2548"><a id="__codelineno-0-2548" name="__codelineno-0-2548"></a>
</span><span id="__span-0-2549"><a id="__codelineno-0-2549" name="__codelineno-0-2549"></a><span class="s1">    SELECT acronym, COUNT(*) AS count</span>
</span><span id="__span-0-2550"><a id="__codelineno-0-2550" name="__codelineno-0-2550"></a><span class="s1">    FROM (</span>
</span><span id="__span-0-2551"><a id="__codelineno-0-2551" name="__codelineno-0-2551"></a><span class="s1">        SELECT TRIM(REPLACE(REGEXP_SUBSTR(CAST(summary_note AS CHAR), &#39;[[:alnum:]]+&#39;, 1, n.n), &#39; &#39;, &#39;&#39;)) AS acronym</span>
</span><span id="__span-0-2552"><a id="__codelineno-0-2552" name="__codelineno-0-2552"></a><span class="s1">        FROM class</span>
</span><span id="__span-0-2553"><a id="__codelineno-0-2553" name="__codelineno-0-2553"></a><span class="s1">        JOIN (</span>
</span><span id="__span-0-2554"><a id="__codelineno-0-2554" name="__codelineno-0-2554"></a><span class="s1">            SELECT a.N + b.N * 10 + 1 AS n</span>
</span><span id="__span-0-2555"><a id="__codelineno-0-2555" name="__codelineno-0-2555"></a><span class="s1">            FROM</span>
</span><span id="__span-0-2556"><a id="__codelineno-0-2556" name="__codelineno-0-2556"></a><span class="s1">                (SELECT 0 AS N UNION ALL SELECT 1 UNION ALL SELECT 2 UNION ALL SELECT 3) a,</span>
</span><span id="__span-0-2557"><a id="__codelineno-0-2557" name="__codelineno-0-2557"></a><span class="s1">                (SELECT 0 AS N UNION ALL SELECT 1 UNION ALL SELECT 2 UNION ALL SELECT 3) b</span>
</span><span id="__span-0-2558"><a id="__codelineno-0-2558" name="__codelineno-0-2558"></a><span class="s1">            ORDER BY n</span>
</span><span id="__span-0-2559"><a id="__codelineno-0-2559" name="__codelineno-0-2559"></a><span class="s1">        ) n ON CHAR_LENGTH(CAST(summary_note AS CHAR)) - CHAR_LENGTH(REGEXP_REPLACE(CAST(summary_note AS CHAR), &#39;[[:alnum:]]+&#39;, &#39;&#39;)) &gt;= n.n</span>
</span><span id="__span-0-2560"><a id="__codelineno-0-2560" name="__codelineno-0-2560"></a><span class="s1">    ) AS Acronyms</span>
</span><span id="__span-0-2561"><a id="__codelineno-0-2561" name="__codelineno-0-2561"></a><span class="s1">    WHERE acronym != &#39;&#39;</span>
</span><span id="__span-0-2562"><a id="__codelineno-0-2562" name="__codelineno-0-2562"></a><span class="s1">    GROUP BY acronym&#39;&#39;&#39;</span>
</span><span id="__span-0-2563"><a id="__codelineno-0-2563" name="__codelineno-0-2563"></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_run</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="__span-0-2564"><a id="__codelineno-0-2564" name="__codelineno-0-2564"></a>        <span class="k">return</span> <span class="n">df</span>
</span><span id="__span-0-2565"><a id="__codelineno-0-2565" name="__codelineno-0-2565"></a>
</span><span id="__span-0-2566"><a id="__codelineno-0-2566" name="__codelineno-0-2566"></a>    <span class="k">def</span> <span class="nf">idhs_race_gender</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">race_gender</span> <span class="o">=</span> <span class="s1">&#39;race&#39;</span><span class="p">):</span>
</span><span id="__span-0-2567"><a id="__codelineno-0-2567" name="__codelineno-0-2567"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-0-2568"><a id="__codelineno-0-2568" name="__codelineno-0-2568"></a><span class="sd">        Returns count of race/gender, distinguishing between new/continuing clients</span>
</span><span id="__span-0-2569"><a id="__codelineno-0-2569" name="__codelineno-0-2569"></a>
</span><span id="__span-0-2570"><a id="__codelineno-0-2570" name="__codelineno-0-2570"></a><span class="sd">        Parameters:</span>
</span><span id="__span-0-2571"><a id="__codelineno-0-2571" name="__codelineno-0-2571"></a><span class="sd">            race_gender: &#39;race&#39; returns client races, &#39;gender&#39; returns client genders. Defaults to &#39;race&#39;</span>
</span><span id="__span-0-2572"><a id="__codelineno-0-2572" name="__codelineno-0-2572"></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="__span-0-2573"><a id="__codelineno-0-2573" name="__codelineno-0-2573"></a>        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;select new_client, </span><span class="si">{</span><span class="n">race_gender</span><span class="si">}</span><span class="s1">, count(</span><span class="si">{</span><span class="n">race_gender</span><span class="si">}</span><span class="s1">)</span>
</span><span id="__span-0-2574"><a id="__codelineno-0-2574" name="__codelineno-0-2574"></a><span class="s1">from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span>
</span><span id="__span-0-2575"><a id="__codelineno-0-2575" name="__codelineno-0-2575"></a><span class="s1">join civicore.participants using(participant_id)</span>
</span><span id="__span-0-2576"><a id="__codelineno-0-2576" name="__codelineno-0-2576"></a><span class="s1">group by new_client, </span><span class="si">{</span><span class="n">race_gender</span><span class="si">}</span><span class="s1">&#39;&#39;&#39;</span>
</span><span id="__span-0-2577"><a id="__codelineno-0-2577" name="__codelineno-0-2577"></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_run</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="__span-0-2578"><a id="__codelineno-0-2578" name="__codelineno-0-2578"></a>        <span class="k">return</span> <span class="n">df</span>
</span><span id="__span-0-2579"><a id="__codelineno-0-2579" name="__codelineno-0-2579"></a>
</span><span id="__span-0-2580"><a id="__codelineno-0-2580" name="__codelineno-0-2580"></a>    <span class="k">def</span> <span class="nf">idhs_language</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-2581"><a id="__codelineno-0-2581" name="__codelineno-0-2581"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-0-2582"><a id="__codelineno-0-2582" name="__codelineno-0-2582"></a><span class="sd">        counts participant primary languages</span>
</span><span id="__span-0-2583"><a id="__codelineno-0-2583" name="__codelineno-0-2583"></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="__span-0-2584"><a id="__codelineno-0-2584" name="__codelineno-0-2584"></a>        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;select new_client, language_primary, count(distinct participant_id)</span>
</span><span id="__span-0-2585"><a id="__codelineno-0-2585" name="__codelineno-0-2585"></a><span class="s1">from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span>
</span><span id="__span-0-2586"><a id="__codelineno-0-2586" name="__codelineno-0-2586"></a><span class="s1">join civicore.participants using(participant_id)</span>
</span><span id="__span-0-2587"><a id="__codelineno-0-2587" name="__codelineno-0-2587"></a><span class="s1">group by new_client, language_primary&#39;&#39;&#39;</span>
</span><span id="__span-0-2588"><a id="__codelineno-0-2588" name="__codelineno-0-2588"></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_run</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="__span-0-2589"><a id="__codelineno-0-2589" name="__codelineno-0-2589"></a>        <span class="k">return</span> <span class="n">df</span>
</span><span id="__span-0-2590"><a id="__codelineno-0-2590" name="__codelineno-0-2590"></a>
</span><span id="__span-0-2591"><a id="__codelineno-0-2591" name="__codelineno-0-2591"></a>    <span class="k">def</span> <span class="nf">idhs_service_tally</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-2592"><a id="__codelineno-0-2592" name="__codelineno-0-2592"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-0-2593"><a id="__codelineno-0-2593" name="__codelineno-0-2593"></a><span class="sd">        counts clients receiving services from the chosen grant</span>
</span><span id="__span-0-2594"><a id="__codelineno-0-2594" name="__codelineno-0-2594"></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="__span-0-2595"><a id="__codelineno-0-2595" name="__codelineno-0-2595"></a>        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;select new_client, count(distinct case when program_type regexp &quot;.*</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">program</span><span class="si">}</span><span class="s1"> - Outreach.*&quot; then participant_id else null end) as outreach, </span>
</span><span id="__span-0-2596"><a id="__codelineno-0-2596" name="__codelineno-0-2596"></a><span class="s1">count(distinct case when program_type regexp &quot;.*</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">program</span><span class="si">}</span><span class="s1"> - Case.*&quot; then participant_id else null end) as CM,</span>
</span><span id="__span-0-2597"><a id="__codelineno-0-2597" name="__codelineno-0-2597"></a><span class="s1">count(distinct case when program_type regexp &quot;.*</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">program</span><span class="si">}</span><span class="s1"> - Legal.*&quot; then participant_id else null end) as legal</span>
</span><span id="__span-0-2598"><a id="__codelineno-0-2598" name="__codelineno-0-2598"></a><span class="s1">from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span>
</span><span id="__span-0-2599"><a id="__codelineno-0-2599" name="__codelineno-0-2599"></a><span class="s1">group by new_client&#39;&#39;&#39;</span>
</span><span id="__span-0-2600"><a id="__codelineno-0-2600" name="__codelineno-0-2600"></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_run</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="__span-0-2601"><a id="__codelineno-0-2601" name="__codelineno-0-2601"></a>        <span class="k">return</span> <span class="n">df</span>
</span><span id="__span-0-2602"><a id="__codelineno-0-2602" name="__codelineno-0-2602"></a>
</span><span id="__span-0-2603"><a id="__codelineno-0-2603" name="__codelineno-0-2603"></a>
</span><span id="__span-0-2604"><a id="__codelineno-0-2604" name="__codelineno-0-2604"></a>    <span class="k">def</span> <span class="nf">idhs_linkages</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-2605"><a id="__codelineno-0-2605" name="__codelineno-0-2605"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-0-2606"><a id="__codelineno-0-2606" name="__codelineno-0-2606"></a><span class="sd">        returns goal areas for clients receiving a grant&#39;s case management</span>
</span><span id="__span-0-2607"><a id="__codelineno-0-2607" name="__codelineno-0-2607"></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="__span-0-2608"><a id="__codelineno-0-2608" name="__codelineno-0-2608"></a>        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;with separated_goals as (SELECT participant_id, first_name, last_name, linkage_id, linkage_type, linkage_org, linked_date, hub_initiated, new_client, SUBSTRING_INDEX(SUBSTRING_INDEX(goal_area, &#39;, &#39;, n), &#39;, &#39;, -1) AS separated_area</span>
</span><span id="__span-0-2609"><a id="__codelineno-0-2609" name="__codelineno-0-2609"></a><span class="s1">FROM (select participant_id, first_name, last_name, linkage_type, linkage_org, linkage_id, goal_area, linked_date, hub_initiated, new_client from (select * from </span>
</span><span id="__span-0-2610"><a id="__codelineno-0-2610" name="__codelineno-0-2610"></a><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span>
</span><span id="__span-0-2611"><a id="__codelineno-0-2611" name="__codelineno-0-2611"></a><span class="s1">where program_type regexp &#39;.*</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">program</span><span class="si">}</span><span class="s1"> - case.*&#39;) p</span>
</span><span id="__span-0-2612"><a id="__codelineno-0-2612" name="__codelineno-0-2612"></a><span class="s1">join civicore.linkages l using(participant_id) where hub_initiated = &quot;Yes&quot;) s</span>
</span><span id="__span-0-2613"><a id="__codelineno-0-2613" name="__codelineno-0-2613"></a><span class="s1">JOIN (</span>
</span><span id="__span-0-2614"><a id="__codelineno-0-2614" name="__codelineno-0-2614"></a><span class="s1">    SELECT 1 AS n UNION ALL</span>
</span><span id="__span-0-2615"><a id="__codelineno-0-2615" name="__codelineno-0-2615"></a><span class="s1">    SELECT 2 UNION ALL</span>
</span><span id="__span-0-2616"><a id="__codelineno-0-2616" name="__codelineno-0-2616"></a><span class="s1">    SELECT 3 UNION ALL</span>
</span><span id="__span-0-2617"><a id="__codelineno-0-2617" name="__codelineno-0-2617"></a><span class="s1">    SELECT 4 UNION ALL</span>
</span><span id="__span-0-2618"><a id="__codelineno-0-2618" name="__codelineno-0-2618"></a><span class="s1">    SELECT 5 UNION ALL</span>
</span><span id="__span-0-2619"><a id="__codelineno-0-2619" name="__codelineno-0-2619"></a><span class="s1">    SELECT 6 UNION ALL</span>
</span><span id="__span-0-2620"><a id="__codelineno-0-2620" name="__codelineno-0-2620"></a><span class="s1">    SELECT 7 UNION ALL</span>
</span><span id="__span-0-2621"><a id="__codelineno-0-2621" name="__codelineno-0-2621"></a><span class="s1">    SELECT 8 UNION ALL</span>
</span><span id="__span-0-2622"><a id="__codelineno-0-2622" name="__codelineno-0-2622"></a><span class="s1">    SELECT 9</span>
</span><span id="__span-0-2623"><a id="__codelineno-0-2623" name="__codelineno-0-2623"></a><span class="s1">) AS numbers</span>
</span><span id="__span-0-2624"><a id="__codelineno-0-2624" name="__codelineno-0-2624"></a><span class="s1">ON CHAR_LENGTH(goal_area) - CHAR_LENGTH(REPLACE(goal_area, &#39;,&#39;, &#39;&#39;)) &gt;= n - 1)</span>
</span><span id="__span-0-2625"><a id="__codelineno-0-2625" name="__codelineno-0-2625"></a>
</span><span id="__span-0-2626"><a id="__codelineno-0-2626" name="__codelineno-0-2626"></a><span class="s1">select separated_area, count(distinct case when new_client = &quot;new&quot; then linkage_id end) as new_links, count(distinct case when new_client = &quot;continuing&quot; then linkage_id end) as cont_links</span>
</span><span id="__span-0-2627"><a id="__codelineno-0-2627" name="__codelineno-0-2627"></a><span class="s1">from separated_goals</span>
</span><span id="__span-0-2628"><a id="__codelineno-0-2628" name="__codelineno-0-2628"></a><span class="s1">where linked_date between </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t1</span><span class="si">}</span><span class="s1"> and </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t2</span><span class="si">}</span>
</span><span id="__span-0-2629"><a id="__codelineno-0-2629" name="__codelineno-0-2629"></a><span class="s1">group by separated_area&#39;&#39;&#39;</span>
</span><span id="__span-0-2630"><a id="__codelineno-0-2630" name="__codelineno-0-2630"></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_run</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="__span-0-2631"><a id="__codelineno-0-2631" name="__codelineno-0-2631"></a>        <span class="k">return</span> <span class="n">df</span>
</span><span id="__span-0-2632"><a id="__codelineno-0-2632" name="__codelineno-0-2632"></a>
</span><span id="__span-0-2633"><a id="__codelineno-0-2633" name="__codelineno-0-2633"></a>    <span class="k">def</span> <span class="nf">idhs_incidents_detailed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">CPIC</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="__span-0-2634"><a id="__codelineno-0-2634" name="__codelineno-0-2634"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-0-2635"><a id="__codelineno-0-2635" name="__codelineno-0-2635"></a><span class="sd">        returns incident analysis. need to update code to specify neighborhoods.</span>
</span><span id="__span-0-2636"><a id="__codelineno-0-2636" name="__codelineno-0-2636"></a>
</span><span id="__span-0-2637"><a id="__codelineno-0-2637" name="__codelineno-0-2637"></a>
</span><span id="__span-0-2638"><a id="__codelineno-0-2638" name="__codelineno-0-2638"></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="__span-0-2639"><a id="__codelineno-0-2639" name="__codelineno-0-2639"></a>        <span class="k">if</span> <span class="n">CPIC</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__span-0-2640"><a id="__codelineno-0-2640" name="__codelineno-0-2640"></a>            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;SELECT type_incident,</span>
</span><span id="__span-0-2641"><a id="__codelineno-0-2641" name="__codelineno-0-2641"></a><span class="s1">count(case when num_deceased &gt; 0 then incident_id else null end) as fatal,</span>
</span><span id="__span-0-2642"><a id="__codelineno-0-2642" name="__codelineno-0-2642"></a><span class="s1">count(case when num_deceased = 0 then incident_id else null end) as non_fatal</span>
</span><span id="__span-0-2643"><a id="__codelineno-0-2643" name="__codelineno-0-2643"></a><span class="s1">FROM civicore.critical_incidents</span>
</span><span id="__span-0-2644"><a id="__codelineno-0-2644" name="__codelineno-0-2644"></a><span class="s1">where how_hear regexp &#39;.*cpic.*&#39; and date_incident between </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t1</span><span class="si">}</span><span class="s1"> and </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t2</span><span class="si">}</span>
</span><span id="__span-0-2645"><a id="__codelineno-0-2645" name="__codelineno-0-2645"></a><span class="s1">group by type_incident&#39;&#39;&#39;</span>
</span><span id="__span-0-2646"><a id="__codelineno-0-2646" name="__codelineno-0-2646"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-2647"><a id="__codelineno-0-2647" name="__codelineno-0-2647"></a>            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;select how_hear, count(incident_id) from civicore.critical_incidents</span>
</span><span id="__span-0-2648"><a id="__codelineno-0-2648" name="__codelineno-0-2648"></a><span class="s1">where date_incident between </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t1</span><span class="si">}</span><span class="s1"> and </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t2</span><span class="si">}</span><span class="s1"> and how_hear not regexp &#39;.*cpic.*&#39;</span>
</span><span id="__span-0-2649"><a id="__codelineno-0-2649" name="__codelineno-0-2649"></a><span class="s1">group by how_hear&#39;&#39;&#39;</span>
</span><span id="__span-0-2650"><a id="__codelineno-0-2650" name="__codelineno-0-2650"></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_run</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="__span-0-2651"><a id="__codelineno-0-2651" name="__codelineno-0-2651"></a>        <span class="k">return</span> <span class="n">df</span>
</span><span id="__span-0-2652"><a id="__codelineno-0-2652" name="__codelineno-0-2652"></a>
</span><span id="__span-0-2653"><a id="__codelineno-0-2653" name="__codelineno-0-2653"></a>    <span class="k">def</span> <span class="nf">jac_cm_hours</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-2654"><a id="__codelineno-0-2654" name="__codelineno-0-2654"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-0-2655"><a id="__codelineno-0-2655" name="__codelineno-0-2655"></a><span class="sd">        gets average case management hours for JAC clients</span>
</span><span id="__span-0-2656"><a id="__codelineno-0-2656" name="__codelineno-0-2656"></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="__span-0-2657"><a id="__codelineno-0-2657" name="__codelineno-0-2657"></a>
</span><span id="__span-0-2658"><a id="__codelineno-0-2658" name="__codelineno-0-2658"></a>        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;select avg(hours) as overall_avg from</span>
</span><span id="__span-0-2659"><a id="__codelineno-0-2659" name="__codelineno-0-2659"></a><span class="s1">(select participant_id, sum(hours) as hours from </span>
</span><span id="__span-0-2660"><a id="__codelineno-0-2660" name="__codelineno-0-2660"></a><span class="s1">(select distinct participant_id </span>
</span><span id="__span-0-2661"><a id="__codelineno-0-2661" name="__codelineno-0-2661"></a><span class="s1">from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span>
</span><span id="__span-0-2662"><a id="__codelineno-0-2662" name="__codelineno-0-2662"></a><span class="s1">where program_type REGEXP &#39;.*</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">program</span><span class="si">}</span><span class="s1"> - Case Management.*&#39;) l</span>
</span><span id="__span-0-2663"><a id="__codelineno-0-2663" name="__codelineno-0-2663"></a><span class="s1">join civicore.case_sessions using(participant_id)</span>
</span><span id="__span-0-2664"><a id="__codelineno-0-2664" name="__codelineno-0-2664"></a><span class="s1">where session_date BETWEEN </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t1</span><span class="si">}</span><span class="s1"> and </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t2</span><span class="si">}</span><span class="s1"> AND session_casenote = &quot;casenote&quot;</span>
</span><span id="__span-0-2665"><a id="__codelineno-0-2665" name="__codelineno-0-2665"></a><span class="s1">group by participant_id) ll&#39;&#39;&#39;</span>
</span><span id="__span-0-2666"><a id="__codelineno-0-2666" name="__codelineno-0-2666"></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_run</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="__span-0-2667"><a id="__codelineno-0-2667" name="__codelineno-0-2667"></a>        <span class="k">return</span> <span class="n">df</span>
</span><span id="__span-0-2668"><a id="__codelineno-0-2668" name="__codelineno-0-2668"></a>
</span><span id="__span-0-2669"><a id="__codelineno-0-2669" name="__codelineno-0-2669"></a>    <span class="k">def</span> <span class="nf">jac_cm_sessions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-2670"><a id="__codelineno-0-2670" name="__codelineno-0-2670"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-0-2671"><a id="__codelineno-0-2671" name="__codelineno-0-2671"></a><span class="sd">        gets average case management sessions for JAC clients</span>
</span><span id="__span-0-2672"><a id="__codelineno-0-2672" name="__codelineno-0-2672"></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="__span-0-2673"><a id="__codelineno-0-2673" name="__codelineno-0-2673"></a>        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;select count(distinct case_session_id)/count(distinct participant_id) from (select * from (select distinct participant_id </span>
</span><span id="__span-0-2674"><a id="__codelineno-0-2674" name="__codelineno-0-2674"></a><span class="s1">from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span>
</span><span id="__span-0-2675"><a id="__codelineno-0-2675" name="__codelineno-0-2675"></a><span class="s1">where program_type REGEXP &#39;.*</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">program</span><span class="si">}</span><span class="s1"> - Case Management.*&#39;) l</span>
</span><span id="__span-0-2676"><a id="__codelineno-0-2676" name="__codelineno-0-2676"></a><span class="s1">join civicore.case_sessions using(participant_id)</span>
</span><span id="__span-0-2677"><a id="__codelineno-0-2677" name="__codelineno-0-2677"></a><span class="s1">where session_date BETWEEN </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t1</span><span class="si">}</span><span class="s1"> and </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t2</span><span class="si">}</span><span class="s1"> AND session_casenote = &quot;casenote&quot; and hours &gt; 0 and (indirect_type != &#39;Unsuccessful Attempt&#39; or indirect_type IS NULL)) ll;&#39;&#39;&#39;</span>
</span><span id="__span-0-2678"><a id="__codelineno-0-2678" name="__codelineno-0-2678"></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_run</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="__span-0-2679"><a id="__codelineno-0-2679" name="__codelineno-0-2679"></a>        <span class="k">return</span> <span class="n">df</span>
</span><span id="__span-0-2680"><a id="__codelineno-0-2680" name="__codelineno-0-2680"></a>
</span><span id="__span-0-2681"><a id="__codelineno-0-2681" name="__codelineno-0-2681"></a>    <span class="k">def</span> <span class="nf">jac_transpo_assist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-2682"><a id="__codelineno-0-2682" name="__codelineno-0-2682"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-0-2683"><a id="__codelineno-0-2683" name="__codelineno-0-2683"></a><span class="sd">        counts clients marked as both jac and CRwS</span>
</span><span id="__span-0-2684"><a id="__codelineno-0-2684" name="__codelineno-0-2684"></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="__span-0-2685"><a id="__codelineno-0-2685" name="__codelineno-0-2685"></a>        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;select count(distinct participant_id)</span>
</span><span id="__span-0-2686"><a id="__codelineno-0-2686" name="__codelineno-0-2686"></a><span class="s1">from participants.jac</span>
</span><span id="__span-0-2687"><a id="__codelineno-0-2687" name="__codelineno-0-2687"></a><span class="s1">where program_type like &quot;%JAC%&quot; and crws = 1&#39;&#39;&#39;</span>
</span><span id="__span-0-2688"><a id="__codelineno-0-2688" name="__codelineno-0-2688"></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_run</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="__span-0-2689"><a id="__codelineno-0-2689" name="__codelineno-0-2689"></a>        <span class="k">return</span> <span class="n">df</span>
</span><span id="__span-0-2690"><a id="__codelineno-0-2690" name="__codelineno-0-2690"></a>
</span><span id="__span-0-2691"><a id="__codelineno-0-2691" name="__codelineno-0-2691"></a>    <span class="k">def</span> <span class="nf">jac_linked_participant_tally</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-2692"><a id="__codelineno-0-2692" name="__codelineno-0-2692"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-0-2693"><a id="__codelineno-0-2693" name="__codelineno-0-2693"></a><span class="sd">        counts jac participants with a started linkage</span>
</span><span id="__span-0-2694"><a id="__codelineno-0-2694" name="__codelineno-0-2694"></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="__span-0-2695"><a id="__codelineno-0-2695" name="__codelineno-0-2695"></a>        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;select count(distinct participant_id) from participants.jac</span>
</span><span id="__span-0-2696"><a id="__codelineno-0-2696" name="__codelineno-0-2696"></a><span class="s1">join civicore.linkages l using (participant_id)</span>
</span><span id="__span-0-2697"><a id="__codelineno-0-2697" name="__codelineno-0-2697"></a><span class="s1">where l.start_date IS NOT NULL&#39;&#39;&#39;</span>
</span><span id="__span-0-2698"><a id="__codelineno-0-2698" name="__codelineno-0-2698"></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_run</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="__span-0-2699"><a id="__codelineno-0-2699" name="__codelineno-0-2699"></a>        <span class="k">return</span> <span class="n">df</span>
</span></code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="script.nice_sql.JAC_IDHS.idhs_ages" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">idhs_ages</span><span class="p">(</span><span class="n">PPR</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns ages of IDHS clients in the desired grouping</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>PPR</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>if True, groups according to PPR age breakdown. Defaults to False</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>script\nice_sql.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2469">2469</a></span>
<span class="normal"><a href="#__codelineno-0-2470">2470</a></span>
<span class="normal"><a href="#__codelineno-0-2471">2471</a></span>
<span class="normal"><a href="#__codelineno-0-2472">2472</a></span>
<span class="normal"><a href="#__codelineno-0-2473">2473</a></span>
<span class="normal"><a href="#__codelineno-0-2474">2474</a></span>
<span class="normal"><a href="#__codelineno-0-2475">2475</a></span>
<span class="normal"><a href="#__codelineno-0-2476">2476</a></span>
<span class="normal"><a href="#__codelineno-0-2477">2477</a></span>
<span class="normal"><a href="#__codelineno-0-2478">2478</a></span>
<span class="normal"><a href="#__codelineno-0-2479">2479</a></span>
<span class="normal"><a href="#__codelineno-0-2480">2480</a></span>
<span class="normal"><a href="#__codelineno-0-2481">2481</a></span>
<span class="normal"><a href="#__codelineno-0-2482">2482</a></span>
<span class="normal"><a href="#__codelineno-0-2483">2483</a></span>
<span class="normal"><a href="#__codelineno-0-2484">2484</a></span>
<span class="normal"><a href="#__codelineno-0-2485">2485</a></span>
<span class="normal"><a href="#__codelineno-0-2486">2486</a></span>
<span class="normal"><a href="#__codelineno-0-2487">2487</a></span>
<span class="normal"><a href="#__codelineno-0-2488">2488</a></span>
<span class="normal"><a href="#__codelineno-0-2489">2489</a></span>
<span class="normal"><a href="#__codelineno-0-2490">2490</a></span>
<span class="normal"><a href="#__codelineno-0-2491">2491</a></span>
<span class="normal"><a href="#__codelineno-0-2492">2492</a></span>
<span class="normal"><a href="#__codelineno-0-2493">2493</a></span>
<span class="normal"><a href="#__codelineno-0-2494">2494</a></span>
<span class="normal"><a href="#__codelineno-0-2495">2495</a></span>
<span class="normal"><a href="#__codelineno-0-2496">2496</a></span>
<span class="normal"><a href="#__codelineno-0-2497">2497</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2469"><a id="__codelineno-0-2469" name="__codelineno-0-2469"></a>    <span class="k">def</span> <span class="nf">idhs_ages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">PPR</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="__span-0-2470"><a id="__codelineno-0-2470" name="__codelineno-0-2470"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-0-2471"><a id="__codelineno-0-2471" name="__codelineno-0-2471"></a><span class="sd">        Returns ages of IDHS clients in the desired grouping</span>
</span><span id="__span-0-2472"><a id="__codelineno-0-2472" name="__codelineno-0-2472"></a>
</span><span id="__span-0-2473"><a id="__codelineno-0-2473" name="__codelineno-0-2473"></a><span class="sd">        Parameters:</span>
</span><span id="__span-0-2474"><a id="__codelineno-0-2474" name="__codelineno-0-2474"></a><span class="sd">            PPR: if True, groups according to PPR age breakdown. Defaults to False</span>
</span><span id="__span-0-2475"><a id="__codelineno-0-2475" name="__codelineno-0-2475"></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="__span-0-2476"><a id="__codelineno-0-2476" name="__codelineno-0-2476"></a>        <span class="k">if</span> <span class="n">PPR</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="__span-0-2477"><a id="__codelineno-0-2477" name="__codelineno-0-2477"></a>            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;select </span>
</span><span id="__span-0-2478"><a id="__codelineno-0-2478" name="__codelineno-0-2478"></a><span class="s1">        new_client,</span>
</span><span id="__span-0-2479"><a id="__codelineno-0-2479" name="__codelineno-0-2479"></a><span class="s1">        count(distinct case when TIMESTAMPDIFF(YEAR, birth_date, active_date) BETWEEN 0 AND 17 then participant_id else null end) as &quot;Under 18&quot;,</span>
</span><span id="__span-0-2480"><a id="__codelineno-0-2480" name="__codelineno-0-2480"></a><span class="s1">        count(distinct case when TIMESTAMPDIFF(YEAR, birth_date, active_date) BETWEEN 18 AND 25 then participant_id else null end) as &quot;18 to 24&quot;</span>
</span><span id="__span-0-2481"><a id="__codelineno-0-2481" name="__codelineno-0-2481"></a><span class="s1">    from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span>
</span><span id="__span-0-2482"><a id="__codelineno-0-2482" name="__codelineno-0-2482"></a><span class="s1">    join civicore.participants using(participant_id)</span>
</span><span id="__span-0-2483"><a id="__codelineno-0-2483" name="__codelineno-0-2483"></a><span class="s1">    group by new_client&#39;&#39;&#39;</span>
</span><span id="__span-0-2484"><a id="__codelineno-0-2484" name="__codelineno-0-2484"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-2485"><a id="__codelineno-0-2485" name="__codelineno-0-2485"></a>            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;select </span>
</span><span id="__span-0-2486"><a id="__codelineno-0-2486" name="__codelineno-0-2486"></a><span class="s1">        new_client,</span>
</span><span id="__span-0-2487"><a id="__codelineno-0-2487" name="__codelineno-0-2487"></a><span class="s1">        count(distinct case when TIMESTAMPDIFF(YEAR, birth_date, active_date) BETWEEN 0 AND 5 then participant_id else null end) as &quot;0 to 5&quot;,</span>
</span><span id="__span-0-2488"><a id="__codelineno-0-2488" name="__codelineno-0-2488"></a><span class="s1">        count(distinct case when TIMESTAMPDIFF(YEAR, birth_date, active_date) BETWEEN 6 AND 10 then participant_id else null end) as &quot;6 to 10&quot;,</span>
</span><span id="__span-0-2489"><a id="__codelineno-0-2489" name="__codelineno-0-2489"></a><span class="s1">        count(distinct case when TIMESTAMPDIFF(YEAR, birth_date, active_date) BETWEEN 11 AND 13 then participant_id else null end) as &quot;11 to 13&quot;,</span>
</span><span id="__span-0-2490"><a id="__codelineno-0-2490" name="__codelineno-0-2490"></a><span class="s1">        count(distinct case when TIMESTAMPDIFF(YEAR, birth_date, active_date) BETWEEN 14 AND 17 then participant_id else null end) as &quot;14 to 17&quot;,</span>
</span><span id="__span-0-2491"><a id="__codelineno-0-2491" name="__codelineno-0-2491"></a><span class="s1">        count(distinct case when TIMESTAMPDIFF(YEAR, birth_date, active_date) BETWEEN 18 AND 25 then participant_id else null end) as &quot;18 to 24&quot;</span>
</span><span id="__span-0-2492"><a id="__codelineno-0-2492" name="__codelineno-0-2492"></a><span class="s1">    from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span>
</span><span id="__span-0-2493"><a id="__codelineno-0-2493" name="__codelineno-0-2493"></a><span class="s1">    join civicore.participants using(participant_id)</span>
</span><span id="__span-0-2494"><a id="__codelineno-0-2494" name="__codelineno-0-2494"></a><span class="s1">    group by new_client</span>
</span><span id="__span-0-2495"><a id="__codelineno-0-2495" name="__codelineno-0-2495"></a><span class="s1">&#39;&#39;&#39;</span>
</span><span id="__span-0-2496"><a id="__codelineno-0-2496" name="__codelineno-0-2496"></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_run</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="__span-0-2497"><a id="__codelineno-0-2497" name="__codelineno-0-2497"></a>        <span class="k">return</span> <span class="n">df</span>
</span></code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="script.nice_sql.JAC_IDHS.idhs_class_notes" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">idhs_class_notes</span><span class="p">(</span><span class="n">new</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>returns those eligibility acronyms</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>new(Bool)</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>if True, only returns new clients. Defaults to False</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>script\nice_sql.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2516">2516</a></span>
<span class="normal"><a href="#__codelineno-0-2517">2517</a></span>
<span class="normal"><a href="#__codelineno-0-2518">2518</a></span>
<span class="normal"><a href="#__codelineno-0-2519">2519</a></span>
<span class="normal"><a href="#__codelineno-0-2520">2520</a></span>
<span class="normal"><a href="#__codelineno-0-2521">2521</a></span>
<span class="normal"><a href="#__codelineno-0-2522">2522</a></span>
<span class="normal"><a href="#__codelineno-0-2523">2523</a></span>
<span class="normal"><a href="#__codelineno-0-2524">2524</a></span>
<span class="normal"><a href="#__codelineno-0-2525">2525</a></span>
<span class="normal"><a href="#__codelineno-0-2526">2526</a></span>
<span class="normal"><a href="#__codelineno-0-2527">2527</a></span>
<span class="normal"><a href="#__codelineno-0-2528">2528</a></span>
<span class="normal"><a href="#__codelineno-0-2529">2529</a></span>
<span class="normal"><a href="#__codelineno-0-2530">2530</a></span>
<span class="normal"><a href="#__codelineno-0-2531">2531</a></span>
<span class="normal"><a href="#__codelineno-0-2532">2532</a></span>
<span class="normal"><a href="#__codelineno-0-2533">2533</a></span>
<span class="normal"><a href="#__codelineno-0-2534">2534</a></span>
<span class="normal"><a href="#__codelineno-0-2535">2535</a></span>
<span class="normal"><a href="#__codelineno-0-2536">2536</a></span>
<span class="normal"><a href="#__codelineno-0-2537">2537</a></span>
<span class="normal"><a href="#__codelineno-0-2538">2538</a></span>
<span class="normal"><a href="#__codelineno-0-2539">2539</a></span>
<span class="normal"><a href="#__codelineno-0-2540">2540</a></span>
<span class="normal"><a href="#__codelineno-0-2541">2541</a></span>
<span class="normal"><a href="#__codelineno-0-2542">2542</a></span>
<span class="normal"><a href="#__codelineno-0-2543">2543</a></span>
<span class="normal"><a href="#__codelineno-0-2544">2544</a></span>
<span class="normal"><a href="#__codelineno-0-2545">2545</a></span>
<span class="normal"><a href="#__codelineno-0-2546">2546</a></span>
<span class="normal"><a href="#__codelineno-0-2547">2547</a></span>
<span class="normal"><a href="#__codelineno-0-2548">2548</a></span>
<span class="normal"><a href="#__codelineno-0-2549">2549</a></span>
<span class="normal"><a href="#__codelineno-0-2550">2550</a></span>
<span class="normal"><a href="#__codelineno-0-2551">2551</a></span>
<span class="normal"><a href="#__codelineno-0-2552">2552</a></span>
<span class="normal"><a href="#__codelineno-0-2553">2553</a></span>
<span class="normal"><a href="#__codelineno-0-2554">2554</a></span>
<span class="normal"><a href="#__codelineno-0-2555">2555</a></span>
<span class="normal"><a href="#__codelineno-0-2556">2556</a></span>
<span class="normal"><a href="#__codelineno-0-2557">2557</a></span>
<span class="normal"><a href="#__codelineno-0-2558">2558</a></span>
<span class="normal"><a href="#__codelineno-0-2559">2559</a></span>
<span class="normal"><a href="#__codelineno-0-2560">2560</a></span>
<span class="normal"><a href="#__codelineno-0-2561">2561</a></span>
<span class="normal"><a href="#__codelineno-0-2562">2562</a></span>
<span class="normal"><a href="#__codelineno-0-2563">2563</a></span>
<span class="normal"><a href="#__codelineno-0-2564">2564</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2516"><a id="__codelineno-0-2516" name="__codelineno-0-2516"></a><span class="k">def</span> <span class="nf">idhs_class_notes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="__span-0-2517"><a id="__codelineno-0-2517" name="__codelineno-0-2517"></a><span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-0-2518"><a id="__codelineno-0-2518" name="__codelineno-0-2518"></a><span class="sd">    returns those eligibility acronyms</span>
</span><span id="__span-0-2519"><a id="__codelineno-0-2519" name="__codelineno-0-2519"></a>
</span><span id="__span-0-2520"><a id="__codelineno-0-2520" name="__codelineno-0-2520"></a><span class="sd">    Parameters:</span>
</span><span id="__span-0-2521"><a id="__codelineno-0-2521" name="__codelineno-0-2521"></a><span class="sd">        new(Bool): if True, only returns new clients. Defaults to False</span>
</span><span id="__span-0-2522"><a id="__codelineno-0-2522" name="__codelineno-0-2522"></a><span class="sd">    &#39;&#39;&#39;</span>
</span><span id="__span-0-2523"><a id="__codelineno-0-2523" name="__codelineno-0-2523"></a>    <span class="k">if</span> <span class="n">new</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
</span><span id="__span-0-2524"><a id="__codelineno-0-2524" name="__codelineno-0-2524"></a>        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;with class as (select * from (select distinct participant_id</span>
</span><span id="__span-0-2525"><a id="__codelineno-0-2525" name="__codelineno-0-2525"></a><span class="s1">from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span><span class="s1">) j</span>
</span><span id="__span-0-2526"><a id="__codelineno-0-2526" name="__codelineno-0-2526"></a><span class="s1">join civicore.classes using(participant_id)</span>
</span><span id="__span-0-2527"><a id="__codelineno-0-2527" name="__codelineno-0-2527"></a><span class="s1">where class regexp &#39;2023 IDHS VP.*&#39; and (unenroll_date is null or unenroll_date between </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t1</span><span class="si">}</span><span class="s1"> and </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t2</span><span class="si">}</span><span class="s1">))</span>
</span><span id="__span-0-2528"><a id="__codelineno-0-2528" name="__codelineno-0-2528"></a>
</span><span id="__span-0-2529"><a id="__codelineno-0-2529" name="__codelineno-0-2529"></a><span class="s1">SELECT acronym, COUNT(*) AS count</span>
</span><span id="__span-0-2530"><a id="__codelineno-0-2530" name="__codelineno-0-2530"></a><span class="s1">FROM (</span>
</span><span id="__span-0-2531"><a id="__codelineno-0-2531" name="__codelineno-0-2531"></a><span class="s1">    SELECT TRIM(REPLACE(REGEXP_SUBSTR(CAST(summary_note AS CHAR), &#39;[[:alnum:]]+&#39;, 1, n.n), &#39; &#39;, &#39;&#39;)) AS acronym</span>
</span><span id="__span-0-2532"><a id="__codelineno-0-2532" name="__codelineno-0-2532"></a><span class="s1">    FROM class</span>
</span><span id="__span-0-2533"><a id="__codelineno-0-2533" name="__codelineno-0-2533"></a><span class="s1">    JOIN (</span>
</span><span id="__span-0-2534"><a id="__codelineno-0-2534" name="__codelineno-0-2534"></a><span class="s1">        SELECT a.N + b.N * 10 + 1 AS n</span>
</span><span id="__span-0-2535"><a id="__codelineno-0-2535" name="__codelineno-0-2535"></a><span class="s1">        FROM</span>
</span><span id="__span-0-2536"><a id="__codelineno-0-2536" name="__codelineno-0-2536"></a><span class="s1">            (SELECT 0 AS N UNION ALL SELECT 1 UNION ALL SELECT 2 UNION ALL SELECT 3) a,</span>
</span><span id="__span-0-2537"><a id="__codelineno-0-2537" name="__codelineno-0-2537"></a><span class="s1">            (SELECT 0 AS N UNION ALL SELECT 1 UNION ALL SELECT 2 UNION ALL SELECT 3) b</span>
</span><span id="__span-0-2538"><a id="__codelineno-0-2538" name="__codelineno-0-2538"></a><span class="s1">        ORDER BY n</span>
</span><span id="__span-0-2539"><a id="__codelineno-0-2539" name="__codelineno-0-2539"></a><span class="s1">    ) n ON CHAR_LENGTH(CAST(summary_note AS CHAR)) - CHAR_LENGTH(REGEXP_REPLACE(CAST(summary_note AS CHAR), &#39;[[:alnum:]]+&#39;, &#39;&#39;)) &gt;= n.n</span>
</span><span id="__span-0-2540"><a id="__codelineno-0-2540" name="__codelineno-0-2540"></a><span class="s1">) AS Acronyms</span>
</span><span id="__span-0-2541"><a id="__codelineno-0-2541" name="__codelineno-0-2541"></a><span class="s1">WHERE acronym != &#39;&#39;</span>
</span><span id="__span-0-2542"><a id="__codelineno-0-2542" name="__codelineno-0-2542"></a><span class="s1">GROUP BY acronym&#39;&#39;&#39;</span>
</span><span id="__span-0-2543"><a id="__codelineno-0-2543" name="__codelineno-0-2543"></a>    <span class="k">if</span> <span class="n">new</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__span-0-2544"><a id="__codelineno-0-2544" name="__codelineno-0-2544"></a>        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;with class as (select * from (select distinct participant_id</span>
</span><span id="__span-0-2545"><a id="__codelineno-0-2545" name="__codelineno-0-2545"></a><span class="s1">from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span><span class="s1"> where start_date &gt; </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t1</span><span class="si">}</span><span class="s1">) j</span>
</span><span id="__span-0-2546"><a id="__codelineno-0-2546" name="__codelineno-0-2546"></a><span class="s1">join civicore.classes using(participant_id)</span>
</span><span id="__span-0-2547"><a id="__codelineno-0-2547" name="__codelineno-0-2547"></a><span class="s1">where class regexp &#39;2023 IDHS VP.*&#39; and (unenroll_date is null or unenroll_date between </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t1</span><span class="si">}</span><span class="s1"> and </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t2</span><span class="si">}</span><span class="s1">))</span>
</span><span id="__span-0-2548"><a id="__codelineno-0-2548" name="__codelineno-0-2548"></a>
</span><span id="__span-0-2549"><a id="__codelineno-0-2549" name="__codelineno-0-2549"></a><span class="s1">SELECT acronym, COUNT(*) AS count</span>
</span><span id="__span-0-2550"><a id="__codelineno-0-2550" name="__codelineno-0-2550"></a><span class="s1">FROM (</span>
</span><span id="__span-0-2551"><a id="__codelineno-0-2551" name="__codelineno-0-2551"></a><span class="s1">    SELECT TRIM(REPLACE(REGEXP_SUBSTR(CAST(summary_note AS CHAR), &#39;[[:alnum:]]+&#39;, 1, n.n), &#39; &#39;, &#39;&#39;)) AS acronym</span>
</span><span id="__span-0-2552"><a id="__codelineno-0-2552" name="__codelineno-0-2552"></a><span class="s1">    FROM class</span>
</span><span id="__span-0-2553"><a id="__codelineno-0-2553" name="__codelineno-0-2553"></a><span class="s1">    JOIN (</span>
</span><span id="__span-0-2554"><a id="__codelineno-0-2554" name="__codelineno-0-2554"></a><span class="s1">        SELECT a.N + b.N * 10 + 1 AS n</span>
</span><span id="__span-0-2555"><a id="__codelineno-0-2555" name="__codelineno-0-2555"></a><span class="s1">        FROM</span>
</span><span id="__span-0-2556"><a id="__codelineno-0-2556" name="__codelineno-0-2556"></a><span class="s1">            (SELECT 0 AS N UNION ALL SELECT 1 UNION ALL SELECT 2 UNION ALL SELECT 3) a,</span>
</span><span id="__span-0-2557"><a id="__codelineno-0-2557" name="__codelineno-0-2557"></a><span class="s1">            (SELECT 0 AS N UNION ALL SELECT 1 UNION ALL SELECT 2 UNION ALL SELECT 3) b</span>
</span><span id="__span-0-2558"><a id="__codelineno-0-2558" name="__codelineno-0-2558"></a><span class="s1">        ORDER BY n</span>
</span><span id="__span-0-2559"><a id="__codelineno-0-2559" name="__codelineno-0-2559"></a><span class="s1">    ) n ON CHAR_LENGTH(CAST(summary_note AS CHAR)) - CHAR_LENGTH(REGEXP_REPLACE(CAST(summary_note AS CHAR), &#39;[[:alnum:]]+&#39;, &#39;&#39;)) &gt;= n.n</span>
</span><span id="__span-0-2560"><a id="__codelineno-0-2560" name="__codelineno-0-2560"></a><span class="s1">) AS Acronyms</span>
</span><span id="__span-0-2561"><a id="__codelineno-0-2561" name="__codelineno-0-2561"></a><span class="s1">WHERE acronym != &#39;&#39;</span>
</span><span id="__span-0-2562"><a id="__codelineno-0-2562" name="__codelineno-0-2562"></a><span class="s1">GROUP BY acronym&#39;&#39;&#39;</span>
</span><span id="__span-0-2563"><a id="__codelineno-0-2563" name="__codelineno-0-2563"></a>    <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_run</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="__span-0-2564"><a id="__codelineno-0-2564" name="__codelineno-0-2564"></a>    <span class="k">return</span> <span class="n">df</span>
</span></code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="script.nice_sql.JAC_IDHS.idhs_incidents_detailed" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">idhs_incidents_detailed</span><span class="p">(</span><span class="n">CPIC</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>returns incident analysis. need to update code to specify neighborhoods.</p>

          <details class="quote">
            <summary>Source code in <code>script\nice_sql.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2633">2633</a></span>
<span class="normal"><a href="#__codelineno-0-2634">2634</a></span>
<span class="normal"><a href="#__codelineno-0-2635">2635</a></span>
<span class="normal"><a href="#__codelineno-0-2636">2636</a></span>
<span class="normal"><a href="#__codelineno-0-2637">2637</a></span>
<span class="normal"><a href="#__codelineno-0-2638">2638</a></span>
<span class="normal"><a href="#__codelineno-0-2639">2639</a></span>
<span class="normal"><a href="#__codelineno-0-2640">2640</a></span>
<span class="normal"><a href="#__codelineno-0-2641">2641</a></span>
<span class="normal"><a href="#__codelineno-0-2642">2642</a></span>
<span class="normal"><a href="#__codelineno-0-2643">2643</a></span>
<span class="normal"><a href="#__codelineno-0-2644">2644</a></span>
<span class="normal"><a href="#__codelineno-0-2645">2645</a></span>
<span class="normal"><a href="#__codelineno-0-2646">2646</a></span>
<span class="normal"><a href="#__codelineno-0-2647">2647</a></span>
<span class="normal"><a href="#__codelineno-0-2648">2648</a></span>
<span class="normal"><a href="#__codelineno-0-2649">2649</a></span>
<span class="normal"><a href="#__codelineno-0-2650">2650</a></span>
<span class="normal"><a href="#__codelineno-0-2651">2651</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2633"><a id="__codelineno-0-2633" name="__codelineno-0-2633"></a>    <span class="k">def</span> <span class="nf">idhs_incidents_detailed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">CPIC</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="__span-0-2634"><a id="__codelineno-0-2634" name="__codelineno-0-2634"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-0-2635"><a id="__codelineno-0-2635" name="__codelineno-0-2635"></a><span class="sd">        returns incident analysis. need to update code to specify neighborhoods.</span>
</span><span id="__span-0-2636"><a id="__codelineno-0-2636" name="__codelineno-0-2636"></a>
</span><span id="__span-0-2637"><a id="__codelineno-0-2637" name="__codelineno-0-2637"></a>
</span><span id="__span-0-2638"><a id="__codelineno-0-2638" name="__codelineno-0-2638"></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="__span-0-2639"><a id="__codelineno-0-2639" name="__codelineno-0-2639"></a>        <span class="k">if</span> <span class="n">CPIC</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__span-0-2640"><a id="__codelineno-0-2640" name="__codelineno-0-2640"></a>            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;SELECT type_incident,</span>
</span><span id="__span-0-2641"><a id="__codelineno-0-2641" name="__codelineno-0-2641"></a><span class="s1">count(case when num_deceased &gt; 0 then incident_id else null end) as fatal,</span>
</span><span id="__span-0-2642"><a id="__codelineno-0-2642" name="__codelineno-0-2642"></a><span class="s1">count(case when num_deceased = 0 then incident_id else null end) as non_fatal</span>
</span><span id="__span-0-2643"><a id="__codelineno-0-2643" name="__codelineno-0-2643"></a><span class="s1">FROM civicore.critical_incidents</span>
</span><span id="__span-0-2644"><a id="__codelineno-0-2644" name="__codelineno-0-2644"></a><span class="s1">where how_hear regexp &#39;.*cpic.*&#39; and date_incident between </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t1</span><span class="si">}</span><span class="s1"> and </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t2</span><span class="si">}</span>
</span><span id="__span-0-2645"><a id="__codelineno-0-2645" name="__codelineno-0-2645"></a><span class="s1">group by type_incident&#39;&#39;&#39;</span>
</span><span id="__span-0-2646"><a id="__codelineno-0-2646" name="__codelineno-0-2646"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-2647"><a id="__codelineno-0-2647" name="__codelineno-0-2647"></a>            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;select how_hear, count(incident_id) from civicore.critical_incidents</span>
</span><span id="__span-0-2648"><a id="__codelineno-0-2648" name="__codelineno-0-2648"></a><span class="s1">where date_incident between </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t1</span><span class="si">}</span><span class="s1"> and </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t2</span><span class="si">}</span><span class="s1"> and how_hear not regexp &#39;.*cpic.*&#39;</span>
</span><span id="__span-0-2649"><a id="__codelineno-0-2649" name="__codelineno-0-2649"></a><span class="s1">group by how_hear&#39;&#39;&#39;</span>
</span><span id="__span-0-2650"><a id="__codelineno-0-2650" name="__codelineno-0-2650"></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_run</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="__span-0-2651"><a id="__codelineno-0-2651" name="__codelineno-0-2651"></a>        <span class="k">return</span> <span class="n">df</span>
</span></code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="script.nice_sql.JAC_IDHS.idhs_language" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">idhs_language</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>counts participant primary languages</p>

          <details class="quote">
            <summary>Source code in <code>script\nice_sql.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2580">2580</a></span>
<span class="normal"><a href="#__codelineno-0-2581">2581</a></span>
<span class="normal"><a href="#__codelineno-0-2582">2582</a></span>
<span class="normal"><a href="#__codelineno-0-2583">2583</a></span>
<span class="normal"><a href="#__codelineno-0-2584">2584</a></span>
<span class="normal"><a href="#__codelineno-0-2585">2585</a></span>
<span class="normal"><a href="#__codelineno-0-2586">2586</a></span>
<span class="normal"><a href="#__codelineno-0-2587">2587</a></span>
<span class="normal"><a href="#__codelineno-0-2588">2588</a></span>
<span class="normal"><a href="#__codelineno-0-2589">2589</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2580"><a id="__codelineno-0-2580" name="__codelineno-0-2580"></a>    <span class="k">def</span> <span class="nf">idhs_language</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-2581"><a id="__codelineno-0-2581" name="__codelineno-0-2581"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-0-2582"><a id="__codelineno-0-2582" name="__codelineno-0-2582"></a><span class="sd">        counts participant primary languages</span>
</span><span id="__span-0-2583"><a id="__codelineno-0-2583" name="__codelineno-0-2583"></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="__span-0-2584"><a id="__codelineno-0-2584" name="__codelineno-0-2584"></a>        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;select new_client, language_primary, count(distinct participant_id)</span>
</span><span id="__span-0-2585"><a id="__codelineno-0-2585" name="__codelineno-0-2585"></a><span class="s1">from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span>
</span><span id="__span-0-2586"><a id="__codelineno-0-2586" name="__codelineno-0-2586"></a><span class="s1">join civicore.participants using(participant_id)</span>
</span><span id="__span-0-2587"><a id="__codelineno-0-2587" name="__codelineno-0-2587"></a><span class="s1">group by new_client, language_primary&#39;&#39;&#39;</span>
</span><span id="__span-0-2588"><a id="__codelineno-0-2588" name="__codelineno-0-2588"></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_run</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="__span-0-2589"><a id="__codelineno-0-2589" name="__codelineno-0-2589"></a>        <span class="k">return</span> <span class="n">df</span>
</span></code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="script.nice_sql.JAC_IDHS.idhs_linkages" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">idhs_linkages</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>returns goal areas for clients receiving a grant's case management</p>

          <details class="quote">
            <summary>Source code in <code>script\nice_sql.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2604">2604</a></span>
<span class="normal"><a href="#__codelineno-0-2605">2605</a></span>
<span class="normal"><a href="#__codelineno-0-2606">2606</a></span>
<span class="normal"><a href="#__codelineno-0-2607">2607</a></span>
<span class="normal"><a href="#__codelineno-0-2608">2608</a></span>
<span class="normal"><a href="#__codelineno-0-2609">2609</a></span>
<span class="normal"><a href="#__codelineno-0-2610">2610</a></span>
<span class="normal"><a href="#__codelineno-0-2611">2611</a></span>
<span class="normal"><a href="#__codelineno-0-2612">2612</a></span>
<span class="normal"><a href="#__codelineno-0-2613">2613</a></span>
<span class="normal"><a href="#__codelineno-0-2614">2614</a></span>
<span class="normal"><a href="#__codelineno-0-2615">2615</a></span>
<span class="normal"><a href="#__codelineno-0-2616">2616</a></span>
<span class="normal"><a href="#__codelineno-0-2617">2617</a></span>
<span class="normal"><a href="#__codelineno-0-2618">2618</a></span>
<span class="normal"><a href="#__codelineno-0-2619">2619</a></span>
<span class="normal"><a href="#__codelineno-0-2620">2620</a></span>
<span class="normal"><a href="#__codelineno-0-2621">2621</a></span>
<span class="normal"><a href="#__codelineno-0-2622">2622</a></span>
<span class="normal"><a href="#__codelineno-0-2623">2623</a></span>
<span class="normal"><a href="#__codelineno-0-2624">2624</a></span>
<span class="normal"><a href="#__codelineno-0-2625">2625</a></span>
<span class="normal"><a href="#__codelineno-0-2626">2626</a></span>
<span class="normal"><a href="#__codelineno-0-2627">2627</a></span>
<span class="normal"><a href="#__codelineno-0-2628">2628</a></span>
<span class="normal"><a href="#__codelineno-0-2629">2629</a></span>
<span class="normal"><a href="#__codelineno-0-2630">2630</a></span>
<span class="normal"><a href="#__codelineno-0-2631">2631</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2604"><a id="__codelineno-0-2604" name="__codelineno-0-2604"></a>    <span class="k">def</span> <span class="nf">idhs_linkages</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-2605"><a id="__codelineno-0-2605" name="__codelineno-0-2605"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-0-2606"><a id="__codelineno-0-2606" name="__codelineno-0-2606"></a><span class="sd">        returns goal areas for clients receiving a grant&#39;s case management</span>
</span><span id="__span-0-2607"><a id="__codelineno-0-2607" name="__codelineno-0-2607"></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="__span-0-2608"><a id="__codelineno-0-2608" name="__codelineno-0-2608"></a>        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;with separated_goals as (SELECT participant_id, first_name, last_name, linkage_id, linkage_type, linkage_org, linked_date, hub_initiated, new_client, SUBSTRING_INDEX(SUBSTRING_INDEX(goal_area, &#39;, &#39;, n), &#39;, &#39;, -1) AS separated_area</span>
</span><span id="__span-0-2609"><a id="__codelineno-0-2609" name="__codelineno-0-2609"></a><span class="s1">FROM (select participant_id, first_name, last_name, linkage_type, linkage_org, linkage_id, goal_area, linked_date, hub_initiated, new_client from (select * from </span>
</span><span id="__span-0-2610"><a id="__codelineno-0-2610" name="__codelineno-0-2610"></a><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span>
</span><span id="__span-0-2611"><a id="__codelineno-0-2611" name="__codelineno-0-2611"></a><span class="s1">where program_type regexp &#39;.*</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">program</span><span class="si">}</span><span class="s1"> - case.*&#39;) p</span>
</span><span id="__span-0-2612"><a id="__codelineno-0-2612" name="__codelineno-0-2612"></a><span class="s1">join civicore.linkages l using(participant_id) where hub_initiated = &quot;Yes&quot;) s</span>
</span><span id="__span-0-2613"><a id="__codelineno-0-2613" name="__codelineno-0-2613"></a><span class="s1">JOIN (</span>
</span><span id="__span-0-2614"><a id="__codelineno-0-2614" name="__codelineno-0-2614"></a><span class="s1">    SELECT 1 AS n UNION ALL</span>
</span><span id="__span-0-2615"><a id="__codelineno-0-2615" name="__codelineno-0-2615"></a><span class="s1">    SELECT 2 UNION ALL</span>
</span><span id="__span-0-2616"><a id="__codelineno-0-2616" name="__codelineno-0-2616"></a><span class="s1">    SELECT 3 UNION ALL</span>
</span><span id="__span-0-2617"><a id="__codelineno-0-2617" name="__codelineno-0-2617"></a><span class="s1">    SELECT 4 UNION ALL</span>
</span><span id="__span-0-2618"><a id="__codelineno-0-2618" name="__codelineno-0-2618"></a><span class="s1">    SELECT 5 UNION ALL</span>
</span><span id="__span-0-2619"><a id="__codelineno-0-2619" name="__codelineno-0-2619"></a><span class="s1">    SELECT 6 UNION ALL</span>
</span><span id="__span-0-2620"><a id="__codelineno-0-2620" name="__codelineno-0-2620"></a><span class="s1">    SELECT 7 UNION ALL</span>
</span><span id="__span-0-2621"><a id="__codelineno-0-2621" name="__codelineno-0-2621"></a><span class="s1">    SELECT 8 UNION ALL</span>
</span><span id="__span-0-2622"><a id="__codelineno-0-2622" name="__codelineno-0-2622"></a><span class="s1">    SELECT 9</span>
</span><span id="__span-0-2623"><a id="__codelineno-0-2623" name="__codelineno-0-2623"></a><span class="s1">) AS numbers</span>
</span><span id="__span-0-2624"><a id="__codelineno-0-2624" name="__codelineno-0-2624"></a><span class="s1">ON CHAR_LENGTH(goal_area) - CHAR_LENGTH(REPLACE(goal_area, &#39;,&#39;, &#39;&#39;)) &gt;= n - 1)</span>
</span><span id="__span-0-2625"><a id="__codelineno-0-2625" name="__codelineno-0-2625"></a>
</span><span id="__span-0-2626"><a id="__codelineno-0-2626" name="__codelineno-0-2626"></a><span class="s1">select separated_area, count(distinct case when new_client = &quot;new&quot; then linkage_id end) as new_links, count(distinct case when new_client = &quot;continuing&quot; then linkage_id end) as cont_links</span>
</span><span id="__span-0-2627"><a id="__codelineno-0-2627" name="__codelineno-0-2627"></a><span class="s1">from separated_goals</span>
</span><span id="__span-0-2628"><a id="__codelineno-0-2628" name="__codelineno-0-2628"></a><span class="s1">where linked_date between </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t1</span><span class="si">}</span><span class="s1"> and </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t2</span><span class="si">}</span>
</span><span id="__span-0-2629"><a id="__codelineno-0-2629" name="__codelineno-0-2629"></a><span class="s1">group by separated_area&#39;&#39;&#39;</span>
</span><span id="__span-0-2630"><a id="__codelineno-0-2630" name="__codelineno-0-2630"></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_run</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="__span-0-2631"><a id="__codelineno-0-2631" name="__codelineno-0-2631"></a>        <span class="k">return</span> <span class="n">df</span>
</span></code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="script.nice_sql.JAC_IDHS.idhs_race_gender" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">idhs_race_gender</span><span class="p">(</span><span class="n">race_gender</span><span class="o">=</span><span class="s1">&#39;race&#39;</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns count of race/gender, distinguishing between new/continuing clients</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>race_gender</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>'race' returns client races, 'gender' returns client genders. Defaults to 'race'</p>
            </div>
          </td>
          <td>
                <code>&#39;race&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>script\nice_sql.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2566">2566</a></span>
<span class="normal"><a href="#__codelineno-0-2567">2567</a></span>
<span class="normal"><a href="#__codelineno-0-2568">2568</a></span>
<span class="normal"><a href="#__codelineno-0-2569">2569</a></span>
<span class="normal"><a href="#__codelineno-0-2570">2570</a></span>
<span class="normal"><a href="#__codelineno-0-2571">2571</a></span>
<span class="normal"><a href="#__codelineno-0-2572">2572</a></span>
<span class="normal"><a href="#__codelineno-0-2573">2573</a></span>
<span class="normal"><a href="#__codelineno-0-2574">2574</a></span>
<span class="normal"><a href="#__codelineno-0-2575">2575</a></span>
<span class="normal"><a href="#__codelineno-0-2576">2576</a></span>
<span class="normal"><a href="#__codelineno-0-2577">2577</a></span>
<span class="normal"><a href="#__codelineno-0-2578">2578</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2566"><a id="__codelineno-0-2566" name="__codelineno-0-2566"></a>    <span class="k">def</span> <span class="nf">idhs_race_gender</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">race_gender</span> <span class="o">=</span> <span class="s1">&#39;race&#39;</span><span class="p">):</span>
</span><span id="__span-0-2567"><a id="__codelineno-0-2567" name="__codelineno-0-2567"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-0-2568"><a id="__codelineno-0-2568" name="__codelineno-0-2568"></a><span class="sd">        Returns count of race/gender, distinguishing between new/continuing clients</span>
</span><span id="__span-0-2569"><a id="__codelineno-0-2569" name="__codelineno-0-2569"></a>
</span><span id="__span-0-2570"><a id="__codelineno-0-2570" name="__codelineno-0-2570"></a><span class="sd">        Parameters:</span>
</span><span id="__span-0-2571"><a id="__codelineno-0-2571" name="__codelineno-0-2571"></a><span class="sd">            race_gender: &#39;race&#39; returns client races, &#39;gender&#39; returns client genders. Defaults to &#39;race&#39;</span>
</span><span id="__span-0-2572"><a id="__codelineno-0-2572" name="__codelineno-0-2572"></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="__span-0-2573"><a id="__codelineno-0-2573" name="__codelineno-0-2573"></a>        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;select new_client, </span><span class="si">{</span><span class="n">race_gender</span><span class="si">}</span><span class="s1">, count(</span><span class="si">{</span><span class="n">race_gender</span><span class="si">}</span><span class="s1">)</span>
</span><span id="__span-0-2574"><a id="__codelineno-0-2574" name="__codelineno-0-2574"></a><span class="s1">from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span>
</span><span id="__span-0-2575"><a id="__codelineno-0-2575" name="__codelineno-0-2575"></a><span class="s1">join civicore.participants using(participant_id)</span>
</span><span id="__span-0-2576"><a id="__codelineno-0-2576" name="__codelineno-0-2576"></a><span class="s1">group by new_client, </span><span class="si">{</span><span class="n">race_gender</span><span class="si">}</span><span class="s1">&#39;&#39;&#39;</span>
</span><span id="__span-0-2577"><a id="__codelineno-0-2577" name="__codelineno-0-2577"></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_run</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="__span-0-2578"><a id="__codelineno-0-2578" name="__codelineno-0-2578"></a>        <span class="k">return</span> <span class="n">df</span>
</span></code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="script.nice_sql.JAC_IDHS.idhs_service_tally" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">idhs_service_tally</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>counts clients receiving services from the chosen grant</p>

          <details class="quote">
            <summary>Source code in <code>script\nice_sql.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2591">2591</a></span>
<span class="normal"><a href="#__codelineno-0-2592">2592</a></span>
<span class="normal"><a href="#__codelineno-0-2593">2593</a></span>
<span class="normal"><a href="#__codelineno-0-2594">2594</a></span>
<span class="normal"><a href="#__codelineno-0-2595">2595</a></span>
<span class="normal"><a href="#__codelineno-0-2596">2596</a></span>
<span class="normal"><a href="#__codelineno-0-2597">2597</a></span>
<span class="normal"><a href="#__codelineno-0-2598">2598</a></span>
<span class="normal"><a href="#__codelineno-0-2599">2599</a></span>
<span class="normal"><a href="#__codelineno-0-2600">2600</a></span>
<span class="normal"><a href="#__codelineno-0-2601">2601</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2591"><a id="__codelineno-0-2591" name="__codelineno-0-2591"></a>    <span class="k">def</span> <span class="nf">idhs_service_tally</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-2592"><a id="__codelineno-0-2592" name="__codelineno-0-2592"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-0-2593"><a id="__codelineno-0-2593" name="__codelineno-0-2593"></a><span class="sd">        counts clients receiving services from the chosen grant</span>
</span><span id="__span-0-2594"><a id="__codelineno-0-2594" name="__codelineno-0-2594"></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="__span-0-2595"><a id="__codelineno-0-2595" name="__codelineno-0-2595"></a>        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;select new_client, count(distinct case when program_type regexp &quot;.*</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">program</span><span class="si">}</span><span class="s1"> - Outreach.*&quot; then participant_id else null end) as outreach, </span>
</span><span id="__span-0-2596"><a id="__codelineno-0-2596" name="__codelineno-0-2596"></a><span class="s1">count(distinct case when program_type regexp &quot;.*</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">program</span><span class="si">}</span><span class="s1"> - Case.*&quot; then participant_id else null end) as CM,</span>
</span><span id="__span-0-2597"><a id="__codelineno-0-2597" name="__codelineno-0-2597"></a><span class="s1">count(distinct case when program_type regexp &quot;.*</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">program</span><span class="si">}</span><span class="s1"> - Legal.*&quot; then participant_id else null end) as legal</span>
</span><span id="__span-0-2598"><a id="__codelineno-0-2598" name="__codelineno-0-2598"></a><span class="s1">from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span>
</span><span id="__span-0-2599"><a id="__codelineno-0-2599" name="__codelineno-0-2599"></a><span class="s1">group by new_client&#39;&#39;&#39;</span>
</span><span id="__span-0-2600"><a id="__codelineno-0-2600" name="__codelineno-0-2600"></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_run</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="__span-0-2601"><a id="__codelineno-0-2601" name="__codelineno-0-2601"></a>        <span class="k">return</span> <span class="n">df</span>
</span></code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="script.nice_sql.JAC_IDHS.idhs_tally" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">idhs_tally</span><span class="p">(</span><span class="n">closed</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>counts number of people on grant</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>closed(Bool)</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>if True, only returns closed clients. Defaults to False</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>script\nice_sql.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2499">2499</a></span>
<span class="normal"><a href="#__codelineno-0-2500">2500</a></span>
<span class="normal"><a href="#__codelineno-0-2501">2501</a></span>
<span class="normal"><a href="#__codelineno-0-2502">2502</a></span>
<span class="normal"><a href="#__codelineno-0-2503">2503</a></span>
<span class="normal"><a href="#__codelineno-0-2504">2504</a></span>
<span class="normal"><a href="#__codelineno-0-2505">2505</a></span>
<span class="normal"><a href="#__codelineno-0-2506">2506</a></span>
<span class="normal"><a href="#__codelineno-0-2507">2507</a></span>
<span class="normal"><a href="#__codelineno-0-2508">2508</a></span>
<span class="normal"><a href="#__codelineno-0-2509">2509</a></span>
<span class="normal"><a href="#__codelineno-0-2510">2510</a></span>
<span class="normal"><a href="#__codelineno-0-2511">2511</a></span>
<span class="normal"><a href="#__codelineno-0-2512">2512</a></span>
<span class="normal"><a href="#__codelineno-0-2513">2513</a></span>
<span class="normal"><a href="#__codelineno-0-2514">2514</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2499"><a id="__codelineno-0-2499" name="__codelineno-0-2499"></a>    <span class="k">def</span> <span class="nf">idhs_tally</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">closed</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
</span><span id="__span-0-2500"><a id="__codelineno-0-2500" name="__codelineno-0-2500"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-0-2501"><a id="__codelineno-0-2501" name="__codelineno-0-2501"></a><span class="sd">        counts number of people on grant</span>
</span><span id="__span-0-2502"><a id="__codelineno-0-2502" name="__codelineno-0-2502"></a>
</span><span id="__span-0-2503"><a id="__codelineno-0-2503" name="__codelineno-0-2503"></a><span class="sd">        Parameters:</span>
</span><span id="__span-0-2504"><a id="__codelineno-0-2504" name="__codelineno-0-2504"></a><span class="sd">            closed(Bool): if True, only returns closed clients. Defaults to False</span>
</span><span id="__span-0-2505"><a id="__codelineno-0-2505" name="__codelineno-0-2505"></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="__span-0-2506"><a id="__codelineno-0-2506" name="__codelineno-0-2506"></a>        <span class="k">if</span> <span class="n">closed</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span> 
</span><span id="__span-0-2507"><a id="__codelineno-0-2507" name="__codelineno-0-2507"></a>            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;select new_client, count(distinct participant_id)</span>
</span><span id="__span-0-2508"><a id="__codelineno-0-2508" name="__codelineno-0-2508"></a><span class="s1">    from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span>
</span><span id="__span-0-2509"><a id="__codelineno-0-2509" name="__codelineno-0-2509"></a><span class="s1">    group by new_client&#39;&#39;&#39;</span>
</span><span id="__span-0-2510"><a id="__codelineno-0-2510" name="__codelineno-0-2510"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-0-2511"><a id="__codelineno-0-2511" name="__codelineno-0-2511"></a>            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;select count(distinct participant_id) from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span>
</span><span id="__span-0-2512"><a id="__codelineno-0-2512" name="__codelineno-0-2512"></a><span class="s1">where end_date between </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t1</span><span class="si">}</span><span class="s1"> and </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t2</span><span class="si">}</span><span class="s1"> or (closed_date between </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t1</span><span class="si">}</span><span class="s1"> and </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t2</span><span class="si">}</span><span class="s1">)&#39;&#39;&#39;</span>
</span><span id="__span-0-2513"><a id="__codelineno-0-2513" name="__codelineno-0-2513"></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_run</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="__span-0-2514"><a id="__codelineno-0-2514" name="__codelineno-0-2514"></a>        <span class="k">return</span> <span class="n">df</span>
</span></code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="script.nice_sql.JAC_IDHS.jac_cm_hours" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">jac_cm_hours</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>gets average case management hours for JAC clients</p>

          <details class="quote">
            <summary>Source code in <code>script\nice_sql.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2653">2653</a></span>
<span class="normal"><a href="#__codelineno-0-2654">2654</a></span>
<span class="normal"><a href="#__codelineno-0-2655">2655</a></span>
<span class="normal"><a href="#__codelineno-0-2656">2656</a></span>
<span class="normal"><a href="#__codelineno-0-2657">2657</a></span>
<span class="normal"><a href="#__codelineno-0-2658">2658</a></span>
<span class="normal"><a href="#__codelineno-0-2659">2659</a></span>
<span class="normal"><a href="#__codelineno-0-2660">2660</a></span>
<span class="normal"><a href="#__codelineno-0-2661">2661</a></span>
<span class="normal"><a href="#__codelineno-0-2662">2662</a></span>
<span class="normal"><a href="#__codelineno-0-2663">2663</a></span>
<span class="normal"><a href="#__codelineno-0-2664">2664</a></span>
<span class="normal"><a href="#__codelineno-0-2665">2665</a></span>
<span class="normal"><a href="#__codelineno-0-2666">2666</a></span>
<span class="normal"><a href="#__codelineno-0-2667">2667</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2653"><a id="__codelineno-0-2653" name="__codelineno-0-2653"></a>    <span class="k">def</span> <span class="nf">jac_cm_hours</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-2654"><a id="__codelineno-0-2654" name="__codelineno-0-2654"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-0-2655"><a id="__codelineno-0-2655" name="__codelineno-0-2655"></a><span class="sd">        gets average case management hours for JAC clients</span>
</span><span id="__span-0-2656"><a id="__codelineno-0-2656" name="__codelineno-0-2656"></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="__span-0-2657"><a id="__codelineno-0-2657" name="__codelineno-0-2657"></a>
</span><span id="__span-0-2658"><a id="__codelineno-0-2658" name="__codelineno-0-2658"></a>        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;select avg(hours) as overall_avg from</span>
</span><span id="__span-0-2659"><a id="__codelineno-0-2659" name="__codelineno-0-2659"></a><span class="s1">(select participant_id, sum(hours) as hours from </span>
</span><span id="__span-0-2660"><a id="__codelineno-0-2660" name="__codelineno-0-2660"></a><span class="s1">(select distinct participant_id </span>
</span><span id="__span-0-2661"><a id="__codelineno-0-2661" name="__codelineno-0-2661"></a><span class="s1">from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span>
</span><span id="__span-0-2662"><a id="__codelineno-0-2662" name="__codelineno-0-2662"></a><span class="s1">where program_type REGEXP &#39;.*</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">program</span><span class="si">}</span><span class="s1"> - Case Management.*&#39;) l</span>
</span><span id="__span-0-2663"><a id="__codelineno-0-2663" name="__codelineno-0-2663"></a><span class="s1">join civicore.case_sessions using(participant_id)</span>
</span><span id="__span-0-2664"><a id="__codelineno-0-2664" name="__codelineno-0-2664"></a><span class="s1">where session_date BETWEEN </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t1</span><span class="si">}</span><span class="s1"> and </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t2</span><span class="si">}</span><span class="s1"> AND session_casenote = &quot;casenote&quot;</span>
</span><span id="__span-0-2665"><a id="__codelineno-0-2665" name="__codelineno-0-2665"></a><span class="s1">group by participant_id) ll&#39;&#39;&#39;</span>
</span><span id="__span-0-2666"><a id="__codelineno-0-2666" name="__codelineno-0-2666"></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_run</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="__span-0-2667"><a id="__codelineno-0-2667" name="__codelineno-0-2667"></a>        <span class="k">return</span> <span class="n">df</span>
</span></code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="script.nice_sql.JAC_IDHS.jac_cm_sessions" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">jac_cm_sessions</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>gets average case management sessions for JAC clients</p>

          <details class="quote">
            <summary>Source code in <code>script\nice_sql.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2669">2669</a></span>
<span class="normal"><a href="#__codelineno-0-2670">2670</a></span>
<span class="normal"><a href="#__codelineno-0-2671">2671</a></span>
<span class="normal"><a href="#__codelineno-0-2672">2672</a></span>
<span class="normal"><a href="#__codelineno-0-2673">2673</a></span>
<span class="normal"><a href="#__codelineno-0-2674">2674</a></span>
<span class="normal"><a href="#__codelineno-0-2675">2675</a></span>
<span class="normal"><a href="#__codelineno-0-2676">2676</a></span>
<span class="normal"><a href="#__codelineno-0-2677">2677</a></span>
<span class="normal"><a href="#__codelineno-0-2678">2678</a></span>
<span class="normal"><a href="#__codelineno-0-2679">2679</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2669"><a id="__codelineno-0-2669" name="__codelineno-0-2669"></a>    <span class="k">def</span> <span class="nf">jac_cm_sessions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-2670"><a id="__codelineno-0-2670" name="__codelineno-0-2670"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-0-2671"><a id="__codelineno-0-2671" name="__codelineno-0-2671"></a><span class="sd">        gets average case management sessions for JAC clients</span>
</span><span id="__span-0-2672"><a id="__codelineno-0-2672" name="__codelineno-0-2672"></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="__span-0-2673"><a id="__codelineno-0-2673" name="__codelineno-0-2673"></a>        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;select count(distinct case_session_id)/count(distinct participant_id) from (select * from (select distinct participant_id </span>
</span><span id="__span-0-2674"><a id="__codelineno-0-2674" name="__codelineno-0-2674"></a><span class="s1">from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span>
</span><span id="__span-0-2675"><a id="__codelineno-0-2675" name="__codelineno-0-2675"></a><span class="s1">where program_type REGEXP &#39;.*</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">program</span><span class="si">}</span><span class="s1"> - Case Management.*&#39;) l</span>
</span><span id="__span-0-2676"><a id="__codelineno-0-2676" name="__codelineno-0-2676"></a><span class="s1">join civicore.case_sessions using(participant_id)</span>
</span><span id="__span-0-2677"><a id="__codelineno-0-2677" name="__codelineno-0-2677"></a><span class="s1">where session_date BETWEEN </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t1</span><span class="si">}</span><span class="s1"> and </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">q_t2</span><span class="si">}</span><span class="s1"> AND session_casenote = &quot;casenote&quot; and hours &gt; 0 and (indirect_type != &#39;Unsuccessful Attempt&#39; or indirect_type IS NULL)) ll;&#39;&#39;&#39;</span>
</span><span id="__span-0-2678"><a id="__codelineno-0-2678" name="__codelineno-0-2678"></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_run</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="__span-0-2679"><a id="__codelineno-0-2679" name="__codelineno-0-2679"></a>        <span class="k">return</span> <span class="n">df</span>
</span></code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="script.nice_sql.JAC_IDHS.jac_linked_participant_tally" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">jac_linked_participant_tally</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>counts jac participants with a started linkage</p>

          <details class="quote">
            <summary>Source code in <code>script\nice_sql.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2691">2691</a></span>
<span class="normal"><a href="#__codelineno-0-2692">2692</a></span>
<span class="normal"><a href="#__codelineno-0-2693">2693</a></span>
<span class="normal"><a href="#__codelineno-0-2694">2694</a></span>
<span class="normal"><a href="#__codelineno-0-2695">2695</a></span>
<span class="normal"><a href="#__codelineno-0-2696">2696</a></span>
<span class="normal"><a href="#__codelineno-0-2697">2697</a></span>
<span class="normal"><a href="#__codelineno-0-2698">2698</a></span>
<span class="normal"><a href="#__codelineno-0-2699">2699</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2691"><a id="__codelineno-0-2691" name="__codelineno-0-2691"></a>    <span class="k">def</span> <span class="nf">jac_linked_participant_tally</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-2692"><a id="__codelineno-0-2692" name="__codelineno-0-2692"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-0-2693"><a id="__codelineno-0-2693" name="__codelineno-0-2693"></a><span class="sd">        counts jac participants with a started linkage</span>
</span><span id="__span-0-2694"><a id="__codelineno-0-2694" name="__codelineno-0-2694"></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="__span-0-2695"><a id="__codelineno-0-2695" name="__codelineno-0-2695"></a>        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;select count(distinct participant_id) from participants.jac</span>
</span><span id="__span-0-2696"><a id="__codelineno-0-2696" name="__codelineno-0-2696"></a><span class="s1">join civicore.linkages l using (participant_id)</span>
</span><span id="__span-0-2697"><a id="__codelineno-0-2697" name="__codelineno-0-2697"></a><span class="s1">where l.start_date IS NOT NULL&#39;&#39;&#39;</span>
</span><span id="__span-0-2698"><a id="__codelineno-0-2698" name="__codelineno-0-2698"></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_run</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="__span-0-2699"><a id="__codelineno-0-2699" name="__codelineno-0-2699"></a>        <span class="k">return</span> <span class="n">df</span>
</span></code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="script.nice_sql.JAC_IDHS.jac_transpo_assist" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">jac_transpo_assist</span><span class="p">()</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>counts clients marked as both jac and CRwS</p>

          <details class="quote">
            <summary>Source code in <code>script\nice_sql.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2681">2681</a></span>
<span class="normal"><a href="#__codelineno-0-2682">2682</a></span>
<span class="normal"><a href="#__codelineno-0-2683">2683</a></span>
<span class="normal"><a href="#__codelineno-0-2684">2684</a></span>
<span class="normal"><a href="#__codelineno-0-2685">2685</a></span>
<span class="normal"><a href="#__codelineno-0-2686">2686</a></span>
<span class="normal"><a href="#__codelineno-0-2687">2687</a></span>
<span class="normal"><a href="#__codelineno-0-2688">2688</a></span>
<span class="normal"><a href="#__codelineno-0-2689">2689</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2681"><a id="__codelineno-0-2681" name="__codelineno-0-2681"></a>    <span class="k">def</span> <span class="nf">jac_transpo_assist</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="__span-0-2682"><a id="__codelineno-0-2682" name="__codelineno-0-2682"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-0-2683"><a id="__codelineno-0-2683" name="__codelineno-0-2683"></a><span class="sd">        counts clients marked as both jac and CRwS</span>
</span><span id="__span-0-2684"><a id="__codelineno-0-2684" name="__codelineno-0-2684"></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="__span-0-2685"><a id="__codelineno-0-2685" name="__codelineno-0-2685"></a>        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;select count(distinct participant_id)</span>
</span><span id="__span-0-2686"><a id="__codelineno-0-2686" name="__codelineno-0-2686"></a><span class="s1">from participants.jac</span>
</span><span id="__span-0-2687"><a id="__codelineno-0-2687" name="__codelineno-0-2687"></a><span class="s1">where program_type like &quot;%JAC%&quot; and crws = 1&#39;&#39;&#39;</span>
</span><span id="__span-0-2688"><a id="__codelineno-0-2688" name="__codelineno-0-2688"></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_run</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="__span-0-2689"><a id="__codelineno-0-2689" name="__codelineno-0-2689"></a>        <span class="k">return</span> <span class="n">df</span>
</span></code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div><h3 id="running-reports_1">Running Reports</h3>
<div class="language-py highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="n">j</span> <span class="o">=</span> <span class="n">JAC_IDHS</span><span class="p">(</span><span class="n">t1</span> <span class="o">=</span> <span class="s1">&#39;2023-12-01&#39;</span><span class="p">,</span> <span class="n">t2</span> <span class="o">=</span> <span class="s1">&#39;2023-12-31&#39;</span><span class="p">,</span> <span class="n">print_SQL</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> 
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="n">clipboard</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">grant</span> <span class="o">=</span> <span class="s1">&#39;jac&#39;</span><span class="p">)</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="n">j</span><span class="o">.</span><span class="n">run_report</span><span class="p">(</span><span class="n">j</span><span class="o">.</span><span class="n">JAC_Smartsheet</span><span class="p">)</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="n">j</span><span class="o">.</span><span class="n">run_report</span><span class="p">(</span><span class="n">j</span><span class="o">.</span><span class="n">CVI</span><span class="p">)</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="n">j</span><span class="o">.</span><span class="n">run_report</span><span class="p">(</span><span class="n">j</span><span class="o">.</span><span class="n">PPR</span><span class="p">)</span>
</span></code></pre></div>
<h4 id="jac_smartsheet">JAC_Smartsheet</h4>
<ul>
<li><strong>participant count:</strong> <code>("idhs_tally",())</code></li>
<li><strong>genders:</strong> <code>('dem_race_gender', (False,'gender',))</code></li>
<li><strong>races:</strong> <code>('dem_race_gender', (False, 'race',))</code></li>
<li><strong>ages:</strong> <code>('dem_age',())</code></li>
<li><strong>services:</strong> <code>('idhs_service_tally',())</code></li>
<li><strong>avg hours spent on CM:</strong> <code>('jac_cm_hours',())</code></li>
<li><strong>avg number of CM sessions:</strong> <code>('jac_cm_sessions',())</code></li>
<li><strong>transportation assistance:</strong> <code>('jac_transpo_assist',())</code></li>
<li><strong>connected to other providers:</strong> <code>('jac_linked_participant_tally', ())</code></li>
<li><strong>referrals:</strong> <code>('idhs_linkages',())</code></li>
</ul>
<h4 id="cvi">CVI</h4>
<ul>
<li><strong>total participants:</strong> <code>('idhs_tally',())</code></li>
<li><strong>ages:</strong> <code>('idhs_ages',())</code></li>
<li><strong>races:</strong> <code>('idhs_race_gender', ('race',))</code></li>
<li><strong>genders:</strong> <code>('idhs_race_gender', ('gender',))</code></li>
<li><strong>languages:</strong> <code>('idhs_language',())</code></li>
<li><strong>services:</strong> <code>('idhs_service_tally',())</code></li>
<li><strong>referrals:</strong> <code>('idhs_linkages',())</code></li>
<li><strong>number of mediations:</strong> <code>('mediation_tally',())</code></li>
<li><strong>CPIC notifications:</strong> <code>('idhs_incidents_detailed', (True,))</code></li>
<li><strong>non-CPIC notifications:</strong> <code>('idhs_incidents_detailed', (False,))</code></li>
<li><strong>time spent on mediations:</strong> <code>('mediation_time_spent',())</code></li>
</ul>
<h4 id="ppr">PPR</h4>
<ul>
<li><strong>new and continuing clients:</strong> <code>('idhs_tally', (False,))</code></li>
<li><strong>closed clients:</strong> <code>('idhs_tally', (True,))</code></li>
<li><strong>outreach and legal:</strong> <code>('idhs_service_tally',())</code></li>
<li><strong>race:</strong> <code>('dem_race_gender', (False, 'race',))</code></li>
<li><strong>gender:</strong> <code>('dem_race_gender', (False, 'gender',))</code></li>
<li><strong>ages:</strong> <code>('idhs_ages', (True,))</code></li>
<li><strong>eligibility:</strong> <code>('idhs_class_notes',(True,))</code></li>
<li><strong>cm linkages:</strong> <code>('idhs_linkages',())</code></li>
<li><strong>initial mediations:</strong> <code>('mediation_tally', (False,))</code></li>
<li><strong>followup mediations:</strong> <code>('mediation_tally', (True,))</code></li>
<li><strong>incidents:</strong> <code>('incident_tally',())</code></li>
</ul>
<h2 id="monthly-reports">Monthly Reports</h2>
<div class="language-py highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="n">m</span> <span class="o">=</span> <span class="n">Monthly_Report</span><span class="p">(</span><span class="n">t1</span> <span class="o">=</span> <span class="s1">&#39;2023-12-01&#39;</span><span class="p">,</span> <span class="n">t2</span> <span class="o">=</span> <span class="s1">&#39;2023-12-31&#39;</span><span class="p">,</span> <span class="n">print_SQL</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> 
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="n">clipboard</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</span></code></pre></div>


<div class="doc doc-object doc-class">




  <div class="doc doc-contents first">
          <p class="doc doc-class-bases">
            Bases: <code><span title="script.nice_sql.Queries">Queries</span></code></p>


            <details class="quote">
              <summary>Source code in <code>script\nice_sql.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2250">2250</a></span>
<span class="normal"><a href="#__codelineno-0-2251">2251</a></span>
<span class="normal"><a href="#__codelineno-0-2252">2252</a></span>
<span class="normal"><a href="#__codelineno-0-2253">2253</a></span>
<span class="normal"><a href="#__codelineno-0-2254">2254</a></span>
<span class="normal"><a href="#__codelineno-0-2255">2255</a></span>
<span class="normal"><a href="#__codelineno-0-2256">2256</a></span>
<span class="normal"><a href="#__codelineno-0-2257">2257</a></span>
<span class="normal"><a href="#__codelineno-0-2258">2258</a></span>
<span class="normal"><a href="#__codelineno-0-2259">2259</a></span>
<span class="normal"><a href="#__codelineno-0-2260">2260</a></span>
<span class="normal"><a href="#__codelineno-0-2261">2261</a></span>
<span class="normal"><a href="#__codelineno-0-2262">2262</a></span>
<span class="normal"><a href="#__codelineno-0-2263">2263</a></span>
<span class="normal"><a href="#__codelineno-0-2264">2264</a></span>
<span class="normal"><a href="#__codelineno-0-2265">2265</a></span>
<span class="normal"><a href="#__codelineno-0-2266">2266</a></span>
<span class="normal"><a href="#__codelineno-0-2267">2267</a></span>
<span class="normal"><a href="#__codelineno-0-2268">2268</a></span>
<span class="normal"><a href="#__codelineno-0-2269">2269</a></span>
<span class="normal"><a href="#__codelineno-0-2270">2270</a></span>
<span class="normal"><a href="#__codelineno-0-2271">2271</a></span>
<span class="normal"><a href="#__codelineno-0-2272">2272</a></span>
<span class="normal"><a href="#__codelineno-0-2273">2273</a></span>
<span class="normal"><a href="#__codelineno-0-2274">2274</a></span>
<span class="normal"><a href="#__codelineno-0-2275">2275</a></span>
<span class="normal"><a href="#__codelineno-0-2276">2276</a></span>
<span class="normal"><a href="#__codelineno-0-2277">2277</a></span>
<span class="normal"><a href="#__codelineno-0-2278">2278</a></span>
<span class="normal"><a href="#__codelineno-0-2279">2279</a></span>
<span class="normal"><a href="#__codelineno-0-2280">2280</a></span>
<span class="normal"><a href="#__codelineno-0-2281">2281</a></span>
<span class="normal"><a href="#__codelineno-0-2282">2282</a></span>
<span class="normal"><a href="#__codelineno-0-2283">2283</a></span>
<span class="normal"><a href="#__codelineno-0-2284">2284</a></span>
<span class="normal"><a href="#__codelineno-0-2285">2285</a></span>
<span class="normal"><a href="#__codelineno-0-2286">2286</a></span>
<span class="normal"><a href="#__codelineno-0-2287">2287</a></span>
<span class="normal"><a href="#__codelineno-0-2288">2288</a></span>
<span class="normal"><a href="#__codelineno-0-2289">2289</a></span>
<span class="normal"><a href="#__codelineno-0-2290">2290</a></span>
<span class="normal"><a href="#__codelineno-0-2291">2291</a></span>
<span class="normal"><a href="#__codelineno-0-2292">2292</a></span>
<span class="normal"><a href="#__codelineno-0-2293">2293</a></span>
<span class="normal"><a href="#__codelineno-0-2294">2294</a></span>
<span class="normal"><a href="#__codelineno-0-2295">2295</a></span>
<span class="normal"><a href="#__codelineno-0-2296">2296</a></span>
<span class="normal"><a href="#__codelineno-0-2297">2297</a></span>
<span class="normal"><a href="#__codelineno-0-2298">2298</a></span>
<span class="normal"><a href="#__codelineno-0-2299">2299</a></span>
<span class="normal"><a href="#__codelineno-0-2300">2300</a></span>
<span class="normal"><a href="#__codelineno-0-2301">2301</a></span>
<span class="normal"><a href="#__codelineno-0-2302">2302</a></span>
<span class="normal"><a href="#__codelineno-0-2303">2303</a></span>
<span class="normal"><a href="#__codelineno-0-2304">2304</a></span>
<span class="normal"><a href="#__codelineno-0-2305">2305</a></span>
<span class="normal"><a href="#__codelineno-0-2306">2306</a></span>
<span class="normal"><a href="#__codelineno-0-2307">2307</a></span>
<span class="normal"><a href="#__codelineno-0-2308">2308</a></span>
<span class="normal"><a href="#__codelineno-0-2309">2309</a></span>
<span class="normal"><a href="#__codelineno-0-2310">2310</a></span>
<span class="normal"><a href="#__codelineno-0-2311">2311</a></span>
<span class="normal"><a href="#__codelineno-0-2312">2312</a></span>
<span class="normal"><a href="#__codelineno-0-2313">2313</a></span>
<span class="normal"><a href="#__codelineno-0-2314">2314</a></span>
<span class="normal"><a href="#__codelineno-0-2315">2315</a></span>
<span class="normal"><a href="#__codelineno-0-2316">2316</a></span>
<span class="normal"><a href="#__codelineno-0-2317">2317</a></span>
<span class="normal"><a href="#__codelineno-0-2318">2318</a></span>
<span class="normal"><a href="#__codelineno-0-2319">2319</a></span>
<span class="normal"><a href="#__codelineno-0-2320">2320</a></span>
<span class="normal"><a href="#__codelineno-0-2321">2321</a></span>
<span class="normal"><a href="#__codelineno-0-2322">2322</a></span>
<span class="normal"><a href="#__codelineno-0-2323">2323</a></span>
<span class="normal"><a href="#__codelineno-0-2324">2324</a></span>
<span class="normal"><a href="#__codelineno-0-2325">2325</a></span>
<span class="normal"><a href="#__codelineno-0-2326">2326</a></span>
<span class="normal"><a href="#__codelineno-0-2327">2327</a></span>
<span class="normal"><a href="#__codelineno-0-2328">2328</a></span>
<span class="normal"><a href="#__codelineno-0-2329">2329</a></span>
<span class="normal"><a href="#__codelineno-0-2330">2330</a></span>
<span class="normal"><a href="#__codelineno-0-2331">2331</a></span>
<span class="normal"><a href="#__codelineno-0-2332">2332</a></span>
<span class="normal"><a href="#__codelineno-0-2333">2333</a></span>
<span class="normal"><a href="#__codelineno-0-2334">2334</a></span>
<span class="normal"><a href="#__codelineno-0-2335">2335</a></span>
<span class="normal"><a href="#__codelineno-0-2336">2336</a></span>
<span class="normal"><a href="#__codelineno-0-2337">2337</a></span>
<span class="normal"><a href="#__codelineno-0-2338">2338</a></span>
<span class="normal"><a href="#__codelineno-0-2339">2339</a></span>
<span class="normal"><a href="#__codelineno-0-2340">2340</a></span>
<span class="normal"><a href="#__codelineno-0-2341">2341</a></span>
<span class="normal"><a href="#__codelineno-0-2342">2342</a></span>
<span class="normal"><a href="#__codelineno-0-2343">2343</a></span>
<span class="normal"><a href="#__codelineno-0-2344">2344</a></span>
<span class="normal"><a href="#__codelineno-0-2345">2345</a></span>
<span class="normal"><a href="#__codelineno-0-2346">2346</a></span>
<span class="normal"><a href="#__codelineno-0-2347">2347</a></span>
<span class="normal"><a href="#__codelineno-0-2348">2348</a></span>
<span class="normal"><a href="#__codelineno-0-2349">2349</a></span>
<span class="normal"><a href="#__codelineno-0-2350">2350</a></span>
<span class="normal"><a href="#__codelineno-0-2351">2351</a></span>
<span class="normal"><a href="#__codelineno-0-2352">2352</a></span>
<span class="normal"><a href="#__codelineno-0-2353">2353</a></span>
<span class="normal"><a href="#__codelineno-0-2354">2354</a></span>
<span class="normal"><a href="#__codelineno-0-2355">2355</a></span>
<span class="normal"><a href="#__codelineno-0-2356">2356</a></span>
<span class="normal"><a href="#__codelineno-0-2357">2357</a></span>
<span class="normal"><a href="#__codelineno-0-2358">2358</a></span>
<span class="normal"><a href="#__codelineno-0-2359">2359</a></span>
<span class="normal"><a href="#__codelineno-0-2360">2360</a></span>
<span class="normal"><a href="#__codelineno-0-2361">2361</a></span>
<span class="normal"><a href="#__codelineno-0-2362">2362</a></span>
<span class="normal"><a href="#__codelineno-0-2363">2363</a></span>
<span class="normal"><a href="#__codelineno-0-2364">2364</a></span>
<span class="normal"><a href="#__codelineno-0-2365">2365</a></span>
<span class="normal"><a href="#__codelineno-0-2366">2366</a></span>
<span class="normal"><a href="#__codelineno-0-2367">2367</a></span>
<span class="normal"><a href="#__codelineno-0-2368">2368</a></span>
<span class="normal"><a href="#__codelineno-0-2369">2369</a></span>
<span class="normal"><a href="#__codelineno-0-2370">2370</a></span>
<span class="normal"><a href="#__codelineno-0-2371">2371</a></span>
<span class="normal"><a href="#__codelineno-0-2372">2372</a></span>
<span class="normal"><a href="#__codelineno-0-2373">2373</a></span>
<span class="normal"><a href="#__codelineno-0-2374">2374</a></span>
<span class="normal"><a href="#__codelineno-0-2375">2375</a></span>
<span class="normal"><a href="#__codelineno-0-2376">2376</a></span>
<span class="normal"><a href="#__codelineno-0-2377">2377</a></span>
<span class="normal"><a href="#__codelineno-0-2378">2378</a></span>
<span class="normal"><a href="#__codelineno-0-2379">2379</a></span>
<span class="normal"><a href="#__codelineno-0-2380">2380</a></span>
<span class="normal"><a href="#__codelineno-0-2381">2381</a></span>
<span class="normal"><a href="#__codelineno-0-2382">2382</a></span>
<span class="normal"><a href="#__codelineno-0-2383">2383</a></span>
<span class="normal"><a href="#__codelineno-0-2384">2384</a></span>
<span class="normal"><a href="#__codelineno-0-2385">2385</a></span>
<span class="normal"><a href="#__codelineno-0-2386">2386</a></span>
<span class="normal"><a href="#__codelineno-0-2387">2387</a></span>
<span class="normal"><a href="#__codelineno-0-2388">2388</a></span>
<span class="normal"><a href="#__codelineno-0-2389">2389</a></span>
<span class="normal"><a href="#__codelineno-0-2390">2390</a></span>
<span class="normal"><a href="#__codelineno-0-2391">2391</a></span>
<span class="normal"><a href="#__codelineno-0-2392">2392</a></span>
<span class="normal"><a href="#__codelineno-0-2393">2393</a></span>
<span class="normal"><a href="#__codelineno-0-2394">2394</a></span>
<span class="normal"><a href="#__codelineno-0-2395">2395</a></span>
<span class="normal"><a href="#__codelineno-0-2396">2396</a></span>
<span class="normal"><a href="#__codelineno-0-2397">2397</a></span>
<span class="normal"><a href="#__codelineno-0-2398">2398</a></span>
<span class="normal"><a href="#__codelineno-0-2399">2399</a></span>
<span class="normal"><a href="#__codelineno-0-2400">2400</a></span>
<span class="normal"><a href="#__codelineno-0-2401">2401</a></span>
<span class="normal"><a href="#__codelineno-0-2402">2402</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2250"><a id="__codelineno-0-2250" name="__codelineno-0-2250"></a><span class="k">class</span> <span class="nc">Monthly_Report</span><span class="p">(</span><span class="n">Queries</span><span class="p">):</span>
</span><span id="__span-0-2251"><a id="__codelineno-0-2251" name="__codelineno-0-2251"></a>    <span class="n">program_grant_funcs</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-2252"><a id="__codelineno-0-2252" name="__codelineno-0-2252"></a>    <span class="s2">&quot;grant involvement&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;grant_tally&quot;</span><span class="p">,</span> <span class="p">()),</span>
</span><span id="__span-0-2253"><a id="__codelineno-0-2253" name="__codelineno-0-2253"></a>    <span class="s2">&quot;grants started&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;grant_tally&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;start_date&quot;</span><span class="p">,)),</span>
</span><span id="__span-0-2254"><a id="__codelineno-0-2254" name="__codelineno-0-2254"></a>    <span class="s2">&quot;grants ended&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;grant_tally&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;end_date&quot;</span><span class="p">,)),</span>
</span><span id="__span-0-2255"><a id="__codelineno-0-2255" name="__codelineno-0-2255"></a>    <span class="s2">&quot;Program Involvement by Days - All&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;grouped_by_time&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;program&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span><span class="kc">True</span><span class="p">,)),</span>
</span><span id="__span-0-2256"><a id="__codelineno-0-2256" name="__codelineno-0-2256"></a>    <span class="s2">&quot;Program Involvement by Days - Closed&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;grouped_by_time&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;program&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,)),</span>
</span><span id="__span-0-2257"><a id="__codelineno-0-2257" name="__codelineno-0-2257"></a>    <span class="s2">&quot;PROGRAMS BY RACE&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;programs_by_demographic&quot;</span><span class="p">,(</span><span class="s2">&quot;race&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,)),</span>
</span><span id="__span-0-2258"><a id="__codelineno-0-2258" name="__codelineno-0-2258"></a>    <span class="s2">&quot;PROGRAMS BY GENDER&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;programs_by_demographic&quot;</span><span class="p">,(</span><span class="s2">&quot;gender&quot;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span> <span class="p">)),</span>
</span><span id="__span-0-2259"><a id="__codelineno-0-2259" name="__codelineno-0-2259"></a>    <span class="s2">&quot;PROGRAMS BY AGE&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;programs_by_demographic&quot;</span><span class="p">,(</span><span class="s2">&quot;age&quot;</span><span class="p">,</span><span class="kc">True</span><span class="p">,)),</span>
</span><span id="__span-0-2260"><a id="__codelineno-0-2260" name="__codelineno-0-2260"></a>    <span class="s2">&quot;ALL_DAYS_SERVED_BY_GRANT&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;grouped_by_time&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;grant&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">,)),</span>
</span><span id="__span-0-2261"><a id="__codelineno-0-2261" name="__codelineno-0-2261"></a>    <span class="s2">&quot;CLOSED_DAYS_SERVED_BY_GRANT&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;grouped_by_time&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;grant&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,)),</span>
</span><span id="__span-0-2262"><a id="__codelineno-0-2262" name="__codelineno-0-2262"></a>    <span class="s2">&quot;PACKAGE OF SERVICES&quot;</span><span class="p">:(</span><span class="s2">&quot;programs_packages&quot;</span><span class="p">,()),</span>
</span><span id="__span-0-2263"><a id="__codelineno-0-2263" name="__codelineno-0-2263"></a>    <span class="p">}</span>
</span><span id="__span-0-2264"><a id="__codelineno-0-2264" name="__codelineno-0-2264"></a>    <span class="n">legal_funcs</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-2265"><a id="__codelineno-0-2265" name="__codelineno-0-2265"></a>    <span class="s2">&quot;CiviCore.Legal Tally&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;legal_tally&quot;</span><span class="p">,()),</span>
</span><span id="__span-0-2266"><a id="__codelineno-0-2266" name="__codelineno-0-2266"></a>    <span class="s2">&quot;Case Pending Tally&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;legal_tally&quot;</span><span class="p">,(</span><span class="kc">True</span><span class="p">,)),</span>
</span><span id="__span-0-2267"><a id="__codelineno-0-2267" name="__codelineno-0-2267"></a>    <span class="s2">&quot;Case Type - All Cases&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;legal_case_type&quot;</span><span class="p">,</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="s2">&quot;opened&quot;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;case&quot;</span><span class="p">)),</span>
</span><span id="__span-0-2268"><a id="__codelineno-0-2268" name="__codelineno-0-2268"></a>    <span class="s2">&quot;Case Type - Opened&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;legal_case_type&quot;</span><span class="p">,</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;opened&quot;</span><span class="p">,</span><span class="s2">&quot;case&quot;</span><span class="p">)),</span>
</span><span id="__span-0-2269"><a id="__codelineno-0-2269" name="__codelineno-0-2269"></a>    <span class="s2">&quot;Case Type - Closed&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;legal_case_type&quot;</span><span class="p">,</span> <span class="p">(</span><span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;closed&quot;</span><span class="p">,</span><span class="s2">&quot;case&quot;</span><span class="p">)),</span>
</span><span id="__span-0-2270"><a id="__codelineno-0-2270" name="__codelineno-0-2270"></a>    <span class="s2">&quot;Rearrested&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;legal_rearrested&quot;</span><span class="p">,()),</span>
</span><span id="__span-0-2271"><a id="__codelineno-0-2271" name="__codelineno-0-2271"></a>    <span class="s2">&quot;Pending Cases&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;legal_pending_cases&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;t2&quot;</span><span class="p">,)),</span>
</span><span id="__span-0-2272"><a id="__codelineno-0-2272" name="__codelineno-0-2272"></a>    <span class="s2">&quot;Case Outcomes&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;legal_case_outcomes&quot;</span><span class="p">,</span> <span class="p">()),</span>
</span><span id="__span-0-2273"><a id="__codelineno-0-2273" name="__codelineno-0-2273"></a>    <span class="s2">&quot;Guilty Plea Outcomes&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;legal_plea_outcomes&quot;</span><span class="p">,</span> <span class="p">(</span><span class="kc">True</span><span class="p">,))</span>
</span><span id="__span-0-2274"><a id="__codelineno-0-2274" name="__codelineno-0-2274"></a>    <span class="p">}</span>
</span><span id="__span-0-2275"><a id="__codelineno-0-2275" name="__codelineno-0-2275"></a>    <span class="n">cm_outreach_funcs</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-0-2276"><a id="__codelineno-0-2276" name="__codelineno-0-2276"></a>    <span class="s2">&quot;receiving CM&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;programs_service_tally&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;service_cm&quot;</span><span class="p">,)),</span>
</span><span id="__span-0-2277"><a id="__codelineno-0-2277" name="__codelineno-0-2277"></a>    <span class="s2">&quot;Had CM Session in Month&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;programs_sessions&quot;</span><span class="p">,</span> <span class="p">()),</span>
</span><span id="__span-0-2278"><a id="__codelineno-0-2278" name="__codelineno-0-2278"></a>    <span class="s2">&quot;CM Session Count&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;programs_session_tally&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;cm&quot;</span><span class="p">,)),</span>
</span><span id="__span-0-2279"><a id="__codelineno-0-2279" name="__codelineno-0-2279"></a>    <span class="s2">&quot;CM Session Length&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;programs_session_length&quot;</span><span class="p">,</span> <span class="p">()),</span>
</span><span id="__span-0-2280"><a id="__codelineno-0-2280" name="__codelineno-0-2280"></a>    <span class="s2">&quot;CM Session Length (Grouped)&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;programs_session_length&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;cm&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">)),</span>
</span><span id="__span-0-2281"><a id="__codelineno-0-2281" name="__codelineno-0-2281"></a>    <span class="s2">&quot;Had Outreach Session in Month&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;programs_sessions&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;outreach&quot;</span><span class="p">,)),</span>
</span><span id="__span-0-2282"><a id="__codelineno-0-2282" name="__codelineno-0-2282"></a>    <span class="s2">&quot;Outreach Session Count&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;programs_session_tally&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;outreach&quot;</span><span class="p">,)),</span>
</span><span id="__span-0-2283"><a id="__codelineno-0-2283" name="__codelineno-0-2283"></a>    <span class="s2">&quot;linkage tally&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;link_tally&quot;</span><span class="p">,</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;linked_date&quot;</span><span class="p">,)),</span>
</span><span id="__span-0-2284"><a id="__codelineno-0-2284" name="__codelineno-0-2284"></a>    <span class="s2">&quot;services linked&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;link_goal_area&quot;</span><span class="p">,</span> <span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;both&quot;</span><span class="p">,))</span> 
</span><span id="__span-0-2285"><a id="__codelineno-0-2285" name="__codelineno-0-2285"></a>    <span class="p">}</span>
</span><span id="__span-0-2286"><a id="__codelineno-0-2286" name="__codelineno-0-2286"></a>
</span><span id="__span-0-2287"><a id="__codelineno-0-2287" name="__codelineno-0-2287"></a>
</span><span id="__span-0-2288"><a id="__codelineno-0-2288" name="__codelineno-0-2288"></a>
</span><span id="__span-0-2289"><a id="__codelineno-0-2289" name="__codelineno-0-2289"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">default_table</span><span class="o">=</span><span class="s2">&quot;stints.classify_by_program&quot;</span><span class="p">):</span>
</span><span id="__span-0-2290"><a id="__codelineno-0-2290" name="__codelineno-0-2290"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">default_table</span><span class="p">)</span>
</span><span id="__span-0-2291"><a id="__codelineno-0-2291" name="__codelineno-0-2291"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">table_update</span><span class="p">(</span><span class="s2">&quot;mreport&quot;</span><span class="p">,</span> <span class="n">update_default_table</span><span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-2292"><a id="__codelineno-0-2292" name="__codelineno-0-2292"></a>
</span><span id="__span-0-2293"><a id="__codelineno-0-2293" name="__codelineno-0-2293"></a>    <span class="k">def</span> <span class="nf">grouped_by_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">program_grant</span> <span class="o">=</span> <span class="s2">&quot;grant&quot;</span><span class="p">):</span>
</span><span id="__span-0-2294"><a id="__codelineno-0-2294" name="__codelineno-0-2294"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-0-2295"><a id="__codelineno-0-2295" name="__codelineno-0-2295"></a><span class="sd">        Returns program or grant involvement by client status</span>
</span><span id="__span-0-2296"><a id="__codelineno-0-2296" name="__codelineno-0-2296"></a>
</span><span id="__span-0-2297"><a id="__codelineno-0-2297" name="__codelineno-0-2297"></a><span class="sd">        Parameters:</span>
</span><span id="__span-0-2298"><a id="__codelineno-0-2298" name="__codelineno-0-2298"></a><span class="sd">            program_grant: &quot;program&quot; tallies program involvement, &quot;grant&quot; tallies grant involvement. Defaults to &quot;grant&quot;</span>
</span><span id="__span-0-2299"><a id="__codelineno-0-2299" name="__codelineno-0-2299"></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="__span-0-2300"><a id="__codelineno-0-2300" name="__codelineno-0-2300"></a>        <span class="k">if</span> <span class="n">program_grant</span> <span class="o">==</span> <span class="s2">&quot;program&quot;</span><span class="p">:</span>
</span><span id="__span-0-2301"><a id="__codelineno-0-2301" name="__codelineno-0-2301"></a>            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;select client_status, </span>
</span><span id="__span-0-2302"><a id="__codelineno-0-2302" name="__codelineno-0-2302"></a><span class="s1">    COUNT(DISTINCT CASE WHEN hd = 1 THEN participant_id END) AS HD,</span>
</span><span id="__span-0-2303"><a id="__codelineno-0-2303" name="__codelineno-0-2303"></a><span class="s1">    COUNT(DISTINCT CASE WHEN cm_juv_divert = 1 THEN participant_id END) AS juv_div,</span>
</span><span id="__span-0-2304"><a id="__codelineno-0-2304" name="__codelineno-0-2304"></a><span class="s1">    COUNT(DISTINCT CASE WHEN rjcc = 1 THEN participant_id END) AS RJCC,</span>
</span><span id="__span-0-2305"><a id="__codelineno-0-2305" name="__codelineno-0-2305"></a><span class="s1">    COUNT(DISTINCT CASE WHEN cm_scan = 1 THEN participant_id END) AS SCaN,</span>
</span><span id="__span-0-2306"><a id="__codelineno-0-2306" name="__codelineno-0-2306"></a><span class="s1">    COUNT(DISTINCT CASE WHEN vp = 1 THEN participant_id END) AS vp,</span>
</span><span id="__span-0-2307"><a id="__codelineno-0-2307" name="__codelineno-0-2307"></a><span class="s1">    COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%JAC%&quot; THEN participant_id END) AS JAC,</span>
</span><span id="__span-0-2308"><a id="__codelineno-0-2308" name="__codelineno-0-2308"></a><span class="s1">    COUNT(DISTINCT CASE WHEN vp = 1 AND grant_type LIKE &quot;%IDHS%&quot; THEN participant_id END) AS IDHS</span>
</span><span id="__span-0-2309"><a id="__codelineno-0-2309" name="__codelineno-0-2309"></a><span class="s1">    from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span>
</span><span id="__span-0-2310"><a id="__codelineno-0-2310" name="__codelineno-0-2310"></a><span class="s1">    group by client_status</span>
</span><span id="__span-0-2311"><a id="__codelineno-0-2311" name="__codelineno-0-2311"></a><span class="s1">    UNION ALL</span>
</span><span id="__span-0-2312"><a id="__codelineno-0-2312" name="__codelineno-0-2312"></a><span class="s1">    SELECT</span>
</span><span id="__span-0-2313"><a id="__codelineno-0-2313" name="__codelineno-0-2313"></a><span class="s1">    &quot;new client&quot; as client_status,</span>
</span><span id="__span-0-2314"><a id="__codelineno-0-2314" name="__codelineno-0-2314"></a><span class="s1">    COUNT(DISTINCT CASE WHEN hd = 1 THEN participant_id END) AS HD,</span>
</span><span id="__span-0-2315"><a id="__codelineno-0-2315" name="__codelineno-0-2315"></a><span class="s1">    COUNT(DISTINCT CASE WHEN cm_juv_divert = 1 THEN participant_id END) AS juv_div,</span>
</span><span id="__span-0-2316"><a id="__codelineno-0-2316" name="__codelineno-0-2316"></a><span class="s1">    COUNT(DISTINCT CASE WHEN rjcc = 1 THEN participant_id END) AS RJCC,</span>
</span><span id="__span-0-2317"><a id="__codelineno-0-2317" name="__codelineno-0-2317"></a><span class="s1">    COUNT(DISTINCT CASE WHEN cm_scan = 1 THEN participant_id END) AS SCaN,</span>
</span><span id="__span-0-2318"><a id="__codelineno-0-2318" name="__codelineno-0-2318"></a><span class="s1">    COUNT(DISTINCT CASE WHEN vp = 1 THEN participant_id END) AS vp,</span>
</span><span id="__span-0-2319"><a id="__codelineno-0-2319" name="__codelineno-0-2319"></a><span class="s1">    COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%JAC%&quot; THEN participant_id END) AS JAC,</span>
</span><span id="__span-0-2320"><a id="__codelineno-0-2320" name="__codelineno-0-2320"></a><span class="s1">    COUNT(DISTINCT CASE WHEN vp = 1 AND grant_type LIKE &quot;%IDHS%&quot; THEN participant_id END) AS IDHS</span>
</span><span id="__span-0-2321"><a id="__codelineno-0-2321" name="__codelineno-0-2321"></a><span class="s1">    from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span>
</span><span id="__span-0-2322"><a id="__codelineno-0-2322" name="__codelineno-0-2322"></a><span class="s1">    where new_client = &quot;new client&quot;</span>
</span><span id="__span-0-2323"><a id="__codelineno-0-2323" name="__codelineno-0-2323"></a><span class="s1">    ORDER BY case when client_status = &#39;active client&#39; then 1</span>
</span><span id="__span-0-2324"><a id="__codelineno-0-2324" name="__codelineno-0-2324"></a><span class="s1">    when client_status = &#39;new client&#39; then 2</span>
</span><span id="__span-0-2325"><a id="__codelineno-0-2325" name="__codelineno-0-2325"></a><span class="s1">    when client_status = &#39;closed out&#39; then 3</span>
</span><span id="__span-0-2326"><a id="__codelineno-0-2326" name="__codelineno-0-2326"></a><span class="s1">    end asc&#39;&#39;&#39;</span>
</span><span id="__span-0-2327"><a id="__codelineno-0-2327" name="__codelineno-0-2327"></a>        <span class="k">if</span> <span class="n">program_grant</span> <span class="o">==</span> <span class="s2">&quot;grant&quot;</span><span class="p">:</span>
</span><span id="__span-0-2328"><a id="__codelineno-0-2328" name="__codelineno-0-2328"></a>            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;select client_status, </span>
</span><span id="__span-0-2329"><a id="__codelineno-0-2329" name="__codelineno-0-2329"></a><span class="s1">COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%A2J%&quot; THEN participant_id END) AS A2J,</span>
</span><span id="__span-0-2330"><a id="__codelineno-0-2330" name="__codelineno-0-2330"></a><span class="s1">COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%IDHS%&quot; THEN participant_id END) AS IDHS,</span>
</span><span id="__span-0-2331"><a id="__codelineno-0-2331" name="__codelineno-0-2331"></a><span class="s1">COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%JAC%&quot; THEN participant_id END) AS JAC,</span>
</span><span id="__span-0-2332"><a id="__codelineno-0-2332" name="__codelineno-0-2332"></a><span class="s1">COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%SCAN%&quot; THEN participant_id END) AS SCAN,</span>
</span><span id="__span-0-2333"><a id="__codelineno-0-2333" name="__codelineno-0-2333"></a><span class="s1">COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%CRwS%&quot; THEN participant_id END) AS CRwS,</span>
</span><span id="__span-0-2334"><a id="__codelineno-0-2334" name="__codelineno-0-2334"></a><span class="s1">COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%YIP%&quot; THEN participant_id END) AS YIP</span>
</span><span id="__span-0-2335"><a id="__codelineno-0-2335" name="__codelineno-0-2335"></a><span class="s1">from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span>
</span><span id="__span-0-2336"><a id="__codelineno-0-2336" name="__codelineno-0-2336"></a><span class="s1">group by client_status</span>
</span><span id="__span-0-2337"><a id="__codelineno-0-2337" name="__codelineno-0-2337"></a>
</span><span id="__span-0-2338"><a id="__codelineno-0-2338" name="__codelineno-0-2338"></a><span class="s1">UNION ALL</span>
</span><span id="__span-0-2339"><a id="__codelineno-0-2339" name="__codelineno-0-2339"></a><span class="s1">SELECT</span>
</span><span id="__span-0-2340"><a id="__codelineno-0-2340" name="__codelineno-0-2340"></a><span class="s1">	&quot;new client&quot; as client_status,</span>
</span><span id="__span-0-2341"><a id="__codelineno-0-2341" name="__codelineno-0-2341"></a><span class="s1">COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%A2J%&quot; THEN participant_id END) AS A2J,</span>
</span><span id="__span-0-2342"><a id="__codelineno-0-2342" name="__codelineno-0-2342"></a><span class="s1">COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%IDHS%&quot; THEN participant_id END) AS IDHS,</span>
</span><span id="__span-0-2343"><a id="__codelineno-0-2343" name="__codelineno-0-2343"></a><span class="s1">COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%JAC%&quot; THEN participant_id END) AS JAC,</span>
</span><span id="__span-0-2344"><a id="__codelineno-0-2344" name="__codelineno-0-2344"></a><span class="s1">COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%SCAN%&quot; THEN participant_id END) AS SCAN,</span>
</span><span id="__span-0-2345"><a id="__codelineno-0-2345" name="__codelineno-0-2345"></a><span class="s1">COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%CRwS%&quot; THEN participant_id END) AS CRwS,</span>
</span><span id="__span-0-2346"><a id="__codelineno-0-2346" name="__codelineno-0-2346"></a><span class="s1">COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%YIP%&quot; THEN participant_id END) AS YIPS</span>
</span><span id="__span-0-2347"><a id="__codelineno-0-2347" name="__codelineno-0-2347"></a><span class="s1">from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span>
</span><span id="__span-0-2348"><a id="__codelineno-0-2348" name="__codelineno-0-2348"></a><span class="s1">where new_client = &quot;new client&quot;</span>
</span><span id="__span-0-2349"><a id="__codelineno-0-2349" name="__codelineno-0-2349"></a><span class="s1">ORDER BY case when client_status = &#39;active client&#39; then 1</span>
</span><span id="__span-0-2350"><a id="__codelineno-0-2350" name="__codelineno-0-2350"></a><span class="s1">              when client_status = &#39;new client&#39; then 2</span>
</span><span id="__span-0-2351"><a id="__codelineno-0-2351" name="__codelineno-0-2351"></a><span class="s1">              when client_status = &#39;closed out&#39; then 3</span>
</span><span id="__span-0-2352"><a id="__codelineno-0-2352" name="__codelineno-0-2352"></a><span class="s1">              end asc&#39;&#39;&#39;</span>
</span><span id="__span-0-2353"><a id="__codelineno-0-2353" name="__codelineno-0-2353"></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_run</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="__span-0-2354"><a id="__codelineno-0-2354" name="__codelineno-0-2354"></a>        <span class="k">return</span> <span class="n">df</span>
</span><span id="__span-0-2355"><a id="__codelineno-0-2355" name="__codelineno-0-2355"></a>
</span><span id="__span-0-2356"><a id="__codelineno-0-2356" name="__codelineno-0-2356"></a>    <span class="k">def</span> <span class="nf">grouped_by_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">program_grant</span> <span class="o">=</span> <span class="s2">&quot;grant&quot;</span><span class="p">,</span><span class="n">closed_only</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">percentages</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="__span-0-2357"><a id="__codelineno-0-2357" name="__codelineno-0-2357"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-0-2358"><a id="__codelineno-0-2358" name="__codelineno-0-2358"></a><span class="sd">        Returns program or grant involvement by client status</span>
</span><span id="__span-0-2359"><a id="__codelineno-0-2359" name="__codelineno-0-2359"></a>
</span><span id="__span-0-2360"><a id="__codelineno-0-2360" name="__codelineno-0-2360"></a><span class="sd">        Parameters:</span>
</span><span id="__span-0-2361"><a id="__codelineno-0-2361" name="__codelineno-0-2361"></a><span class="sd">            program_grant: &quot;program&quot; tallies program involvement, &quot;grant&quot; tallies grant involvement. Defaults to &quot;grant&quot;</span>
</span><span id="__span-0-2362"><a id="__codelineno-0-2362" name="__codelineno-0-2362"></a><span class="sd">            closed_only(Bool): True only tallies closed clients</span>
</span><span id="__span-0-2363"><a id="__codelineno-0-2363" name="__codelineno-0-2363"></a><span class="sd">            percentages(Bool): True auto-converts to percentages. Defaults to True </span>
</span><span id="__span-0-2364"><a id="__codelineno-0-2364" name="__codelineno-0-2364"></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="__span-0-2365"><a id="__codelineno-0-2365" name="__codelineno-0-2365"></a>        <span class="k">if</span> <span class="n">program_grant</span> <span class="o">==</span> <span class="s2">&quot;program&quot;</span><span class="p">:</span>
</span><span id="__span-0-2366"><a id="__codelineno-0-2366" name="__codelineno-0-2366"></a>            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;select days_served, </span>
</span><span id="__span-0-2367"><a id="__codelineno-0-2367" name="__codelineno-0-2367"></a><span class="s1">    COUNT(DISTINCT CASE WHEN hd = 1 THEN participant_id END) AS HD,</span>
</span><span id="__span-0-2368"><a id="__codelineno-0-2368" name="__codelineno-0-2368"></a><span class="s1">    COUNT(DISTINCT CASE WHEN cm_juv_divert = 1 THEN participant_id END) AS juv_div,</span>
</span><span id="__span-0-2369"><a id="__codelineno-0-2369" name="__codelineno-0-2369"></a><span class="s1">    COUNT(DISTINCT CASE WHEN rjcc = 1 THEN participant_id END) AS RJCC,</span>
</span><span id="__span-0-2370"><a id="__codelineno-0-2370" name="__codelineno-0-2370"></a><span class="s1">    COUNT(DISTINCT CASE WHEN cm_scan = 1 THEN participant_id END) AS SCaN,</span>
</span><span id="__span-0-2371"><a id="__codelineno-0-2371" name="__codelineno-0-2371"></a><span class="s1">    COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%JAC%&quot; THEN participant_id END) AS JAC,</span>
</span><span id="__span-0-2372"><a id="__codelineno-0-2372" name="__codelineno-0-2372"></a><span class="s1">    COUNT(DISTINCT CASE WHEN vp = 1 AND grant_type LIKE &quot;%IDHS%&quot; THEN participant_id END) AS IDHS</span>
</span><span id="__span-0-2373"><a id="__codelineno-0-2373" name="__codelineno-0-2373"></a><span class="s1">    from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span>
</span><span id="__span-0-2374"><a id="__codelineno-0-2374" name="__codelineno-0-2374"></a><span class="s1">    group by days_served</span>
</span><span id="__span-0-2375"><a id="__codelineno-0-2375" name="__codelineno-0-2375"></a><span class="s1">    ORDER BY case when days_served = &#39;0-45&#39; then 1</span>
</span><span id="__span-0-2376"><a id="__codelineno-0-2376" name="__codelineno-0-2376"></a><span class="s1">    when days_served = &#39;46-90&#39; then 2</span>
</span><span id="__span-0-2377"><a id="__codelineno-0-2377" name="__codelineno-0-2377"></a><span class="s1">    when days_served = &#39;91-180&#39; then 3</span>
</span><span id="__span-0-2378"><a id="__codelineno-0-2378" name="__codelineno-0-2378"></a><span class="s1">    when days_served = &#39;181-270&#39; then 4</span>
</span><span id="__span-0-2379"><a id="__codelineno-0-2379" name="__codelineno-0-2379"></a><span class="s1">    else 5</span>
</span><span id="__span-0-2380"><a id="__codelineno-0-2380" name="__codelineno-0-2380"></a><span class="s1">    end asc&#39;&#39;&#39;</span>
</span><span id="__span-0-2381"><a id="__codelineno-0-2381" name="__codelineno-0-2381"></a>        <span class="k">if</span> <span class="n">program_grant</span> <span class="o">==</span> <span class="s2">&quot;grant&quot;</span><span class="p">:</span>
</span><span id="__span-0-2382"><a id="__codelineno-0-2382" name="__codelineno-0-2382"></a>            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;select days_served, </span>
</span><span id="__span-0-2383"><a id="__codelineno-0-2383" name="__codelineno-0-2383"></a><span class="s1">COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%A2J%&quot; THEN participant_id END) AS A2J,</span>
</span><span id="__span-0-2384"><a id="__codelineno-0-2384" name="__codelineno-0-2384"></a><span class="s1">COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%IDHS%&quot; THEN participant_id END) AS IDHS,</span>
</span><span id="__span-0-2385"><a id="__codelineno-0-2385" name="__codelineno-0-2385"></a><span class="s1">COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%JAC%&quot; THEN participant_id END) AS JAC,</span>
</span><span id="__span-0-2386"><a id="__codelineno-0-2386" name="__codelineno-0-2386"></a><span class="s1">COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%SCAN%&quot; THEN participant_id END) AS SCAN,</span>
</span><span id="__span-0-2387"><a id="__codelineno-0-2387" name="__codelineno-0-2387"></a><span class="s1">COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%CRwS%&quot; THEN participant_id END) AS CRwS,</span>
</span><span id="__span-0-2388"><a id="__codelineno-0-2388" name="__codelineno-0-2388"></a><span class="s1">COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%YIP%&quot; THEN participant_id END) AS YIP</span>
</span><span id="__span-0-2389"><a id="__codelineno-0-2389" name="__codelineno-0-2389"></a><span class="s1">from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span>
</span><span id="__span-0-2390"><a id="__codelineno-0-2390" name="__codelineno-0-2390"></a><span class="s1">group by days_served</span>
</span><span id="__span-0-2391"><a id="__codelineno-0-2391" name="__codelineno-0-2391"></a><span class="s1">ORDER BY case when days_served = &#39;0-45&#39; then 1</span>
</span><span id="__span-0-2392"><a id="__codelineno-0-2392" name="__codelineno-0-2392"></a><span class="s1">when days_served = &#39;46-90&#39; then 2</span>
</span><span id="__span-0-2393"><a id="__codelineno-0-2393" name="__codelineno-0-2393"></a><span class="s1">when days_served = &#39;91-180&#39; then 3</span>
</span><span id="__span-0-2394"><a id="__codelineno-0-2394" name="__codelineno-0-2394"></a><span class="s1">when days_served = &#39;181-270&#39; then 4</span>
</span><span id="__span-0-2395"><a id="__codelineno-0-2395" name="__codelineno-0-2395"></a><span class="s1">else 5</span>
</span><span id="__span-0-2396"><a id="__codelineno-0-2396" name="__codelineno-0-2396"></a><span class="s1">end asc&#39;&#39;&#39;</span>
</span><span id="__span-0-2397"><a id="__codelineno-0-2397" name="__codelineno-0-2397"></a>        <span class="k">if</span> <span class="n">closed_only</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__span-0-2398"><a id="__codelineno-0-2398" name="__codelineno-0-2398"></a>            <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_modify</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">query</span><span class="p">),</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;where client_status = &quot;closed out&quot;&#39;&#39;&#39;</span><span class="p">)</span>
</span><span id="__span-0-2399"><a id="__codelineno-0-2399" name="__codelineno-0-2399"></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_run</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="__span-0-2400"><a id="__codelineno-0-2400" name="__codelineno-0-2400"></a>        <span class="k">if</span> <span class="n">percentages</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__span-0-2401"><a id="__codelineno-0-2401" name="__codelineno-0-2401"></a>            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">percentage_convert</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="__span-0-2402"><a id="__codelineno-0-2402" name="__codelineno-0-2402"></a>        <span class="k">return</span> <span class="n">df</span>
</span></code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h3 id="script.nice_sql.Monthly_Report.grouped_by_status" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">grouped_by_status</span><span class="p">(</span><span class="n">program_grant</span><span class="o">=</span><span class="s1">&#39;grant&#39;</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns program or grant involvement by client status</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>program_grant</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>"program" tallies program involvement, "grant" tallies grant involvement. Defaults to "grant"</p>
            </div>
          </td>
          <td>
                <code>&#39;grant&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>script\nice_sql.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2293">2293</a></span>
<span class="normal"><a href="#__codelineno-0-2294">2294</a></span>
<span class="normal"><a href="#__codelineno-0-2295">2295</a></span>
<span class="normal"><a href="#__codelineno-0-2296">2296</a></span>
<span class="normal"><a href="#__codelineno-0-2297">2297</a></span>
<span class="normal"><a href="#__codelineno-0-2298">2298</a></span>
<span class="normal"><a href="#__codelineno-0-2299">2299</a></span>
<span class="normal"><a href="#__codelineno-0-2300">2300</a></span>
<span class="normal"><a href="#__codelineno-0-2301">2301</a></span>
<span class="normal"><a href="#__codelineno-0-2302">2302</a></span>
<span class="normal"><a href="#__codelineno-0-2303">2303</a></span>
<span class="normal"><a href="#__codelineno-0-2304">2304</a></span>
<span class="normal"><a href="#__codelineno-0-2305">2305</a></span>
<span class="normal"><a href="#__codelineno-0-2306">2306</a></span>
<span class="normal"><a href="#__codelineno-0-2307">2307</a></span>
<span class="normal"><a href="#__codelineno-0-2308">2308</a></span>
<span class="normal"><a href="#__codelineno-0-2309">2309</a></span>
<span class="normal"><a href="#__codelineno-0-2310">2310</a></span>
<span class="normal"><a href="#__codelineno-0-2311">2311</a></span>
<span class="normal"><a href="#__codelineno-0-2312">2312</a></span>
<span class="normal"><a href="#__codelineno-0-2313">2313</a></span>
<span class="normal"><a href="#__codelineno-0-2314">2314</a></span>
<span class="normal"><a href="#__codelineno-0-2315">2315</a></span>
<span class="normal"><a href="#__codelineno-0-2316">2316</a></span>
<span class="normal"><a href="#__codelineno-0-2317">2317</a></span>
<span class="normal"><a href="#__codelineno-0-2318">2318</a></span>
<span class="normal"><a href="#__codelineno-0-2319">2319</a></span>
<span class="normal"><a href="#__codelineno-0-2320">2320</a></span>
<span class="normal"><a href="#__codelineno-0-2321">2321</a></span>
<span class="normal"><a href="#__codelineno-0-2322">2322</a></span>
<span class="normal"><a href="#__codelineno-0-2323">2323</a></span>
<span class="normal"><a href="#__codelineno-0-2324">2324</a></span>
<span class="normal"><a href="#__codelineno-0-2325">2325</a></span>
<span class="normal"><a href="#__codelineno-0-2326">2326</a></span>
<span class="normal"><a href="#__codelineno-0-2327">2327</a></span>
<span class="normal"><a href="#__codelineno-0-2328">2328</a></span>
<span class="normal"><a href="#__codelineno-0-2329">2329</a></span>
<span class="normal"><a href="#__codelineno-0-2330">2330</a></span>
<span class="normal"><a href="#__codelineno-0-2331">2331</a></span>
<span class="normal"><a href="#__codelineno-0-2332">2332</a></span>
<span class="normal"><a href="#__codelineno-0-2333">2333</a></span>
<span class="normal"><a href="#__codelineno-0-2334">2334</a></span>
<span class="normal"><a href="#__codelineno-0-2335">2335</a></span>
<span class="normal"><a href="#__codelineno-0-2336">2336</a></span>
<span class="normal"><a href="#__codelineno-0-2337">2337</a></span>
<span class="normal"><a href="#__codelineno-0-2338">2338</a></span>
<span class="normal"><a href="#__codelineno-0-2339">2339</a></span>
<span class="normal"><a href="#__codelineno-0-2340">2340</a></span>
<span class="normal"><a href="#__codelineno-0-2341">2341</a></span>
<span class="normal"><a href="#__codelineno-0-2342">2342</a></span>
<span class="normal"><a href="#__codelineno-0-2343">2343</a></span>
<span class="normal"><a href="#__codelineno-0-2344">2344</a></span>
<span class="normal"><a href="#__codelineno-0-2345">2345</a></span>
<span class="normal"><a href="#__codelineno-0-2346">2346</a></span>
<span class="normal"><a href="#__codelineno-0-2347">2347</a></span>
<span class="normal"><a href="#__codelineno-0-2348">2348</a></span>
<span class="normal"><a href="#__codelineno-0-2349">2349</a></span>
<span class="normal"><a href="#__codelineno-0-2350">2350</a></span>
<span class="normal"><a href="#__codelineno-0-2351">2351</a></span>
<span class="normal"><a href="#__codelineno-0-2352">2352</a></span>
<span class="normal"><a href="#__codelineno-0-2353">2353</a></span>
<span class="normal"><a href="#__codelineno-0-2354">2354</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2293"><a id="__codelineno-0-2293" name="__codelineno-0-2293"></a>    <span class="k">def</span> <span class="nf">grouped_by_status</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">program_grant</span> <span class="o">=</span> <span class="s2">&quot;grant&quot;</span><span class="p">):</span>
</span><span id="__span-0-2294"><a id="__codelineno-0-2294" name="__codelineno-0-2294"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-0-2295"><a id="__codelineno-0-2295" name="__codelineno-0-2295"></a><span class="sd">        Returns program or grant involvement by client status</span>
</span><span id="__span-0-2296"><a id="__codelineno-0-2296" name="__codelineno-0-2296"></a>
</span><span id="__span-0-2297"><a id="__codelineno-0-2297" name="__codelineno-0-2297"></a><span class="sd">        Parameters:</span>
</span><span id="__span-0-2298"><a id="__codelineno-0-2298" name="__codelineno-0-2298"></a><span class="sd">            program_grant: &quot;program&quot; tallies program involvement, &quot;grant&quot; tallies grant involvement. Defaults to &quot;grant&quot;</span>
</span><span id="__span-0-2299"><a id="__codelineno-0-2299" name="__codelineno-0-2299"></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="__span-0-2300"><a id="__codelineno-0-2300" name="__codelineno-0-2300"></a>        <span class="k">if</span> <span class="n">program_grant</span> <span class="o">==</span> <span class="s2">&quot;program&quot;</span><span class="p">:</span>
</span><span id="__span-0-2301"><a id="__codelineno-0-2301" name="__codelineno-0-2301"></a>            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;select client_status, </span>
</span><span id="__span-0-2302"><a id="__codelineno-0-2302" name="__codelineno-0-2302"></a><span class="s1">    COUNT(DISTINCT CASE WHEN hd = 1 THEN participant_id END) AS HD,</span>
</span><span id="__span-0-2303"><a id="__codelineno-0-2303" name="__codelineno-0-2303"></a><span class="s1">    COUNT(DISTINCT CASE WHEN cm_juv_divert = 1 THEN participant_id END) AS juv_div,</span>
</span><span id="__span-0-2304"><a id="__codelineno-0-2304" name="__codelineno-0-2304"></a><span class="s1">    COUNT(DISTINCT CASE WHEN rjcc = 1 THEN participant_id END) AS RJCC,</span>
</span><span id="__span-0-2305"><a id="__codelineno-0-2305" name="__codelineno-0-2305"></a><span class="s1">    COUNT(DISTINCT CASE WHEN cm_scan = 1 THEN participant_id END) AS SCaN,</span>
</span><span id="__span-0-2306"><a id="__codelineno-0-2306" name="__codelineno-0-2306"></a><span class="s1">    COUNT(DISTINCT CASE WHEN vp = 1 THEN participant_id END) AS vp,</span>
</span><span id="__span-0-2307"><a id="__codelineno-0-2307" name="__codelineno-0-2307"></a><span class="s1">    COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%JAC%&quot; THEN participant_id END) AS JAC,</span>
</span><span id="__span-0-2308"><a id="__codelineno-0-2308" name="__codelineno-0-2308"></a><span class="s1">    COUNT(DISTINCT CASE WHEN vp = 1 AND grant_type LIKE &quot;%IDHS%&quot; THEN participant_id END) AS IDHS</span>
</span><span id="__span-0-2309"><a id="__codelineno-0-2309" name="__codelineno-0-2309"></a><span class="s1">    from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span>
</span><span id="__span-0-2310"><a id="__codelineno-0-2310" name="__codelineno-0-2310"></a><span class="s1">    group by client_status</span>
</span><span id="__span-0-2311"><a id="__codelineno-0-2311" name="__codelineno-0-2311"></a><span class="s1">    UNION ALL</span>
</span><span id="__span-0-2312"><a id="__codelineno-0-2312" name="__codelineno-0-2312"></a><span class="s1">    SELECT</span>
</span><span id="__span-0-2313"><a id="__codelineno-0-2313" name="__codelineno-0-2313"></a><span class="s1">    &quot;new client&quot; as client_status,</span>
</span><span id="__span-0-2314"><a id="__codelineno-0-2314" name="__codelineno-0-2314"></a><span class="s1">    COUNT(DISTINCT CASE WHEN hd = 1 THEN participant_id END) AS HD,</span>
</span><span id="__span-0-2315"><a id="__codelineno-0-2315" name="__codelineno-0-2315"></a><span class="s1">    COUNT(DISTINCT CASE WHEN cm_juv_divert = 1 THEN participant_id END) AS juv_div,</span>
</span><span id="__span-0-2316"><a id="__codelineno-0-2316" name="__codelineno-0-2316"></a><span class="s1">    COUNT(DISTINCT CASE WHEN rjcc = 1 THEN participant_id END) AS RJCC,</span>
</span><span id="__span-0-2317"><a id="__codelineno-0-2317" name="__codelineno-0-2317"></a><span class="s1">    COUNT(DISTINCT CASE WHEN cm_scan = 1 THEN participant_id END) AS SCaN,</span>
</span><span id="__span-0-2318"><a id="__codelineno-0-2318" name="__codelineno-0-2318"></a><span class="s1">    COUNT(DISTINCT CASE WHEN vp = 1 THEN participant_id END) AS vp,</span>
</span><span id="__span-0-2319"><a id="__codelineno-0-2319" name="__codelineno-0-2319"></a><span class="s1">    COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%JAC%&quot; THEN participant_id END) AS JAC,</span>
</span><span id="__span-0-2320"><a id="__codelineno-0-2320" name="__codelineno-0-2320"></a><span class="s1">    COUNT(DISTINCT CASE WHEN vp = 1 AND grant_type LIKE &quot;%IDHS%&quot; THEN participant_id END) AS IDHS</span>
</span><span id="__span-0-2321"><a id="__codelineno-0-2321" name="__codelineno-0-2321"></a><span class="s1">    from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span>
</span><span id="__span-0-2322"><a id="__codelineno-0-2322" name="__codelineno-0-2322"></a><span class="s1">    where new_client = &quot;new client&quot;</span>
</span><span id="__span-0-2323"><a id="__codelineno-0-2323" name="__codelineno-0-2323"></a><span class="s1">    ORDER BY case when client_status = &#39;active client&#39; then 1</span>
</span><span id="__span-0-2324"><a id="__codelineno-0-2324" name="__codelineno-0-2324"></a><span class="s1">    when client_status = &#39;new client&#39; then 2</span>
</span><span id="__span-0-2325"><a id="__codelineno-0-2325" name="__codelineno-0-2325"></a><span class="s1">    when client_status = &#39;closed out&#39; then 3</span>
</span><span id="__span-0-2326"><a id="__codelineno-0-2326" name="__codelineno-0-2326"></a><span class="s1">    end asc&#39;&#39;&#39;</span>
</span><span id="__span-0-2327"><a id="__codelineno-0-2327" name="__codelineno-0-2327"></a>        <span class="k">if</span> <span class="n">program_grant</span> <span class="o">==</span> <span class="s2">&quot;grant&quot;</span><span class="p">:</span>
</span><span id="__span-0-2328"><a id="__codelineno-0-2328" name="__codelineno-0-2328"></a>            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;select client_status, </span>
</span><span id="__span-0-2329"><a id="__codelineno-0-2329" name="__codelineno-0-2329"></a><span class="s1">COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%A2J%&quot; THEN participant_id END) AS A2J,</span>
</span><span id="__span-0-2330"><a id="__codelineno-0-2330" name="__codelineno-0-2330"></a><span class="s1">COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%IDHS%&quot; THEN participant_id END) AS IDHS,</span>
</span><span id="__span-0-2331"><a id="__codelineno-0-2331" name="__codelineno-0-2331"></a><span class="s1">COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%JAC%&quot; THEN participant_id END) AS JAC,</span>
</span><span id="__span-0-2332"><a id="__codelineno-0-2332" name="__codelineno-0-2332"></a><span class="s1">COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%SCAN%&quot; THEN participant_id END) AS SCAN,</span>
</span><span id="__span-0-2333"><a id="__codelineno-0-2333" name="__codelineno-0-2333"></a><span class="s1">COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%CRwS%&quot; THEN participant_id END) AS CRwS,</span>
</span><span id="__span-0-2334"><a id="__codelineno-0-2334" name="__codelineno-0-2334"></a><span class="s1">COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%YIP%&quot; THEN participant_id END) AS YIP</span>
</span><span id="__span-0-2335"><a id="__codelineno-0-2335" name="__codelineno-0-2335"></a><span class="s1">from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span>
</span><span id="__span-0-2336"><a id="__codelineno-0-2336" name="__codelineno-0-2336"></a><span class="s1">group by client_status</span>
</span><span id="__span-0-2337"><a id="__codelineno-0-2337" name="__codelineno-0-2337"></a>
</span><span id="__span-0-2338"><a id="__codelineno-0-2338" name="__codelineno-0-2338"></a><span class="s1">UNION ALL</span>
</span><span id="__span-0-2339"><a id="__codelineno-0-2339" name="__codelineno-0-2339"></a><span class="s1">SELECT</span>
</span><span id="__span-0-2340"><a id="__codelineno-0-2340" name="__codelineno-0-2340"></a><span class="s1">	&quot;new client&quot; as client_status,</span>
</span><span id="__span-0-2341"><a id="__codelineno-0-2341" name="__codelineno-0-2341"></a><span class="s1">COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%A2J%&quot; THEN participant_id END) AS A2J,</span>
</span><span id="__span-0-2342"><a id="__codelineno-0-2342" name="__codelineno-0-2342"></a><span class="s1">COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%IDHS%&quot; THEN participant_id END) AS IDHS,</span>
</span><span id="__span-0-2343"><a id="__codelineno-0-2343" name="__codelineno-0-2343"></a><span class="s1">COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%JAC%&quot; THEN participant_id END) AS JAC,</span>
</span><span id="__span-0-2344"><a id="__codelineno-0-2344" name="__codelineno-0-2344"></a><span class="s1">COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%SCAN%&quot; THEN participant_id END) AS SCAN,</span>
</span><span id="__span-0-2345"><a id="__codelineno-0-2345" name="__codelineno-0-2345"></a><span class="s1">COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%CRwS%&quot; THEN participant_id END) AS CRwS,</span>
</span><span id="__span-0-2346"><a id="__codelineno-0-2346" name="__codelineno-0-2346"></a><span class="s1">COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%YIP%&quot; THEN participant_id END) AS YIPS</span>
</span><span id="__span-0-2347"><a id="__codelineno-0-2347" name="__codelineno-0-2347"></a><span class="s1">from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span>
</span><span id="__span-0-2348"><a id="__codelineno-0-2348" name="__codelineno-0-2348"></a><span class="s1">where new_client = &quot;new client&quot;</span>
</span><span id="__span-0-2349"><a id="__codelineno-0-2349" name="__codelineno-0-2349"></a><span class="s1">ORDER BY case when client_status = &#39;active client&#39; then 1</span>
</span><span id="__span-0-2350"><a id="__codelineno-0-2350" name="__codelineno-0-2350"></a><span class="s1">              when client_status = &#39;new client&#39; then 2</span>
</span><span id="__span-0-2351"><a id="__codelineno-0-2351" name="__codelineno-0-2351"></a><span class="s1">              when client_status = &#39;closed out&#39; then 3</span>
</span><span id="__span-0-2352"><a id="__codelineno-0-2352" name="__codelineno-0-2352"></a><span class="s1">              end asc&#39;&#39;&#39;</span>
</span><span id="__span-0-2353"><a id="__codelineno-0-2353" name="__codelineno-0-2353"></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_run</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="__span-0-2354"><a id="__codelineno-0-2354" name="__codelineno-0-2354"></a>        <span class="k">return</span> <span class="n">df</span>
</span></code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h3 id="script.nice_sql.Monthly_Report.grouped_by_time" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">grouped_by_time</span><span class="p">(</span><span class="n">program_grant</span><span class="o">=</span><span class="s1">&#39;grant&#39;</span><span class="p">,</span> <span class="n">closed_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">percentages</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h3>


  <div class="doc doc-contents ">
  
      <p>Returns program or grant involvement by client status</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>program_grant</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>"program" tallies program involvement, "grant" tallies grant involvement. Defaults to "grant"</p>
            </div>
          </td>
          <td>
                <code>&#39;grant&#39;</code>
          </td>
        </tr>
        <tr>
          <td><code>closed_only(Bool)</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>True only tallies closed clients</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>percentages(Bool)</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>True auto-converts to percentages. Defaults to True</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>script\nice_sql.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-2356">2356</a></span>
<span class="normal"><a href="#__codelineno-0-2357">2357</a></span>
<span class="normal"><a href="#__codelineno-0-2358">2358</a></span>
<span class="normal"><a href="#__codelineno-0-2359">2359</a></span>
<span class="normal"><a href="#__codelineno-0-2360">2360</a></span>
<span class="normal"><a href="#__codelineno-0-2361">2361</a></span>
<span class="normal"><a href="#__codelineno-0-2362">2362</a></span>
<span class="normal"><a href="#__codelineno-0-2363">2363</a></span>
<span class="normal"><a href="#__codelineno-0-2364">2364</a></span>
<span class="normal"><a href="#__codelineno-0-2365">2365</a></span>
<span class="normal"><a href="#__codelineno-0-2366">2366</a></span>
<span class="normal"><a href="#__codelineno-0-2367">2367</a></span>
<span class="normal"><a href="#__codelineno-0-2368">2368</a></span>
<span class="normal"><a href="#__codelineno-0-2369">2369</a></span>
<span class="normal"><a href="#__codelineno-0-2370">2370</a></span>
<span class="normal"><a href="#__codelineno-0-2371">2371</a></span>
<span class="normal"><a href="#__codelineno-0-2372">2372</a></span>
<span class="normal"><a href="#__codelineno-0-2373">2373</a></span>
<span class="normal"><a href="#__codelineno-0-2374">2374</a></span>
<span class="normal"><a href="#__codelineno-0-2375">2375</a></span>
<span class="normal"><a href="#__codelineno-0-2376">2376</a></span>
<span class="normal"><a href="#__codelineno-0-2377">2377</a></span>
<span class="normal"><a href="#__codelineno-0-2378">2378</a></span>
<span class="normal"><a href="#__codelineno-0-2379">2379</a></span>
<span class="normal"><a href="#__codelineno-0-2380">2380</a></span>
<span class="normal"><a href="#__codelineno-0-2381">2381</a></span>
<span class="normal"><a href="#__codelineno-0-2382">2382</a></span>
<span class="normal"><a href="#__codelineno-0-2383">2383</a></span>
<span class="normal"><a href="#__codelineno-0-2384">2384</a></span>
<span class="normal"><a href="#__codelineno-0-2385">2385</a></span>
<span class="normal"><a href="#__codelineno-0-2386">2386</a></span>
<span class="normal"><a href="#__codelineno-0-2387">2387</a></span>
<span class="normal"><a href="#__codelineno-0-2388">2388</a></span>
<span class="normal"><a href="#__codelineno-0-2389">2389</a></span>
<span class="normal"><a href="#__codelineno-0-2390">2390</a></span>
<span class="normal"><a href="#__codelineno-0-2391">2391</a></span>
<span class="normal"><a href="#__codelineno-0-2392">2392</a></span>
<span class="normal"><a href="#__codelineno-0-2393">2393</a></span>
<span class="normal"><a href="#__codelineno-0-2394">2394</a></span>
<span class="normal"><a href="#__codelineno-0-2395">2395</a></span>
<span class="normal"><a href="#__codelineno-0-2396">2396</a></span>
<span class="normal"><a href="#__codelineno-0-2397">2397</a></span>
<span class="normal"><a href="#__codelineno-0-2398">2398</a></span>
<span class="normal"><a href="#__codelineno-0-2399">2399</a></span>
<span class="normal"><a href="#__codelineno-0-2400">2400</a></span>
<span class="normal"><a href="#__codelineno-0-2401">2401</a></span>
<span class="normal"><a href="#__codelineno-0-2402">2402</a></span></pre></div></td><td class="code"><div><pre><span></span><code><span id="__span-0-2356"><a id="__codelineno-0-2356" name="__codelineno-0-2356"></a>    <span class="k">def</span> <span class="nf">grouped_by_time</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">program_grant</span> <span class="o">=</span> <span class="s2">&quot;grant&quot;</span><span class="p">,</span><span class="n">closed_only</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">percentages</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
</span><span id="__span-0-2357"><a id="__codelineno-0-2357" name="__codelineno-0-2357"></a><span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
</span><span id="__span-0-2358"><a id="__codelineno-0-2358" name="__codelineno-0-2358"></a><span class="sd">        Returns program or grant involvement by client status</span>
</span><span id="__span-0-2359"><a id="__codelineno-0-2359" name="__codelineno-0-2359"></a>
</span><span id="__span-0-2360"><a id="__codelineno-0-2360" name="__codelineno-0-2360"></a><span class="sd">        Parameters:</span>
</span><span id="__span-0-2361"><a id="__codelineno-0-2361" name="__codelineno-0-2361"></a><span class="sd">            program_grant: &quot;program&quot; tallies program involvement, &quot;grant&quot; tallies grant involvement. Defaults to &quot;grant&quot;</span>
</span><span id="__span-0-2362"><a id="__codelineno-0-2362" name="__codelineno-0-2362"></a><span class="sd">            closed_only(Bool): True only tallies closed clients</span>
</span><span id="__span-0-2363"><a id="__codelineno-0-2363" name="__codelineno-0-2363"></a><span class="sd">            percentages(Bool): True auto-converts to percentages. Defaults to True </span>
</span><span id="__span-0-2364"><a id="__codelineno-0-2364" name="__codelineno-0-2364"></a><span class="sd">        &#39;&#39;&#39;</span>
</span><span id="__span-0-2365"><a id="__codelineno-0-2365" name="__codelineno-0-2365"></a>        <span class="k">if</span> <span class="n">program_grant</span> <span class="o">==</span> <span class="s2">&quot;program&quot;</span><span class="p">:</span>
</span><span id="__span-0-2366"><a id="__codelineno-0-2366" name="__codelineno-0-2366"></a>            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;select days_served, </span>
</span><span id="__span-0-2367"><a id="__codelineno-0-2367" name="__codelineno-0-2367"></a><span class="s1">    COUNT(DISTINCT CASE WHEN hd = 1 THEN participant_id END) AS HD,</span>
</span><span id="__span-0-2368"><a id="__codelineno-0-2368" name="__codelineno-0-2368"></a><span class="s1">    COUNT(DISTINCT CASE WHEN cm_juv_divert = 1 THEN participant_id END) AS juv_div,</span>
</span><span id="__span-0-2369"><a id="__codelineno-0-2369" name="__codelineno-0-2369"></a><span class="s1">    COUNT(DISTINCT CASE WHEN rjcc = 1 THEN participant_id END) AS RJCC,</span>
</span><span id="__span-0-2370"><a id="__codelineno-0-2370" name="__codelineno-0-2370"></a><span class="s1">    COUNT(DISTINCT CASE WHEN cm_scan = 1 THEN participant_id END) AS SCaN,</span>
</span><span id="__span-0-2371"><a id="__codelineno-0-2371" name="__codelineno-0-2371"></a><span class="s1">    COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%JAC%&quot; THEN participant_id END) AS JAC,</span>
</span><span id="__span-0-2372"><a id="__codelineno-0-2372" name="__codelineno-0-2372"></a><span class="s1">    COUNT(DISTINCT CASE WHEN vp = 1 AND grant_type LIKE &quot;%IDHS%&quot; THEN participant_id END) AS IDHS</span>
</span><span id="__span-0-2373"><a id="__codelineno-0-2373" name="__codelineno-0-2373"></a><span class="s1">    from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span>
</span><span id="__span-0-2374"><a id="__codelineno-0-2374" name="__codelineno-0-2374"></a><span class="s1">    group by days_served</span>
</span><span id="__span-0-2375"><a id="__codelineno-0-2375" name="__codelineno-0-2375"></a><span class="s1">    ORDER BY case when days_served = &#39;0-45&#39; then 1</span>
</span><span id="__span-0-2376"><a id="__codelineno-0-2376" name="__codelineno-0-2376"></a><span class="s1">    when days_served = &#39;46-90&#39; then 2</span>
</span><span id="__span-0-2377"><a id="__codelineno-0-2377" name="__codelineno-0-2377"></a><span class="s1">    when days_served = &#39;91-180&#39; then 3</span>
</span><span id="__span-0-2378"><a id="__codelineno-0-2378" name="__codelineno-0-2378"></a><span class="s1">    when days_served = &#39;181-270&#39; then 4</span>
</span><span id="__span-0-2379"><a id="__codelineno-0-2379" name="__codelineno-0-2379"></a><span class="s1">    else 5</span>
</span><span id="__span-0-2380"><a id="__codelineno-0-2380" name="__codelineno-0-2380"></a><span class="s1">    end asc&#39;&#39;&#39;</span>
</span><span id="__span-0-2381"><a id="__codelineno-0-2381" name="__codelineno-0-2381"></a>        <span class="k">if</span> <span class="n">program_grant</span> <span class="o">==</span> <span class="s2">&quot;grant&quot;</span><span class="p">:</span>
</span><span id="__span-0-2382"><a id="__codelineno-0-2382" name="__codelineno-0-2382"></a>            <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;select days_served, </span>
</span><span id="__span-0-2383"><a id="__codelineno-0-2383" name="__codelineno-0-2383"></a><span class="s1">COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%A2J%&quot; THEN participant_id END) AS A2J,</span>
</span><span id="__span-0-2384"><a id="__codelineno-0-2384" name="__codelineno-0-2384"></a><span class="s1">COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%IDHS%&quot; THEN participant_id END) AS IDHS,</span>
</span><span id="__span-0-2385"><a id="__codelineno-0-2385" name="__codelineno-0-2385"></a><span class="s1">COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%JAC%&quot; THEN participant_id END) AS JAC,</span>
</span><span id="__span-0-2386"><a id="__codelineno-0-2386" name="__codelineno-0-2386"></a><span class="s1">COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%SCAN%&quot; THEN participant_id END) AS SCAN,</span>
</span><span id="__span-0-2387"><a id="__codelineno-0-2387" name="__codelineno-0-2387"></a><span class="s1">COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%CRwS%&quot; THEN participant_id END) AS CRwS,</span>
</span><span id="__span-0-2388"><a id="__codelineno-0-2388" name="__codelineno-0-2388"></a><span class="s1">COUNT(DISTINCT CASE WHEN grant_type LIKE &quot;%YIP%&quot; THEN participant_id END) AS YIP</span>
</span><span id="__span-0-2389"><a id="__codelineno-0-2389" name="__codelineno-0-2389"></a><span class="s1">from </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">table</span><span class="si">}</span>
</span><span id="__span-0-2390"><a id="__codelineno-0-2390" name="__codelineno-0-2390"></a><span class="s1">group by days_served</span>
</span><span id="__span-0-2391"><a id="__codelineno-0-2391" name="__codelineno-0-2391"></a><span class="s1">ORDER BY case when days_served = &#39;0-45&#39; then 1</span>
</span><span id="__span-0-2392"><a id="__codelineno-0-2392" name="__codelineno-0-2392"></a><span class="s1">when days_served = &#39;46-90&#39; then 2</span>
</span><span id="__span-0-2393"><a id="__codelineno-0-2393" name="__codelineno-0-2393"></a><span class="s1">when days_served = &#39;91-180&#39; then 3</span>
</span><span id="__span-0-2394"><a id="__codelineno-0-2394" name="__codelineno-0-2394"></a><span class="s1">when days_served = &#39;181-270&#39; then 4</span>
</span><span id="__span-0-2395"><a id="__codelineno-0-2395" name="__codelineno-0-2395"></a><span class="s1">else 5</span>
</span><span id="__span-0-2396"><a id="__codelineno-0-2396" name="__codelineno-0-2396"></a><span class="s1">end asc&#39;&#39;&#39;</span>
</span><span id="__span-0-2397"><a id="__codelineno-0-2397" name="__codelineno-0-2397"></a>        <span class="k">if</span> <span class="n">closed_only</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__span-0-2398"><a id="__codelineno-0-2398" name="__codelineno-0-2398"></a>            <span class="n">query</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_modify</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">query</span><span class="p">),</span> <span class="sa">f</span><span class="s1">&#39;&#39;&#39;where client_status = &quot;closed out&quot;&#39;&#39;&#39;</span><span class="p">)</span>
</span><span id="__span-0-2399"><a id="__codelineno-0-2399" name="__codelineno-0-2399"></a>        <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_run</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</span><span id="__span-0-2400"><a id="__codelineno-0-2400" name="__codelineno-0-2400"></a>        <span class="k">if</span> <span class="n">percentages</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="__span-0-2401"><a id="__codelineno-0-2401" name="__codelineno-0-2401"></a>            <span class="n">df</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">percentage_convert</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</span><span id="__span-0-2402"><a id="__codelineno-0-2402" name="__codelineno-0-2402"></a>        <span class="k">return</span> <span class="n">df</span>
</span></code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div><h3 id="running-reports_2">Running Reports</h3>
<div class="language-py highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a> <span class="n">m</span> <span class="o">=</span> <span class="n">Monthly_Report</span><span class="p">(</span><span class="n">t1</span> <span class="o">=</span> <span class="s1">&#39;2023-12-01&#39;</span><span class="p">,</span> <span class="n">t2</span> <span class="o">=</span> <span class="s1">&#39;2023-12-31&#39;</span><span class="p">,</span> <span class="n">print_SQL</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> 
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="n">clipboard</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="n">m</span><span class="o">.</span><span class="n">run_report</span><span class="p">(</span><span class="n">program_grant_funcs</span><span class="p">)</span>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="n">m</span><span class="o">.</span><span class="n">run_report</span><span class="p">(</span><span class="n">legal_funcs</span><span class="p">)</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="n">m</span><span class="o">.</span><span class="n">run_report</span><span class="p">(</span><span class="n">cm_outreach_funcs</span><span class="p">)</span>
</span></code></pre></div>
<h4 id="program_grant_funcs">program_grant_funcs</h4>
<ul>
<li><strong>grant involvement:</strong> <code>("grant_tally", ())</code></li>
<li><strong>grants started:</strong> <code>("grant_tally", ("start_date",))</code></li>
<li><strong>grants ended:</strong> <code>("grant_tally", ("end_date",))</code></li>
<li><strong>Program Involvement by Days - All:</strong> <code>("grouped_by_time", ("program", False, True,))</code></li>
<li><strong>Program Involvement by Days - Closed:</strong> <code>("grouped_by_time", ("program", True, True,))</code></li>
<li><strong>PROGRAMS BY RACE:</strong> <code>("programs_by_demographic",("race", True,))</code></li>
<li><strong>PROGRAMS BY GENDER:</strong> <code>("programs_by_demographic",("gender", True, ))</code></li>
<li><strong>PROGRAMS BY AGE:</strong> <code>("programs_by_demographic",("age", True,))</code></li>
<li><strong>ALL_DAYS_SERVED_BY_GRANT:</strong> <code>("grouped_by_time", ("grant", False,))</code></li>
<li><strong>CLOSED_DAYS_SERVED_BY_GRANT:</strong> <code>("grouped_by_time", ("grant", True,))</code></li>
<li><strong>PACKAGE OF SERVICES:</strong> <code>("programs_packages",())</code></li>
</ul>
<h4 id="legal_funcs">legal_funcs</h4>
<ul>
<li><strong>CiviCore.Legal Tally:</strong> <code>("legal_tally",())</code></li>
<li><strong>Case Pending Tally:</strong> <code>("legal_tally",(True,))</code></li>
<li><strong>Case Type - All Cases:</strong> <code>("legal_case_type", (False, False, "opened", True, "case"))</code></li>
<li><strong>Case Type - Opened:</strong> <code>("legal_case_type", (False, True, "opened","case"))</code></li>
<li><strong>Case Type - Closed:</strong> <code>("legal_case_type", (False, True, "closed","case"))</code></li>
<li><strong>Rearrested:</strong> <code>("legal_rearrested",())</code></li>
<li><strong>Pending Cases:</strong> <code>("legal_pending_cases", ("t2",))</code></li>
<li><strong>Case Outcomes:</strong> <code>("legal_case_outcomes", ())</code></li>
<li><strong>Guilty Plea Outcomes:</strong> <code>("legal_plea_outcomes", (True,))</code></li>
</ul>
<h4 id="cm_outreach_funcs">cm_outreach_funcs</h4>
<ul>
<li><strong>receiving CM:</strong> <code>("programs_service_tally", ("service_cm",))</code></li>
<li><strong>Had CM Session in Month:</strong> <code>("programs_sessions", ())</code></li>
<li><strong>CM Session Count:</strong> <code>("programs_session_tally", ("cm",))</code></li>
<li><strong>CM Session Length:</strong> <code>("programs_session_length", ())</code></li>
<li><strong>CM Session Length (Grouped):</strong> <code>("programs_session_length", ("cm", True, True))</code></li>
<li><strong>Had Outreach Session in Month:</strong> <code>("programs_sessions", ("outreach",))</code></li>
<li><strong>Outreach Session Count:</strong> <code>("programs_session_tally", ("outreach",))</code></li>
<li><strong>linkage tally:</strong> <code>("link_tally", (True, True, "linked_date",))</code></li>
<li><strong>services linked:</strong> <code>("link_goal_area", (True, True, "both",))</code></li>
</ul>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.code.annotate"], "search": "../assets/javascripts/workers/search.dfff1995.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.4e31edb1.min.js"></script>
      
    
  </body>
</html>